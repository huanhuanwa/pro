import { Component, Input, HostBinding, HostListener, NgZone } from '@angular/core';
import { trigger, state, style, animate, transition } from '@angular/animations';
import { UpdateHostClassService } from 'ngx-tethys/core';
import { NotifyQueueStore } from './notify-queue.store';
import { helpers } from 'ngx-tethys/util';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from './notify-queue.store';
import * as ɵngcc2 from '@angular/common';
import * as ɵngcc3 from 'ngx-tethys/icon';

function ThyNotifyComponent_ng_container_0_div_8_a_2_Template(rf, ctx) { if (rf & 1) {
    const _r6 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "a", 11);
    ɵngcc0.ɵɵlistener("click", function ThyNotifyComponent_ng_container_0_div_8_a_2_Template_a_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r6); const ctx_r5 = ɵngcc0.ɵɵnextContext(3); return ctx_r5.triggerDetail(); });
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r4.option == null ? null : ctx_r4.option.detail["link"]);
} }
const _c0 = function (a0) { return { "thy-notify-content--extend": a0 }; };
function ThyNotifyComponent_ng_container_0_div_8_Template(rf, ctx) { if (rf & 1) {
    const _r8 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 9);
    ɵngcc0.ɵɵlistener("click", function ThyNotifyComponent_ng_container_0_div_8_Template_div_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r8); const ctx_r7 = ɵngcc0.ɵɵnextContext(2); return ctx_r7.extendContent(); });
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵtemplate(2, ThyNotifyComponent_ng_container_0_div_8_a_2_Template, 2, 1, "a", 10);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction1(3, _c0, ctx_r2.extendContentClass === true));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r2.option == null ? null : ctx_r2.option.content, " ");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r2.option == null ? null : ctx_r2.option.detail);
} }
function ThyNotifyComponent_ng_container_0_div_9_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 12);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r3 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r3.option == null ? null : ctx_r3.option.detail["content"]);
} }
function ThyNotifyComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    const _r10 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "a", 1);
    ɵngcc0.ɵɵlistener("click", function ThyNotifyComponent_ng_container_0_Template_a_click_1_listener() { ɵngcc0.ɵɵrestoreView(_r10); const ctx_r9 = ɵngcc0.ɵɵnextContext(); return ctx_r9.closeNotify(); });
    ɵngcc0.ɵɵelement(2, "thy-icon", 2);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(3, "div", 3);
    ɵngcc0.ɵɵelement(4, "thy-icon", 4);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(5, "div", 5);
    ɵngcc0.ɵɵelementStart(6, "div", 6);
    ɵngcc0.ɵɵtext(7);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(8, ThyNotifyComponent_ng_container_0_div_8_Template, 3, 5, "div", 7);
    ɵngcc0.ɵɵtemplate(9, ThyNotifyComponent_ng_container_0_div_9_Template, 2, 1, "div", 8);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(4);
    ɵngcc0.ɵɵproperty("thyIconName", ctx_r0.notifyIconName);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ctx_r0.option == null ? null : ctx_r0.option.title);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", (ctx_r0.option == null ? null : ctx_r0.option.detail) || (ctx_r0.option == null ? null : ctx_r0.option.content));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.isShowDetail);
} }
function ThyNotifyComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    const _r12 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "a", 1);
    ɵngcc0.ɵɵlistener("click", function ThyNotifyComponent_ng_container_1_Template_a_click_1_listener() { ɵngcc0.ɵɵrestoreView(_r12); const ctx_r11 = ɵngcc0.ɵɵnextContext(); return ctx_r11.closeNotify(); });
    ɵngcc0.ɵɵelement(2, "thy-icon", 2);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(3, "div", 5);
    ɵngcc0.ɵɵelement(4, "template", 13);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(4);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r1.option == null ? null : ctx_r1.option.html);
} }
const ANIMATION_IN_DURATION = 100;
const ANIMATION_OUT_DURATION = 150;
const HIDE_STYLE = { transform: 'translateX(0)', opacity: 0, height: 0, paddingTop: 0, paddingBottom: 0, margin: 0 };
export class ThyNotifyComponent {
    constructor(_queueStore, _ngZone) {
        this._queueStore = _queueStore;
        this._ngZone = _ngZone;
        this.className = '';
        this.notifyIconName = '';
        this.extendContentClass = false;
        this.isShowDetail = false;
    }
    set thyOption(value) {
        this.option = value;
        const type = value.type;
        this.placement = value.placement || 'topRight';
        if (this.placement === 'topLeft' || this.placement === 'bottomLeft') {
            this.flyInOut = 'flyInOutLeft';
        }
        else {
            this.flyInOut = 'flyInOutRight';
        }
        this.className = `thy-notify thy-notify-${type}`;
    }
    ngOnInit() {
        const iconName = {
            success: 'check-circle-fill',
            info: 'info-circle-fill',
            warning: 'waring-fill',
            error: 'close-circle-fill'
        };
        this.notifyIconName = iconName[this.option.type];
        this._creatCloseTimer();
    }
    ngOnDestroy() {
        this._clearCloseTimer();
    }
    extendContent() {
        this.extendContentClass = true;
    }
    showDetailToggle() {
        this.isShowDetail = !this.isShowDetail;
    }
    closeNotify() {
        this._ngZone.runOutsideAngular(() => {
            this.flyInOut = 'componentHide';
            setTimeout(() => {
                this._queueStore.removeNotify(this.option.id, this.placement);
            }, ANIMATION_OUT_DURATION);
        });
    }
    triggerDetail() {
        if (helpers.isFunction(this.option.detail.action)) {
            this.option.detail.action();
        }
        if (this.option.detail.content) {
            this.showDetailToggle();
        }
    }
    mouseenter() {
        if (this.option.pauseOnHover) {
            this._clearCloseTimer();
        }
    }
    mouseleave() {
        if (this.option.pauseOnHover) {
            this._creatCloseTimer();
        }
    }
    _creatCloseTimer() {
        if (this.option.duration) {
            this.closeTimer = setInterval(() => {
                clearInterval(this.closeTimer);
                this.closeNotify();
            }, this.option.duration);
        }
    }
    _clearCloseTimer() {
        clearInterval(this.closeTimer);
    }
}
ThyNotifyComponent.ɵfac = function ThyNotifyComponent_Factory(t) { return new (t || ThyNotifyComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.NotifyQueueStore), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone)); };
ThyNotifyComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: ThyNotifyComponent, selectors: [["thy-notify"]], hostVars: 3, hostBindings: function ThyNotifyComponent_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("mouseenter", function ThyNotifyComponent_mouseenter_HostBindingHandler() { return ctx.mouseenter(); })("mouseleave", function ThyNotifyComponent_mouseleave_HostBindingHandler() { return ctx.mouseleave(); });
    } if (rf & 2) {
        ɵngcc0.ɵɵsyntheticHostProperty("@flyInOut", ctx.flyInOut);
        ɵngcc0.ɵɵclassMap(ctx.className);
    } }, inputs: { thyOption: "thyOption" }, features: [ɵngcc0.ɵɵProvidersFeature([UpdateHostClassService])], decls: 2, vars: 2, consts: [[4, "ngIf"], ["href", "javascript:;", 1, "thy-notify-close", 3, "click"], ["thyIconName", "close"], [1, "thy-notify-icon-container"], [3, "thyIconName"], [1, "thy-notify-main"], [1, "thy-notify-title"], ["class", "thy-notify-content", 3, "ngClass", "click", 4, "ngIf"], ["class", "thy-notify-detail", 4, "ngIf"], [1, "thy-notify-content", 3, "ngClass", "click"], ["href", "javascript:;", "class", "link-secondary", 3, "click", 4, "ngIf"], ["href", "javascript:;", 1, "link-secondary", 3, "click"], [1, "thy-notify-detail"], [3, "ngTemplateOutlet"]], template: function ThyNotifyComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, ThyNotifyComponent_ng_container_0_Template, 10, 4, "ng-container", 0);
        ɵngcc0.ɵɵtemplate(1, ThyNotifyComponent_ng_container_1_Template, 5, 1, "ng-container", 0);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngIf", !ctx.option.html);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.option == null ? null : ctx.option.html);
    } }, directives: [ɵngcc2.NgIf, ɵngcc3.ThyIconComponent, ɵngcc2.NgClass, ɵngcc2.NgTemplateOutlet], encapsulation: 2, data: { animation: [
            trigger('flyInOut', [
                state('flyInOutRight', style({ transform: 'translateX(0)', opacity: 1, height: '*' })),
                transition('void => flyInOutRight', [
                    style({ transform: 'translateX(100%)', opacity: 0, height: '*' }),
                    animate(ANIMATION_IN_DURATION)
                ]),
                transition('flyInOutRight => componentHide', [animate(ANIMATION_OUT_DURATION, style(HIDE_STYLE))]),
                transition('flyInOutRight => void', [animate(ANIMATION_IN_DURATION, style(HIDE_STYLE))]),
                state('flyInOutLeft', style({ transform: 'translateX(0)', opacity: 1, height: '*' })),
                transition('void => flyInOutLeft', [
                    style({ transform: 'translateX(-100%)', opacity: 0, height: '*' }),
                    animate(ANIMATION_IN_DURATION)
                ]),
                transition('flyInOutLeft => componentHide', [animate(ANIMATION_OUT_DURATION, style(HIDE_STYLE))]),
                transition('flyInOutLeft => void', [animate(ANIMATION_IN_DURATION, style(HIDE_STYLE))]),
                state('componentHide', style(HIDE_STYLE))
            ])
        ] } });
ThyNotifyComponent.ctorParameters = () => [
    { type: NotifyQueueStore },
    { type: NgZone }
];
ThyNotifyComponent.propDecorators = {
    flyInOut: [{ type: HostBinding, args: ['@flyInOut',] }],
    className: [{ type: HostBinding, args: ['class',] }],
    thyOption: [{ type: Input }],
    mouseenter: [{ type: HostListener, args: ['mouseenter',] }],
    mouseleave: [{ type: HostListener, args: ['mouseleave',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ThyNotifyComponent, [{
        type: Component,
        args: [{
                selector: 'thy-notify',
                template: "<ng-container *ngIf=\"!option.html\">\n  <a href=\"javascript:;\" class=\"thy-notify-close\" (click)=\"closeNotify()\">\n    <thy-icon thyIconName=\"close\"></thy-icon>\n  </a>\n  <div class=\"thy-notify-icon-container\">\n    <thy-icon [thyIconName]=\"notifyIconName\"></thy-icon>\n  </div>\n  <div class=\"thy-notify-main\">\n    <div class=\"thy-notify-title\">{{ option?.title }}</div>\n    <div\n      *ngIf=\"option?.detail || option?.content\"\n      class=\"thy-notify-content\"\n      [ngClass]=\"{ 'thy-notify-content--extend': extendContentClass === true }\"\n      (click)=\"extendContent()\"\n    >\n      {{ option?.content }}\n      <a href=\"javascript:;\" *ngIf=\"option?.detail\" class=\"link-secondary\" (click)=\"triggerDetail()\">{{ (option?.detail)['link'] }}</a>\n    </div>\n    <div class=\"thy-notify-detail\" *ngIf=\"isShowDetail\">{{ (option?.detail)['content'] }}</div>\n  </div>\n</ng-container>\n<ng-container *ngIf=\"option?.html\">\n  <a href=\"javascript:;\" class=\"thy-notify-close\" (click)=\"closeNotify()\">\n    <thy-icon thyIconName=\"close\"></thy-icon>\n  </a>\n  <div class=\"thy-notify-main\">\n    <template [ngTemplateOutlet]=\"option?.html\"></template>\n  </div>\n</ng-container>\n",
                providers: [UpdateHostClassService],
                animations: [
                    trigger('flyInOut', [
                        state('flyInOutRight', style({ transform: 'translateX(0)', opacity: 1, height: '*' })),
                        transition('void => flyInOutRight', [
                            style({ transform: 'translateX(100%)', opacity: 0, height: '*' }),
                            animate(ANIMATION_IN_DURATION)
                        ]),
                        transition('flyInOutRight => componentHide', [animate(ANIMATION_OUT_DURATION, style(HIDE_STYLE))]),
                        transition('flyInOutRight => void', [animate(ANIMATION_IN_DURATION, style(HIDE_STYLE))]),
                        state('flyInOutLeft', style({ transform: 'translateX(0)', opacity: 1, height: '*' })),
                        transition('void => flyInOutLeft', [
                            style({ transform: 'translateX(-100%)', opacity: 0, height: '*' }),
                            animate(ANIMATION_IN_DURATION)
                        ]),
                        transition('flyInOutLeft => componentHide', [animate(ANIMATION_OUT_DURATION, style(HIDE_STYLE))]),
                        transition('flyInOutLeft => void', [animate(ANIMATION_IN_DURATION, style(HIDE_STYLE))]),
                        state('componentHide', style(HIDE_STYLE))
                    ])
                ]
            }]
    }], function () { return [{ type: ɵngcc1.NotifyQueueStore }, { type: ɵngcc0.NgZone }]; }, { className: [{
            type: HostBinding,
            args: ['class']
        }], thyOption: [{
            type: Input
        }], flyInOut: [{
            type: HostBinding,
            args: ['@flyInOut']
        }], mouseenter: [{
            type: HostListener,
            args: ['mouseenter']
        }], mouseleave: [{
            type: HostListener,
            args: ['mouseleave']
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm90aWZ5LmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL25vdGlmeS9ub3RpZnkuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBVSxZQUFZLEVBQWEsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXZHLE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDakYsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDekQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDeEQsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLGlCQUFpQixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFMUMsTUFBTSxxQkFBcUIsR0FBRyxHQUFHLENBQUM7QUFDbEMsTUFBTSxzQkFBc0IsR0FBRyxHQUFHLENBQUM7QUFDbkMsTUFBTSxVQUFVLEdBQUcsRUFBRSxTQUFTLEVBQUUsZUFBZSxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLENBQUMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFFLGFBQWEsRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLENBQUMsRUFBRSxDQUFDO0FBNEJySCxNQUFNLE9BQU8sa0JBQWtCO0FBQUcsSUE4QjlCLFlBQW9CLFdBQTZCLEVBQVUsT0FBZTtBQUFJLFFBQTFELGdCQUFXLEdBQVgsV0FBVyxDQUFrQjtBQUFDLFFBQVMsWUFBTyxHQUFQLE9BQU8sQ0FBUTtBQUFDLFFBM0JyRCxjQUFTLEdBQUcsRUFBRSxDQUFDO0FBQ3pDLFFBR0ksbUJBQWMsR0FBRyxFQUFFLENB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Ozs7Ozs7b0JBQUU7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIEhvc3RCaW5kaW5nLCBPbkluaXQsIEhvc3RMaXN0ZW5lciwgT25EZXN0cm95LCBOZ1pvbmUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFRoeU5vdGlmeURldGFpbCwgTm90aWZ5UGxhY2VtZW50LCBUaHlOb3RpZnlPcHRpb25zIH0gZnJvbSAnLi9ub3RpZnktb3B0aW9uLmludGVyZmFjZSc7XG5pbXBvcnQgeyB0cmlnZ2VyLCBzdGF0ZSwgc3R5bGUsIGFuaW1hdGUsIHRyYW5zaXRpb24gfSBmcm9tICdAYW5ndWxhci9hbmltYXRpb25zJztcbmltcG9ydCB7IFVwZGF0ZUhvc3RDbGFzc1NlcnZpY2UgfSBmcm9tICduZ3gtdGV0aHlzL2NvcmUnO1xuaW1wb3J0IHsgTm90aWZ5UXVldWVTdG9yZSB9IGZyb20gJy4vbm90aWZ5LXF1ZXVlLnN0b3JlJztcbmltcG9ydCB7IGhlbHBlcnMgfSBmcm9tICduZ3gtdGV0aHlzL3V0aWwnO1xuXG5jb25zdCBBTklNQVRJT05fSU5fRFVSQVRJT04gPSAxMDA7XG5jb25zdCBBTklNQVRJT05fT1VUX0RVUkFUSU9OID0gMTUwO1xuY29uc3QgSElERV9TVFlMRSA9IHsgdHJhbnNmb3JtOiAndHJhbnNsYXRlWCgwKScsIG9wYWNpdHk6IDAsIGhlaWdodDogMCwgcGFkZGluZ1RvcDogMCwgcGFkZGluZ0JvdHRvbTogMCwgbWFyZ2luOiAwIH07XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAndGh5LW5vdGlmeScsXG4gICAgdGVtcGxhdGVVcmw6ICcuL25vdGlmeS5jb21wb25lbnQuaHRtbCcsXG4gICAgcHJvdmlkZXJzOiBbVXBkYXRlSG9zdENsYXNzU2VydmljZV0sXG4gICAgYW5pbWF0aW9uczogW1xuICAgICAgICB0cmlnZ2VyKCdmbHlJbk91dCcsIFtcbiAgICAgICAgICAgIHN0YXRlKCdmbHlJbk91dFJpZ2h0Jywgc3R5bGUoeyB0cmFuc2Zvcm06ICd0cmFuc2xhdGVYKDApJywgb3BhY2l0eTogMSwgaGVpZ2h0OiAnKicgfSkpLFxuICAgICAgICAgICAgdHJhbnNpdGlvbigndm9pZCA9PiBmbHlJbk91dFJpZ2h0JywgW1xuICAgICAgICAgICAgICAgIHN0eWxlKHsgdHJhbnNmb3JtOiAndHJhbnNsYXRlWCgxMDAlKScsIG9wYWNpdHk6IDAsIGhlaWdodDogJyonIH0pLFxuICAgICAgICAgICAgICAgIGFuaW1hdGUoQU5JTUFUSU9OX0lOX0RVUkFUSU9OKVxuICAgICAgICAgICAgXSksXG4gICAgICAgICAgICB0cmFuc2l0aW9uKCdmbHlJbk91dFJpZ2h0ID0+IGNvbXBvbmVudEhpZGUnLCBbYW5pbWF0ZShBTklNQVRJT05fT1VUX0RVUkFUSU9OLCBzdHlsZShISURFX1NUWUxFKSldKSxcbiAgICAgICAgICAgIHRyYW5zaXRpb24oJ2ZseUluT3V0UmlnaHQgPT4gdm9pZCcsIFthbmltYXRlKEFOSU1BVElPTl9JTl9EVVJBVElPTiwgc3R5bGUoSElERV9TVFlMRSkpXSksXG5cbiAgICAgICAgICAgIHN0YXRlKCdmbHlJbk91dExlZnQnLCBzdHlsZSh7IHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVgoMCknLCBvcGFjaXR5OiAxLCBoZWlnaHQ6ICcqJyB9KSksXG4gICAgICAgICAgICB0cmFuc2l0aW9uKCd2b2lkID0+IGZseUluT3V0TGVmdCcsIFtcbiAgICAgICAgICAgICAgICBzdHlsZSh7IHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVgoLTEwMCUpJywgb3BhY2l0eTogMCwgaGVpZ2h0OiAnKicgfSksXG4gICAgICAgICAgICAgICAgYW5pbWF0ZShBTklNQVRJT05fSU5fRFVSQVRJT04pXG4gICAgICAgICAgICBdKSxcbiAgICAgICAgICAgIHRyYW5zaXRpb24oJ2ZseUluT3V0TGVmdCA9PiBjb21wb25lbnRIaWRlJywgW2FuaW1hdGUoQU5JTUFUSU9OX09VVF9EVVJBVElPTiwgc3R5bGUoSElERV9TVFlMRSkpXSksXG4gICAgICAgICAgICB0cmFuc2l0aW9uKCdmbHlJbk91dExlZnQgPT4gdm9pZCcsIFthbmltYXRlKEFOSU1BVElPTl9JTl9EVVJBVElPTiwgc3R5bGUoSElERV9TVFlMRSkpXSksXG5cbiAgICAgICAgICAgIHN0YXRlKCdjb21wb25lbnRIaWRlJywgc3R5bGUoSElERV9TVFlMRSkpXG4gICAgICAgIF0pXG4gICAgXVxufSlcbmV4cG9ydCBjbGFzcyBUaHlOb3RpZnlDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG4gICAgQEhvc3RCaW5kaW5nKCdAZmx5SW5PdXQnKSBmbHlJbk91dDogc3RyaW5nO1xuXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcycpIGNsYXNzTmFtZSA9ICcnO1xuXG4gICAgb3B0aW9uOiBUaHlOb3RpZnlPcHRpb25zO1xuXG4gICAgbm90aWZ5SWNvbk5hbWUgPSAnJztcblxuICAgIGV4dGVuZENvbnRlbnRDbGFzcyA9IGZhbHNlO1xuXG4gICAgY2xvc2VUaW1lcjogYW55O1xuXG4gICAgaXNTaG93RGV0YWlsID0gZmFsc2U7XG5cbiAgICBwbGFjZW1lbnQ6IE5vdGlmeVBsYWNlbWVudDtcblxuICAgIEBJbnB1dCgpXG4gICAgc2V0IHRoeU9wdGlvbih2YWx1ZTogVGh5Tm90aWZ5T3B0aW9ucykge1xuICAgICAgICB0aGlzLm9wdGlvbiA9IHZhbHVlO1xuICAgICAgICBjb25zdCB0eXBlID0gdmFsdWUudHlwZTtcbiAgICAgICAgdGhpcy5wbGFjZW1lbnQgPSB2YWx1ZS5wbGFjZW1lbnQgfHwgJ3RvcFJpZ2h0JztcbiAgICAgICAgaWYgKHRoaXMucGxhY2VtZW50ID09PSAndG9wTGVmdCcgfHwgdGhpcy5wbGFjZW1lbnQgPT09ICdib3R0b21MZWZ0Jykge1xuICAgICAgICAgICAgdGhpcy5mbHlJbk91dCA9ICdmbHlJbk91dExlZnQnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5mbHlJbk91dCA9ICdmbHlJbk91dFJpZ2h0JztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNsYXNzTmFtZSA9IGB0aHktbm90aWZ5IHRoeS1ub3RpZnktJHt0eXBlfWA7XG4gICAgfVxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBfcXVldWVTdG9yZTogTm90aWZ5UXVldWVTdG9yZSwgcHJpdmF0ZSBfbmdab25lOiBOZ1pvbmUpIHt9XG5cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgY29uc3QgaWNvbk5hbWUgPSB7XG4gICAgICAgICAgICBzdWNjZXNzOiAnY2hlY2stY2lyY2xlLWZpbGwnLFxuICAgICAgICAgICAgaW5mbzogJ2luZm8tY2lyY2xlLWZpbGwnLFxuICAgICAgICAgICAgd2FybmluZzogJ3dhcmluZy1maWxsJyxcbiAgICAgICAgICAgIGVycm9yOiAnY2xvc2UtY2lyY2xlLWZpbGwnXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5ub3RpZnlJY29uTmFtZSA9IGljb25OYW1lW3RoaXMub3B0aW9uLnR5cGVdO1xuICAgICAgICB0aGlzLl9jcmVhdENsb3NlVGltZXIoKTtcbiAgICB9XG5cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5fY2xlYXJDbG9zZVRpbWVyKCk7XG4gICAgfVxuXG4gICAgZXh0ZW5kQ29udGVudCgpIHtcbiAgICAgICAgdGhpcy5leHRlbmRDb250ZW50Q2xhc3MgPSB0cnVlO1xuICAgIH1cblxuICAgIHNob3dEZXRhaWxUb2dnbGUoKSB7XG4gICAgICAgIHRoaXMuaXNTaG93RGV0YWlsID0gIXRoaXMuaXNTaG93RGV0YWlsO1xuICAgIH1cblxuICAgIGNsb3NlTm90aWZ5KCkge1xuICAgICAgICB0aGlzLl9uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5mbHlJbk91dCA9ICdjb21wb25lbnRIaWRlJztcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX3F1ZXVlU3RvcmUucmVtb3ZlTm90aWZ5KHRoaXMub3B0aW9uLmlkLCB0aGlzLnBsYWNlbWVudCk7XG4gICAgICAgICAgICB9LCBBTklNQVRJT05fT1VUX0RVUkFUSU9OKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdHJpZ2dlckRldGFpbCgpIHtcbiAgICAgICAgaWYgKGhlbHBlcnMuaXNGdW5jdGlvbigodGhpcy5vcHRpb24uZGV0YWlsIGFzIFRoeU5vdGlmeURldGFpbCkuYWN0aW9uKSkge1xuICAgICAgICAgICAgKHRoaXMub3B0aW9uLmRldGFpbCBhcyBUaHlOb3RpZnlEZXRhaWwpLmFjdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICgodGhpcy5vcHRpb24uZGV0YWlsIGFzIFRoeU5vdGlmeURldGFpbCkuY29udGVudCkge1xuICAgICAgICAgICAgdGhpcy5zaG93RGV0YWlsVG9nZ2xlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBASG9zdExpc3RlbmVyKCdtb3VzZWVudGVyJykgbW91c2VlbnRlcigpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9uLnBhdXNlT25Ib3Zlcikge1xuICAgICAgICAgICAgdGhpcy5fY2xlYXJDbG9zZVRpbWVyKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBASG9zdExpc3RlbmVyKCdtb3VzZWxlYXZlJykgbW91c2VsZWF2ZSgpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9uLnBhdXNlT25Ib3Zlcikge1xuICAgICAgICAgICAgdGhpcy5fY3JlYXRDbG9zZVRpbWVyKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIF9jcmVhdENsb3NlVGltZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbi5kdXJhdGlvbikge1xuICAgICAgICAgICAgdGhpcy5jbG9zZVRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5jbG9zZVRpbWVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlTm90aWZ5KCk7XG4gICAgICAgICAgICB9LCB0aGlzLm9wdGlvbi5kdXJhdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIF9jbGVhckNsb3NlVGltZXIoKSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5jbG9zZVRpbWVyKTtcbiAgICB9XG59XG4iXX0=
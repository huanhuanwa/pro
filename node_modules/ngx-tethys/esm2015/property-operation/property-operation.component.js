import { Component, ContentChild, ElementRef, EventEmitter, HostBinding, Input, Output, TemplateRef, ViewChild, HostListener } from '@angular/core';
import { UpdateHostClassService, ThyTranslate } from 'ngx-tethys/core';
import { htmlElementIsEmpty, coerceBooleanProperty } from 'ngx-tethys/util';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from 'ngx-tethys/core';
import * as ɵngcc2 from '@angular/common';
import * as ɵngcc3 from 'ngx-tethys/button';
import * as ɵngcc4 from 'ngx-tethys/flexible-text';
import * as ɵngcc5 from 'ngx-tethys/icon';

const _c0 = ["operationIcon"];
const _c1 = ["contentElement"];
function ThyPropertyOperationComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
const _c2 = function (a0) { return { disabled: a0 }; };
function ThyPropertyOperationComponent_button_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "button", 8);
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction1(3, _c2, ctx_r1.disabled))("thyButtonIcon", ctx_r1.icon)("thyShape", ctx_r1.onlyHasTips ? "circle-thick-dashed" : "circle-thick-solid");
} }
function ThyPropertyOperationComponent_ng_container_7_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "span", 9);
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r3 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("thyTooltipContent", ctx_r3.value);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r3.value);
} }
function ThyPropertyOperationComponent_div_8_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 10);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r4.labelText);
} }
function ThyPropertyOperationComponent_span_9_Template(rf, ctx) { if (rf & 1) {
    const _r7 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "span", 11);
    ɵngcc0.ɵɵlistener("click", function ThyPropertyOperationComponent_span_9_Template_span_click_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r7); const ctx_r6 = ɵngcc0.ɵɵnextContext(); return ctx_r6.remove($event); });
    ɵngcc0.ɵɵelement(1, "thy-icon", 12);
    ɵngcc0.ɵɵelementEnd();
} }
const _c3 = function (a0) { return { "only-has-tips": a0 }; };
const _c4 = ["*"];
export class ThyPropertyOperationComponent {
    constructor(thyTranslate, updateHostClassService, elementRef) {
        this.thyTranslate = thyTranslate;
        this.updateHostClassService = updateHostClassService;
        this.elementRef = elementRef;
        this.initialized = false;
        this.onlyHasTips = false;
        this.showClose = false;
        this.labelHideWhenHasValue = false;
        this.thyOnRemove = new EventEmitter();
        this.thyClick = new EventEmitter();
        this._isPropertyOperation = true;
    }
    set thyLabelText(value) {
        this.labelText = value;
    }
    set thyValue(value) {
        this.value = value;
        this.setOnlyHasTips();
    }
    set thyLabelTextTranslateKey(value) {
        this.labelText = this.thyTranslate.instant(value);
    }
    set thyIcon(value) {
        this.icon = value;
    }
    set thyShowClose(value) {
        this.showClose = coerceBooleanProperty(value);
    }
    // 支持有值时，label不显示
    set thyLabelHasValue(value) {
        this.labelHideWhenHasValue = !coerceBooleanProperty(value);
    }
    set thyLabelHideWhenHasValue(value) {
        this.labelHideWhenHasValue = coerceBooleanProperty(value);
    }
    set thyType(value) {
        this.type = value;
        this.setHostClass();
    }
    setHostClass(first = false) {
        if (!this.initialized && !first) {
            return;
        }
        this.updateHostClassService.updateClass(this.type ? [`thy-property-operation-${this.type}`] : []);
    }
    setOnlyHasTips(first = false) {
        if (!this.initialized && !first) {
            return;
        }
        if (this.value) {
            this.onlyHasTips = false;
        }
        else if (htmlElementIsEmpty(this.contentElement.nativeElement)) {
            this.onlyHasTips = true;
        }
        else {
            this.onlyHasTips = false;
        }
    }
    ngOnInit() {
        this.updateHostClassService.initializeElement(this.elementRef.nativeElement);
        this.setHostClass(true);
    }
    onclick(event) {
        if (!this.disabled) {
            this.thyClick.emit(event);
        }
    }
    ngAfterContentInit() {
        this.setOnlyHasTips(true);
        this.initialized = true;
    }
    remove($event) {
        $event.stopPropagation();
        this.thyOnRemove.emit($event);
    }
}
ThyPropertyOperationComponent.ɵfac = function ThyPropertyOperationComponent_Factory(t) { return new (t || ThyPropertyOperationComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.ThyTranslate), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.UpdateHostClassService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef)); };
ThyPropertyOperationComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: ThyPropertyOperationComponent, selectors: [["thy-property-operation"]], contentQueries: function ThyPropertyOperationComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, _c0, true);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.operationIcon = _t.first);
    } }, viewQuery: function ThyPropertyOperationComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵstaticViewQuery(_c1, true);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.contentElement = _t.first);
    } }, hostVars: 6, hostBindings: function ThyPropertyOperationComponent_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("click", function ThyPropertyOperationComponent_click_HostBindingHandler($event) { return ctx.onclick($event); });
    } if (rf & 2) {
        ɵngcc0.ɵɵclassProp("thy-property-operation", ctx._isPropertyOperation)("active", ctx.active)("thy-property-operation-disabled", ctx.disabled);
    } }, inputs: { thyLabelText: "thyLabelText", thyValue: "thyValue", thyLabelTextTranslateKey: "thyLabelTextTranslateKey", thyIcon: "thyIcon", thyShowClose: "thyShowClose", thyLabelHasValue: "thyLabelHasValue", thyLabelHideWhenHasValue: "thyLabelHideWhenHasValue", thyType: "thyType", active: ["thyActive", "active"], disabled: ["thyDisabled", "disabled"] }, outputs: { thyOnRemove: "thyOnRemove", thyClick: "thyClick" }, features: [ɵngcc0.ɵɵProvidersFeature([UpdateHostClassService])], ngContentSelectors: _c4, decls: 10, vars: 8, consts: [[1, "thy-operation-icon"], [4, "ngTemplateOutlet"], [3, "ngClass", "thyButtonIcon", "thyShape", 4, "ngIf"], [1, "thy-operation-content", 3, "ngClass"], ["contentElement", ""], [4, "ngIf"], ["class", "thy-tips", 4, "ngIf"], ["class", "close-link close-link-danger", 3, "click", 4, "ngIf"], [3, "ngClass", "thyButtonIcon", "thyShape"], ["thyFlexibleText", "", 3, "thyTooltipContent"], [1, "thy-tips"], [1, "close-link", "close-link-danger", 3, "click"], ["thyIconName", "close", 1, "close-link-sm"]], template: function ThyPropertyOperationComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵprojectionDef();
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵtemplate(1, ThyPropertyOperationComponent_ng_container_1_Template, 1, 0, "ng-container", 1);
        ɵngcc0.ɵɵtemplate(2, ThyPropertyOperationComponent_button_2_Template, 1, 5, "button", 2);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(3, "div", 3);
        ɵngcc0.ɵɵelementStart(4, "div", null, 4);
        ɵngcc0.ɵɵprojection(6);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(7, ThyPropertyOperationComponent_ng_container_7_Template, 3, 2, "ng-container", 5);
        ɵngcc0.ɵɵtemplate(8, ThyPropertyOperationComponent_div_8_Template, 2, 1, "div", 6);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(9, ThyPropertyOperationComponent_span_9_Template, 2, 0, "span", 7);
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx.operationIcon);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.icon);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction1(6, _c3, ctx.onlyHasTips));
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵproperty("ngIf", ctx.value);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.value || !ctx.labelHideWhenHasValue && ctx.value);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.showClose && !ctx.disabled);
    } }, directives: [ɵngcc2.NgTemplateOutlet, ɵngcc2.NgIf, ɵngcc2.NgClass, ɵngcc3.ThyButtonIconComponent, ɵngcc4.ThyFlexibleTextComponent, ɵngcc5.ThyIconComponent], encapsulation: 2 });
ThyPropertyOperationComponent.ctorParameters = () => [
    { type: ThyTranslate },
    { type: UpdateHostClassService },
    { type: ElementRef }
];
ThyPropertyOperationComponent.propDecorators = {
    thyOnRemove: [{ type: Output }],
    thyClick: [{ type: Output }],
    _isPropertyOperation: [{ type: HostBinding, args: ['class.thy-property-operation',] }],
    operationIcon: [{ type: ContentChild, args: ['operationIcon',] }],
    contentElement: [{ type: ViewChild, args: ['contentElement', { static: true },] }],
    thyLabelText: [{ type: Input }],
    thyValue: [{ type: Input }],
    thyLabelTextTranslateKey: [{ type: Input }],
    thyIcon: [{ type: Input }],
    thyShowClose: [{ type: Input }],
    thyLabelHasValue: [{ type: Input }],
    thyLabelHideWhenHasValue: [{ type: Input }],
    thyType: [{ type: Input }],
    active: [{ type: HostBinding, args: ['class.active',] }, { type: Input, args: ['thyActive',] }],
    disabled: [{ type: HostBinding, args: ['class.thy-property-operation-disabled',] }, { type: Input, args: ['thyDisabled',] }],
    onclick: [{ type: HostListener, args: ['click', ['$event'],] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ThyPropertyOperationComponent, [{
        type: Component,
        args: [{
                selector: 'thy-property-operation',
                template: "<div class=\"thy-operation-icon\">\n  <ng-container *ngTemplateOutlet=\"operationIcon\"></ng-container>\n  <button\n    *ngIf=\"icon\"\n    [ngClass]=\"{ disabled: disabled }\"\n    [thyButtonIcon]=\"icon\"\n    [thyShape]=\"onlyHasTips ? 'circle-thick-dashed' : 'circle-thick-solid'\"\n  ></button>\n</div>\n<div class=\"thy-operation-content\" [ngClass]=\"{ 'only-has-tips': onlyHasTips }\">\n  <div #contentElement>\n    <ng-content></ng-content>\n  </div>\n  <ng-container *ngIf=\"value\">\n    <span thyFlexibleText [thyTooltipContent]=\"value\">{{ value }}</span>\n  </ng-container>\n\n  <div class=\"thy-tips\" *ngIf=\"!value || (!labelHideWhenHasValue && value)\">{{ labelText }}</div>\n</div>\n<span *ngIf=\"showClose && !disabled\" (click)=\"remove($event)\" class=\"close-link close-link-danger\">\n  <thy-icon thyIconName=\"close\" class=\" close-link-sm\"></thy-icon>\n</span>\n",
                providers: [UpdateHostClassService]
            }]
    }], function () { return [{ type: ɵngcc1.ThyTranslate }, { type: ɵngcc1.UpdateHostClassService }, { type: ɵngcc0.ElementRef }]; }, { thyOnRemove: [{
            type: Output
        }], thyClick: [{
            type: Output
        }], _isPropertyOperation: [{
            type: HostBinding,
            args: ['class.thy-property-operation']
        }], thyLabelText: [{
            type: Input
        }], thyValue: [{
            type: Input
        }], thyLabelTextTranslateKey: [{
            type: Input
        }], thyIcon: [{
            type: Input
        }], thyShowClose: [{
            type: Input
        }], thyLabelHasValue: [{
            type: Input
        }], thyLabelHideWhenHasValue: [{
            type: Input
        }], thyType: [{
            type: Input
        }], onclick: [{
            type: HostListener,
            args: ['click', ['$event']]
        }], operationIcon: [{
            type: ContentChild,
            args: ['operationIcon']
        }], contentElement: [{
            type: ViewChild,
            args: ['contentElement', { static: true }]
        }], active: [{
            type: HostBinding,
            args: ['class.active']
        }, {
            type: Input,
            args: ['thyActive']
        }], disabled: [{
            type: HostBinding,
            args: ['class.thy-property-operation-disabled']
        }, {
            type: Input,
            args: ['thyDisabled']
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcGVydHktb3BlcmF0aW9uLmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3Byb3BlcnR5LW9wZXJhdGlvbi9wcm9wZXJ0eS1vcGVyYXRpb24uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFFSCxTQUFTLEVBQ1QsWUFBWSxFQUNaLFVBQVUsRUFDVixZQUFZLEVBQ1osV0FBVyxFQUNYLEtBQUssRUFFTCxNQUFNLEVBQ04sV0FBVyxFQUNYLFNBQVMsRUFDVCxZQUFZLEVBQ2YsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLHNCQUFzQixFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3ZFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGlCQUFpQixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFTNUUsTUFBTSxPQUFPLDZCQUE2QjtBQUFHLElBZ0d6QyxZQUNZLFlBQTBCLEVBQzFCLHNCQUE4QyxFQUM5QyxVQUFzQjtBQUNuQyxRQUhhLGlCQUFZLEdBQVosWUFBWSxDQUFjO0FBQUMsUUFDM0IsMkJBQXNCLEdBQXRCLHNCQUFzQixDQUF3QjtBQUFDLFFBQy9DLGVBQVUsR0FBVixVQUFVLENBQVk7QUFDdEMsUUFuR1ksZ0JBQVcsR0FBRyxLQUFLLENBQUM7QUFDaEMsUUFHSSxnQkFBVyxHQUFHLEtBQUssQ0FBQztBQUN4QixRQUNJLGNBQVMsR0FBRyxLQUFLLENBQUM7QUFDdEIsUUFPSSwwQkFBcUIsR0FBRyxLQUFLLENBQUM7QUFDbEMsUUFDYyxnQkFBVyxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7QUFDL0MsUUFDYyxhQUFRLEdBQUcsSUFBSSxZQUFZLEVBQVMsQ0FBQztBQUNuRCxRQUNpRCx5QkFBb0IsR0FBRyxJQUFJLENBQUM7QUFDN0UsSUE4RU8sQ0FBQztBQUNSLElBMUVJLElBQ0ksWUFB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T0FBTyxFQUFFLENBQUMsUUFBUSxDQUFDO0FBQ2pDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICAgIEFmdGVyQ29udGVudEluaXQsXG4gICAgQ29tcG9uZW50LFxuICAgIENvbnRlbnRDaGlsZCxcbiAgICBFbGVtZW50UmVmLFxuICAgIEV2ZW50RW1pdHRlcixcbiAgICBIb3N0QmluZGluZyxcbiAgICBJbnB1dCxcbiAgICBPbkluaXQsXG4gICAgT3V0cHV0LFxuICAgIFRlbXBsYXRlUmVmLFxuICAgIFZpZXdDaGlsZCxcbiAgICBIb3N0TGlzdGVuZXJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBVcGRhdGVIb3N0Q2xhc3NTZXJ2aWNlLCBUaHlUcmFuc2xhdGUgfSBmcm9tICduZ3gtdGV0aHlzL2NvcmUnO1xuaW1wb3J0IHsgaHRtbEVsZW1lbnRJc0VtcHR5LCBjb2VyY2VCb29sZWFuUHJvcGVydHkgfSBmcm9tICduZ3gtdGV0aHlzL3V0aWwnO1xuXG50eXBlIFRoeVByb3BlcnR5T3BlcmF0aW9uVHlwZXMgPSAncHJpbWFyeScgfCAnc3VjY2VzcycgfCAnd2FybmluZycgfCAnZGFuZ2VyJztcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICd0aHktcHJvcGVydHktb3BlcmF0aW9uJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vcHJvcGVydHktb3BlcmF0aW9uLmNvbXBvbmVudC5odG1sJyxcbiAgICBwcm92aWRlcnM6IFtVcGRhdGVIb3N0Q2xhc3NTZXJ2aWNlXVxufSlcbmV4cG9ydCBjbGFzcyBUaHlQcm9wZXJ0eU9wZXJhdGlvbkNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJDb250ZW50SW5pdCB7XG4gICAgcHJpdmF0ZSBpbml0aWFsaXplZCA9IGZhbHNlO1xuXG4gICAgbGFiZWxUZXh0OiBzdHJpbmc7XG5cbiAgICBvbmx5SGFzVGlwcyA9IGZhbHNlO1xuXG4gICAgc2hvd0Nsb3NlID0gZmFsc2U7XG5cbiAgICB0eXBlOiBUaHlQcm9wZXJ0eU9wZXJhdGlvblR5cGVzO1xuXG4gICAgaWNvbjogc3RyaW5nO1xuXG4gICAgdmFsdWU6IHN0cmluZztcblxuICAgIGxhYmVsSGlkZVdoZW5IYXNWYWx1ZSA9IGZhbHNlO1xuXG4gICAgQE91dHB1dCgpIHRoeU9uUmVtb3ZlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gICAgQE91dHB1dCgpIHRoeUNsaWNrID0gbmV3IEV2ZW50RW1pdHRlcjxFdmVudD4oKTtcblxuICAgIEBIb3N0QmluZGluZygnY2xhc3MudGh5LXByb3BlcnR5LW9wZXJhdGlvbicpIF9pc1Byb3BlcnR5T3BlcmF0aW9uID0gdHJ1ZTtcblxuICAgIEBDb250ZW50Q2hpbGQoJ29wZXJhdGlvbkljb24nKSBvcGVyYXRpb25JY29uOiBUZW1wbGF0ZVJlZjxhbnk+O1xuXG4gICAgQFZpZXdDaGlsZCgnY29udGVudEVsZW1lbnQnLCB7IHN0YXRpYzogdHJ1ZSB9KSBjb250ZW50RWxlbWVudDogRWxlbWVudFJlZjtcblxuICAgIEBJbnB1dCgpXG4gICAgc2V0IHRoeUxhYmVsVGV4dCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMubGFiZWxUZXh0ID0gdmFsdWU7XG4gICAgfVxuXG4gICAgQElucHV0KClcbiAgICBzZXQgdGh5VmFsdWUodmFsdWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMuc2V0T25seUhhc1RpcHMoKTtcbiAgICB9XG5cbiAgICBASW5wdXQoKVxuICAgIHNldCB0aHlMYWJlbFRleHRUcmFuc2xhdGVLZXkodmFsdWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLmxhYmVsVGV4dCA9IHRoaXMudGh5VHJhbnNsYXRlLmluc3RhbnQodmFsdWUpO1xuICAgIH1cblxuICAgIEBJbnB1dCgpXG4gICAgc2V0IHRoeUljb24odmFsdWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLmljb24gPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBASW5wdXQoKVxuICAgIHNldCB0aHlTaG93Q2xvc2UodmFsdWU6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5zaG93Q2xvc2UgPSBjb2VyY2VCb29sZWFuUHJvcGVydHkodmFsdWUpO1xuICAgIH1cblxuICAgIC8vIOaUr+aMgeacieWAvOaXtu+8jGxhYmVs5LiN5pi+56S6XG4gICAgQElucHV0KCkgc2V0IHRoeUxhYmVsSGFzVmFsdWUodmFsdWU6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5sYWJlbEhpZGVXaGVuSGFzVmFsdWUgPSAhY29lcmNlQm9vbGVhblByb3BlcnR5KHZhbHVlKTtcbiAgICB9XG5cbiAgICBASW5wdXQoKSBzZXQgdGh5TGFiZWxIaWRlV2hlbkhhc1ZhbHVlKHZhbHVlOiBib29sZWFuKSB7XG4gICAgICAgIHRoaXMubGFiZWxIaWRlV2hlbkhhc1ZhbHVlID0gY29lcmNlQm9vbGVhblByb3BlcnR5KHZhbHVlKTtcbiAgICB9XG5cbiAgICBASW5wdXQoKVxuICAgIHNldCB0aHlUeXBlKHZhbHVlOiBUaHlQcm9wZXJ0eU9wZXJhdGlvblR5cGVzKSB7XG4gICAgICAgIHRoaXMudHlwZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnNldEhvc3RDbGFzcygpO1xuICAgIH1cblxuICAgIEBIb3N0QmluZGluZygnY2xhc3MuYWN0aXZlJylcbiAgICBASW5wdXQoJ3RoeUFjdGl2ZScpXG4gICAgYWN0aXZlOiBib29sZWFuO1xuXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy50aHktcHJvcGVydHktb3BlcmF0aW9uLWRpc2FibGVkJylcbiAgICBASW5wdXQoJ3RoeURpc2FibGVkJylcbiAgICBkaXNhYmxlZDogYm9vbGVhbjtcblxuICAgIHByaXZhdGUgc2V0SG9zdENsYXNzKGZpcnN0ID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKCF0aGlzLmluaXRpYWxpemVkICYmICFmaXJzdCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlSG9zdENsYXNzU2VydmljZS51cGRhdGVDbGFzcyh0aGlzLnR5cGUgPyBbYHRoeS1wcm9wZXJ0eS1vcGVyYXRpb24tJHt0aGlzLnR5cGV9YF0gOiBbXSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRPbmx5SGFzVGlwcyhmaXJzdCA9IGZhbHNlKSB7XG4gICAgICAgIGlmICghdGhpcy5pbml0aWFsaXplZCAmJiAhZmlyc3QpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy52YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5vbmx5SGFzVGlwcyA9IGZhbHNlO1xuICAgICAgICB9IGVsc2UgaWYgKGh0bWxFbGVtZW50SXNFbXB0eSh0aGlzLmNvbnRlbnRFbGVtZW50Lm5hdGl2ZUVsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aGlzLm9ubHlIYXNUaXBzID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMub25seUhhc1RpcHMgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHRoeVRyYW5zbGF0ZTogVGh5VHJhbnNsYXRlLFxuICAgICAgICBwcml2YXRlIHVwZGF0ZUhvc3RDbGFzc1NlcnZpY2U6IFVwZGF0ZUhvc3RDbGFzc1NlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgZWxlbWVudFJlZjogRWxlbWVudFJlZlxuICAgICkge31cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLnVwZGF0ZUhvc3RDbGFzc1NlcnZpY2UuaW5pdGlhbGl6ZUVsZW1lbnQodGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQpO1xuICAgICAgICB0aGlzLnNldEhvc3RDbGFzcyh0cnVlKTtcbiAgICB9XG5cbiAgICBASG9zdExpc3RlbmVyKCdjbGljaycsIFsnJGV2ZW50J10pXG4gICAgb25jbGljayhldmVudDogRXZlbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7XG4gICAgICAgICAgICB0aGlzLnRoeUNsaWNrLmVtaXQoZXZlbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmdBZnRlckNvbnRlbnRJbml0KCkge1xuICAgICAgICB0aGlzLnNldE9ubHlIYXNUaXBzKHRydWUpO1xuICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICByZW1vdmUoJGV2ZW50OiBFdmVudCkge1xuICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIHRoaXMudGh5T25SZW1vdmUuZW1pdCgkZXZlbnQpO1xuICAgIH1cbn1cbiJdfQ==
import { Component, ChangeDetectionStrategy, ChangeDetectorRef, Inject, Input } from '@angular/core';
import { ThyDialogRef } from '../dialog-ref';
import { THY_CONFIRM_DEFAULT_OPTIONS, THY_CONFIRM_DEFAULT_OPTIONS_VALUE } from '../confirm.config';
import { finalize } from 'rxjs/operators';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '../dialog-ref';
export class ThyConfirmComponent {
    constructor(dialogRef, changeDetectorRef, defaultConfig) {
        this.dialogRef = dialogRef;
        this.changeDetectorRef = changeDetectorRef;
        this.defaultConfig = defaultConfig;
        this.defaultConfig = Object.assign(Object.assign({}, THY_CONFIRM_DEFAULT_OPTIONS_VALUE), this.defaultConfig);
    }
    ngOnInit() {
        this.defaultConfig = Object.assign(Object.assign({}, this.defaultConfig), this.options);
        this.title = this.defaultConfig.title;
        this.content = this.defaultConfig.content;
        this.okText = this.defaultConfig.okText;
        this.okType = this.defaultConfig.okType;
        this.cancelText = this.defaultConfig.cancelText;
        this.okLoadingText = this.defaultConfig.okLoadingText || this.okText;
        this.footerAlign = this.defaultConfig.footerAlign;
    }
    confirm() {
        this.loading = true;
        const result = this.options.onOk();
        if (result && result.subscribe) {
            result
                .pipe(finalize(() => {
                this.loading = false;
                this.changeDetectorRef.markForCheck();
            }))
                .subscribe(success => {
                if (success) {
                    this.close();
                }
            });
        }
        else {
            this.close();
        }
    }
    close() {
        this.dialogRef.close();
    }
    ngOnDestroy() { }
}
ThyConfirmComponent.ɵfac = function ThyConfirmComponent_Factory(t) { return new (t || ThyConfirmComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.ThyDialogRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(THY_CONFIRM_DEFAULT_OPTIONS)); };
ThyConfirmComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: ThyConfirmComponent, selectors: [["thy-confirm-default"]], inputs: { options: "options" }, decls: 11, vars: 9, consts: [[3, "thyTitle", "thyOnClose"], [1, "thy-form"], ["thyForm", "", "name", "thyConfirm", "thyLayout", "vertical"], [1, "form-group"], [3, "innerHTML"], [3, "thyAlign"], [1, "thy-confirm-footer", 3, "ngClass"], [3, "thyButton", "thyLoading", "thyLoadingText", "click"], ["thyButton", "link-secondary", 1, "thy-confirm-cancel", 3, "click"]], template: function ThyConfirmComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "thy-dialog-header", 0);
        ɵngcc0.ɵɵlistener("thyOnClose", function ThyConfirmComponent_Template_thy_dialog_header_thyOnClose_0_listener() { return ctx.close(); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(1, "thy-dialog-body", 1);
        ɵngcc0.ɵɵelementStart(2, "form", 2);
        ɵngcc0.ɵɵelementStart(3, "div", 3);
        ɵngcc0.ɵɵelement(4, "p", 4);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(5, "thy-form-group-footer", 5);
        ɵngcc0.ɵɵelementStart(6, "div", 6);
        ɵngcc0.ɵɵelementStart(7, "button", 7);
        ɵngcc0.ɵɵlistener("click", function ThyConfirmComponent_Template_button_click_7_listener() { return ctx.confirm(); });
        ɵngcc0.ɵɵtext(8);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(9, "button", 8);
        ɵngcc0.ɵɵlistener("click", function ThyConfirmComponent_Template_button_click_9_listener() { return ctx.close(); });
        ɵngcc0.ɵɵtext(10);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("thyTitle", ctx.title || "Install Angular");
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵproperty("innerHTML", ctx.content, ɵngcc0.ɵɵsanitizeHtml);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("thyAlign", ctx.footerAlign);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngClass", "thy-confirm-footer-" + ctx.footerAlign);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("thyButton", ctx.okType)("thyLoading", ctx.loading)("thyLoadingText", ctx.okLoadingText);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵtextInterpolate(ctx.okText);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵtextInterpolate(ctx.cancelText);
    } }, encapsulation: 2, changeDetection: 0 });
ThyConfirmComponent.ctorParameters = () => [
    { type: ThyDialogRef },
    { type: ChangeDetectorRef },
    { type: undefined, decorators: [{ type: Inject, args: [THY_CONFIRM_DEFAULT_OPTIONS,] }] }
];
ThyConfirmComponent.propDecorators = {
    options: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ThyConfirmComponent, [{
        type: Component,
        args: [{
                selector: 'thy-confirm-default',
                template: "<thy-dialog-header [thyTitle]=\"title || 'Install Angular'\" (thyOnClose)=\"close()\"> </thy-dialog-header>\n<thy-dialog-body class=\"thy-form\">\n  <form thyForm name=\"thyConfirm\" thyLayout=\"vertical\">\n    <div class=\"form-group\">\n      <p [innerHTML]=\"content\"></p>\n    </div>\n    <thy-form-group-footer [thyAlign]=\"footerAlign\">\n      <div class=\"thy-confirm-footer\" [ngClass]=\"'thy-confirm-footer-' + footerAlign\">\n        <button [thyButton]=\"okType\" (click)=\"confirm()\" [thyLoading]=\"loading\" [thyLoadingText]=\"okLoadingText\">{{ okText }}</button>\n        <button thyButton=\"link-secondary\" (click)=\"close()\" class=\"thy-confirm-cancel\">{{ cancelText }}</button>\n      </div>\n    </thy-form-group-footer>\n  </form>\n</thy-dialog-body>\n",
                changeDetection: ChangeDetectionStrategy.OnPush
            }]
    }], function () { return [{ type: ɵngcc1.ThyDialogRef }, { type: ɵngcc0.ChangeDetectorRef }, { type: undefined, decorators: [{
                type: Inject,
                args: [THY_CONFIRM_DEFAULT_OPTIONS]
            }] }]; }, { options: [{
            type: Input
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlybS5jb21wb25lbnQuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9kaWFsb2cvY29uZmlybS9jb25maXJtLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFxQix1QkFBdUIsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3hILE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDN0MsT0FBTyxFQUFvQiwyQkFBMkIsRUFBRSxpQ0FBaUMsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3JILE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQzs7O0FBUTFDLE1BQU0sT0FBTyxtQkFBbUI7QUFBRyxJQW1CL0IsWUFDWSxTQUE0QyxFQUM1QyxpQkFBb0MsRUFDQyxhQUErQjtBQUNqRixRQUhhLGNBQVMsR0FBVCxTQUFTLENBQW1DO0FBQUMsUUFDN0Msc0JBQWlCLEdBQWpCLGlCQUFpQixDQUFtQjtBQUFDLFFBQ0Esa0JBQWEsR0FBYixhQUFhLENBQWtCO0FBQ3BGLFFBQ1EsSUFBSSxDQUFDLGFBQWEsbUNBQVMsaUNBQXNELEdBQUssSUFBSSxDQUFDLGFBQWEsQ0FBRSxDQUFDO0FBQ25ILElBQUksQ0FBQztBQUNMLElBQ0ksUUFBUTtBQUNaLFFBQVEsSUFBSSxDQUFDLGFBQWEsbUNBQVEsSUFBSSxDQUFDLGFBQWEsR0FBSyxJQUFJLENBQUMsT0FBTyxDQUFFLENBQUM7QUFDeEUsUUFBUSxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDO0FBQzlDLFFBQVEsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQztBQUNsRCxRQUFRLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUM7QUFDaEQsUUFBUSxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDO0FBQ2hELFFBQVEsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQztBQUN4RCxRQUFRLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxhQUFhLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQztBQUM3RSxRQUFRLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUM7QUFDMUQsSUFBSSxDQUFDO0FBQ0wsSUFDSSxPQUFPO0FBQ1gsUUFBUSxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztBQUM1QixRQUFRLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUM7QUFDM0MsUUFBUSxJQUFJLE1BQU0sSUFBSSxNQUFNLENBQUMsU0FBUyxFQUFFO0FBQ3hDLFlBQVksTUFBTTtBQUNsQixpQkFBaUIsSUFBSSxDQUNELFFBQVEsQ0FBQyxHQUFHLEVBQUU7QUFDbEMsZ0JBQXdCLElBQUksQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO0FBQzdDLGdCQUF3QixJQUFJLENBQUMsaUJBQWlCLENBQUMsWUFBWSxFQUFFLENBQUM7QUFDOUQsWUFBb0IsQ0FBQyxDQUFDLENBQ0w7QUFDakIsaUJBQWlCLFNBQVMsQ0FBQyxPQUFPLENBQUMsRUFBRTtBQUNyQyxnQkFBb0IsSUFBSSxPQUFPLEVBQUU7QUFDakMsb0JBQXdCLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUNyQyxpQkFBcUI7QUFDckIsWUFBZ0IsQ0FBQyxDQUFDLENBQUM7QUFDbkIsU0FBUztBQUFDLGFBQUs7QUFDZixZQUFZLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUN6QixTQUFTO0FBQ1QsSUFBSSxDQUFDO0FBQ0wsSUFDSSxLQUFLO0FBQ1QsUUFBUSxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxDQUFDO0FBQy9CLElBQUksQ0FBQztBQUNMLElBQ0ksV0FBVyxLQUFJLENBQUM7QUFDcEI7K0NBckVDLFNBQVMsU0FBQyxrQkFDUCxRQUFRLEVBQUUscUJBQXFCLGtCQUMvQjs7O1VBQXVDLGtCQUN2QyxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTSxjQUNsRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7aURBQ0k7QUFBQztBQUE2QyxZQVYxQyxZQUFZO0FBQUksWUFEdUMsaUJBQWlCO0FBQUksNENBaUM1RSxNQUFNLFNBQUMsMkJBQTJCO0FBQVE7QUFBRztBQUV0RCxzQkFyQkssS0FBSztBQUFJOzs7Ozs7Ozs7Ozs7O29CQUFFO0FBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgT25EZXN0cm95LCBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgQ2hhbmdlRGV0ZWN0b3JSZWYsIEluamVjdCwgSW5wdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFRoeURpYWxvZ1JlZiB9IGZyb20gJy4uL2RpYWxvZy1yZWYnO1xuaW1wb3J0IHsgVGh5Q29uZmlybUNvbmZpZywgVEhZX0NPTkZJUk1fREVGQVVMVF9PUFRJT05TLCBUSFlfQ09ORklSTV9ERUZBVUxUX09QVElPTlNfVkFMVUUgfSBmcm9tICcuLi9jb25maXJtLmNvbmZpZyc7XG5pbXBvcnQgeyBmaW5hbGl6ZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IFRoeUZvcm1Hcm91cEZvb3RlckFsaWduIH0gZnJvbSAnbmd4LXRldGh5cy9mb3JtJztcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICd0aHktY29uZmlybS1kZWZhdWx0JyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vY29uZmlybS5jb21wb25lbnQuaHRtbCcsXG4gICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcbn0pXG5leHBvcnQgY2xhc3MgVGh5Q29uZmlybUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcbiAgICBsb2FkaW5nOiBib29sZWFuO1xuXG4gICAgQElucHV0KCkgb3B0aW9uczogVGh5Q29uZmlybUNvbmZpZztcblxuICAgIHB1YmxpYyB0aXRsZTogc3RyaW5nO1xuXG4gICAgcHVibGljIGNvbnRlbnQ6IHN0cmluZztcblxuICAgIHB1YmxpYyBva1RleHQ6IHN0cmluZztcblxuICAgIHB1YmxpYyBva1R5cGU6IHN0cmluZztcblxuICAgIHB1YmxpYyBjYW5jZWxUZXh0OiBzdHJpbmc7XG5cbiAgICBwdWJsaWMgb2tMb2FkaW5nVGV4dDogc3RyaW5nO1xuXG4gICAgcHVibGljIGZvb3RlckFsaWduOiBUaHlGb3JtR3JvdXBGb290ZXJBbGlnbjtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGRpYWxvZ1JlZjogVGh5RGlhbG9nUmVmPFRoeUNvbmZpcm1Db21wb25lbnQ+LFxuICAgICAgICBwcml2YXRlIGNoYW5nZURldGVjdG9yUmVmOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICAgICAgQEluamVjdChUSFlfQ09ORklSTV9ERUZBVUxUX09QVElPTlMpIHByaXZhdGUgZGVmYXVsdENvbmZpZzogVGh5Q29uZmlybUNvbmZpZ1xuICAgICkge1xuICAgICAgICB0aGlzLmRlZmF1bHRDb25maWcgPSB7IC4uLihUSFlfQ09ORklSTV9ERUZBVUxUX09QVElPTlNfVkFMVUUgYXMgVGh5Q29uZmlybUNvbmZpZyksIC4uLnRoaXMuZGVmYXVsdENvbmZpZyB9O1xuICAgIH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLmRlZmF1bHRDb25maWcgPSB7IC4uLnRoaXMuZGVmYXVsdENvbmZpZywgLi4udGhpcy5vcHRpb25zIH07XG4gICAgICAgIHRoaXMudGl0bGUgPSB0aGlzLmRlZmF1bHRDb25maWcudGl0bGU7XG4gICAgICAgIHRoaXMuY29udGVudCA9IHRoaXMuZGVmYXVsdENvbmZpZy5jb250ZW50O1xuICAgICAgICB0aGlzLm9rVGV4dCA9IHRoaXMuZGVmYXVsdENvbmZpZy5va1RleHQ7XG4gICAgICAgIHRoaXMub2tUeXBlID0gdGhpcy5kZWZhdWx0Q29uZmlnLm9rVHlwZTtcbiAgICAgICAgdGhpcy5jYW5jZWxUZXh0ID0gdGhpcy5kZWZhdWx0Q29uZmlnLmNhbmNlbFRleHQ7XG4gICAgICAgIHRoaXMub2tMb2FkaW5nVGV4dCA9IHRoaXMuZGVmYXVsdENvbmZpZy5va0xvYWRpbmdUZXh0IHx8IHRoaXMub2tUZXh0O1xuICAgICAgICB0aGlzLmZvb3RlckFsaWduID0gdGhpcy5kZWZhdWx0Q29uZmlnLmZvb3RlckFsaWduO1xuICAgIH1cblxuICAgIGNvbmZpcm0oKSB7XG4gICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMub3B0aW9ucy5vbk9rKCk7XG4gICAgICAgIGlmIChyZXN1bHQgJiYgcmVzdWx0LnN1YnNjcmliZSkge1xuICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgICAgICAgICAgLnBpcGUoXG4gICAgICAgICAgICAgICAgICAgIGZpbmFsaXplKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgLnN1YnNjcmliZShzdWNjZXNzID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuZGlhbG9nUmVmLmNsb3NlKCk7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKSB7fVxufVxuIl19
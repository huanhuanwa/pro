import { Component, Input, HostBinding, ElementRef, TemplateRef, ContentChild, Renderer2 } from '@angular/core';
import { hexToRgb } from 'ngx-tethys/util';
import { UpdateHostClassService } from 'ngx-tethys/core';
export class ThyStatisticComponent {
    constructor(elementRef, updateHostClassService, renderer) {
        this.elementRef = elementRef;
        this.updateHostClassService = updateHostClassService;
        this.renderer = renderer;
        this._initialized = false;
        this.class = true;
        this.thyValueStyle = {};
        this.thyTitlePosition = 'bottom';
        this.updateHostClassService.initializeElement(elementRef.nativeElement);
    }
    set prefix(value) {
        this.prefixTemplate = value;
    }
    set thyPrefixTemplate(value) {
        this.prefixTemplate = value;
    }
    set value(value) {
        this.valueTemplate = value;
    }
    set thyValueTemplate(value) {
        this.valueTemplate = value;
    }
    set title(value) {
        this.titleTemplate = value;
    }
    set thyTitleTemplate(value) {
        this.titleTemplate = value;
    }
    set suffix(value) {
        this.suffixTemplate = value;
    }
    set thySuffixTemplate(value) {
        this.suffixTemplate = value;
    }
    set thyShape(value) {
        this._shape = value;
        if (this._initialized) {
            this._setClassesByType();
        }
    }
    set thySize(value) {
        this._size = value;
        if (this._initialized) {
            this._setClassesByType();
        }
    }
    ngOnInit() {
        this._setClassesByType();
        this._initialized = true;
    }
    setColor(color) {
        this.renderer.setStyle(this.elementRef.nativeElement, 'color', color);
        if (this._shape === 'card') {
            this.renderer.setStyle(this.elementRef.nativeElement, 'border-color', color);
            this.renderer.setStyle(this.elementRef.nativeElement, 'background-color', hexToRgb(color, 0.05));
        }
    }
    _setClassesByType() {
        const classNames = [];
        if (this.thyColor) {
            if (RegExp(/^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$/).test(this.thyColor)) {
                this.setColor(this.thyColor);
            }
            else {
                classNames.push(`thy-statistic-${this.thyColor}`);
            }
        }
        if (this._shape) {
            classNames.push(`thy-statistic-${this._shape}`);
        }
        if (!this._size) {
            this._size = 'default';
        }
        classNames.push(`thy-statistic-${this._size}`);
        this.renderer.setStyle(this.elementRef.nativeElement, 'font-size', this.thySize);
        this.updateHostClassService.updateClass(classNames);
    }
}
ThyStatisticComponent.decorators = [
    { type: Component, args: [{
                selector: 'thy-statistic',
                template: "<ng-container [ngTemplateOutlet]=\"title\" *ngIf=\"(thyTitle || titleTemplate) && thyTitlePosition === 'top'\"></ng-container>\n<div class=\"thy-statistic-content\" [ngStyle]=\"thyValueStyle\">\n  <span *ngIf=\"thyPrefix || prefixTemplate\" class=\"thy-statistic-content-prefix\">\n    <span *ngIf=\"thyPrefix\">{{ thyPrefix }}</span>\n    <ng-container *ngIf=\"prefixTemplate\" [ngTemplateOutlet]=\"prefixTemplate\"></ng-container>\n  </span>\n\n  <span class=\"thy-statistic-content-value\">\n    <span *ngIf=\"!valueTemplate\">{{ thyValue }}</span>\n    <ng-container *ngIf=\"valueTemplate\" [ngTemplateOutlet]=\"valueTemplate\"></ng-container>\n  </span>\n\n  <span *ngIf=\"thySuffix || suffixTemplate\" class=\"thy-statistic-content-suffix\">\n    <span *ngIf=\"thySuffix\">{{ thySuffix }}</span>\n    <ng-container *ngIf=\"suffixTemplate\" [ngTemplateOutlet]=\"suffixTemplate\"></ng-container>\n  </span>\n</div>\n<ng-container [ngTemplateOutlet]=\"title\" *ngIf=\"(thyTitle || titleTemplate) && thyTitlePosition === 'bottom'\"></ng-container>\n\n<ng-template #title>\n  <div class=\"thy-statistic-title\">\n    <span *ngIf=\"thyTitle\">{{ thyTitle }}</span>\n    <ng-container [ngTemplateOutlet]=\"titleTemplate\"></ng-container>\n  </div>\n</ng-template>\n",
                providers: [UpdateHostClassService]
            },] }
];
ThyStatisticComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: UpdateHostClassService },
    { type: Renderer2 }
];
ThyStatisticComponent.propDecorators = {
    class: [{ type: HostBinding, args: [`class.thy-statistic`,] }],
    thyValueStyle: [{ type: Input }],
    thyPrefix: [{ type: Input }],
    prefix: [{ type: ContentChild, args: ['prefix', { static: true },] }],
    thyPrefixTemplate: [{ type: Input }],
    thyValue: [{ type: Input }],
    value: [{ type: ContentChild, args: ['value', { static: true },] }],
    thyValueTemplate: [{ type: Input }],
    thyTitle: [{ type: Input }],
    title: [{ type: ContentChild, args: ['title', { static: true },] }],
    thyTitleTemplate: [{ type: Input }],
    thySuffix: [{ type: Input }],
    suffix: [{ type: ContentChild, args: ['suffix', { static: true },] }],
    thySuffixTemplate: [{ type: Input }],
    thyTitlePosition: [{ type: Input }],
    thyShape: [{ type: Input }],
    thyColor: [{ type: Input }],
    thySize: [{ type: Input }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhdGlzdGljLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zdGF0aXN0aWMvc3RhdGlzdGljLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQVUsU0FBUyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3hILE9BQU8sRUFBeUIsUUFBUSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDbEUsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFlekQsTUFBTSxPQUFPLHFCQUFxQjtJQStFOUIsWUFBb0IsVUFBc0IsRUFBVSxzQkFBOEMsRUFBVSxRQUFtQjtRQUEzRyxlQUFVLEdBQVYsVUFBVSxDQUFZO1FBQVUsMkJBQXNCLEdBQXRCLHNCQUFzQixDQUF3QjtRQUFVLGFBQVEsR0FBUixRQUFRLENBQVc7UUE1RS9ILGlCQUFZLEdBQUcsS0FBSyxDQUFDO1FBWWUsVUFBSyxHQUFHLElBQUksQ0FBQztRQUV4QyxrQkFBYSxHQUFHLEVBQUUsQ0FBQztRQTBDbkIscUJBQWdCLEdBQThCLFFBQVEsQ0FBQztRQXFCNUQsSUFBSSxDQUFDLHNCQUFzQixDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUM1RSxDQUFDO0lBNURELElBQThDLE1BQU0sQ0FBQyxLQUF3QjtRQUN6RSxJQUFJLENBQUMsY0FBYyxHQUFHLEtBQUssQ0FBQztJQUNoQyxDQUFDO0lBRUQsSUFBYSxpQkFBaUIsQ0FBQyxLQUF3QjtRQUNuRCxJQUFJLENBQUMsY0FBYyxHQUFHLEtBQUssQ0FBQztJQUNoQyxDQUFDO0lBSUQsSUFBNkMsS0FBSyxDQUFDLEtBQXdCO1FBQ3ZFLElBQUksQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDO0lBQy9CLENBQUM7SUFFRCxJQUFh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WUF4SEosU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSxlQUFlO2dCQUN6Qiw0dkNBQXlDO2dCQUN6QyxTQUFTLEVBQUUsQ0FBQyxzQkFBc0IsQ0FBQzthQUN0Qzs7O1lBaEIrQyxVQUFVO1lBRWpELHNCQUFzQjtZQUZ3RCxTQUFTOzs7b0JBZ0MzRixXQUFXLFNBQUMscUJBQXFCOzRCQUVqQyxLQUFLO3dCQUVMLEtBQUs7cUJBRUwsWUFBWSxTQUFDLFFBQVEsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7Z0NBSXZDLEtBQUs7dUJBSUwsS0FBSztvQkFFTCxZQUFZLFNBQUMsT0FBTyxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTsrQkFJdEMsS0FBSzt1QkFJTCxLQUFLO29CQUVMLFlBQVksU0FBQyxPQUFPLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFOytCQUl0QyxLQUFLO3dCQUlMLEtBQUs7cUJBRUwsWUFBWSxTQUFDLFFBQVEsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7Z0NBSXZDLEtBQUs7K0JBSUwsS0FBSzt1QkFFTCxLQUFLO3VCQVFMLEtBQUs7c0JBRUwsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9uSW5pdCwgQ29tcG9uZW50LCBJbnB1dCwgSG9zdEJpbmRpbmcsIEVsZW1lbnRSZWYsIFRlbXBsYXRlUmVmLCBDb250ZW50Q2hpbGQsIFJlbmRlcmVyMiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgY29lcmNlQm9vbGVhblByb3BlcnR5LCBoZXhUb1JnYiB9IGZyb20gJ25neC10ZXRoeXMvdXRpbCc7XG5pbXBvcnQgeyBVcGRhdGVIb3N0Q2xhc3NTZXJ2aWNlIH0gZnJvbSAnbmd4LXRldGh5cy9jb3JlJztcblxuZXhwb3J0IHR5cGUgVGh5U3RhdGlzdGljQ29sb3JUeXBlID0gJ3ByaW1hcnknIHwgJ3N1Y2Nlc3MnIHwgJ3dhcm5pbmcnIHwgJ2RhbmdlcicgfCAnaW5mbyc7XG5cbmV4cG9ydCB0eXBlIFRoeVN0YXRpc3RpY1NoYXBlID0gJ2NhcmQnO1xuXG5leHBvcnQgdHlwZSBUaHlTdGF0aXN0aWNTaXplcyA9ICdkZWZhdWx0JztcblxuZXhwb3J0IHR5cGUgVGh5U3RhdGlzdGljVGl0bGVQb3NpdGlvbiA9ICd0b3AnIHwgJ2JvdHRvbSc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAndGh5LXN0YXRpc3RpYycsXG4gICAgdGVtcGxhdGVVcmw6ICcuL3N0YXRpc3RpYy5jb21wb25lbnQuaHRtbCcsXG4gICAgcHJvdmlkZXJzOiBbVXBkYXRlSG9zdENsYXNzU2VydmljZV1cbn0pXG5leHBvcnQgY2xhc3MgVGh5U3RhdGlzdGljQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgICBfc2hhcGU6IFRoeVN0YXRpc3RpY1NoYXBlO1xuXG4gICAgX2luaXRpYWxpemVkID0gZmFsc2U7XG5cbiAgICBfc2l6ZTogVGh5U3RhdGlzdGljU2l6ZXM7XG5cbiAgICBwcmVmaXhUZW1wbGF0ZTogVGVtcGxhdGVSZWY8dm9pZD47XG5cbiAgICBzdWZmaXhUZW1wbGF0ZTogVGVtcGxhdGVSZWY8dm9pZD47XG5cbiAgICB2YWx1ZVRlbXBsYXRlOiBUZW1wbGF0ZVJlZjx2b2lkPjtcblxuICAgIHRpdGxlVGVtcGxhdGU6IFRlbXBsYXRlUmVmPHZvaWQ+O1xuXG4gICAgQEhvc3RCaW5kaW5nKGBjbGFzcy50aHktc3RhdGlzdGljYCkgY2xhc3MgPSB0cnVlO1xuXG4gICAgQElucHV0KCkgdGh5VmFsdWVTdHlsZSA9IHt9O1xuXG4gICAgQElucHV0KCkgdGh5UHJlZml4OiBzdHJpbmc7XG5cbiAgICBAQ29udGVudENoaWxkKCdwcmVmaXgnLCB7IHN0YXRpYzogdHJ1ZSB9KSBzZXQgcHJlZml4KHZhbHVlOiBUZW1wbGF0ZVJlZjx2b2lkPikge1xuICAgICAgICB0aGlzLnByZWZpeFRlbXBsYXRlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgQElucHV0KCkgc2V0IHRoeVByZWZpeFRlbXBsYXRlKHZhbHVlOiBUZW1wbGF0ZVJlZjx2b2lkPikge1xuICAgICAgICB0aGlzLnByZWZpeFRlbXBsYXRlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgQElucHV0KCkgdGh5VmFsdWU6IG51bWJlciB8IHN0cmluZztcblxuICAgIEBDb250ZW50Q2hpbGQoJ3ZhbHVlJywgeyBzdGF0aWM6IHRydWUgfSkgc2V0IHZhbHVlKHZhbHVlOiBUZW1wbGF0ZVJlZjx2b2lkPikge1xuICAgICAgICB0aGlzLnZhbHVlVGVtcGxhdGUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBASW5wdXQoKSBzZXQgdGh5VmFsdWVUZW1wbGF0ZSh2YWx1ZTogVGVtcGxhdGVSZWY8dm9pZD4pIHtcbiAgICAgICAgdGhpcy52YWx1ZVRlbXBsYXRlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgQElucHV0KCkgdGh5VGl0bGU6IHN0cmluZztcblxuICAgIEBDb250ZW50Q2hpbGQoJ3RpdGxlJywgeyBzdGF0aWM6IHRydWUgfSkgc2V0IHRpdGxlKHZhbHVlOiBUZW1wbGF0ZVJlZjx2b2lkPikge1xuICAgICAgICB0aGlzLnRpdGxlVGVtcGxhdGUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBASW5wdXQoKSBzZXQgdGh5VGl0bGVUZW1wbGF0ZSh2YWx1ZTogVGVtcGxhdGVSZWY8dm9pZD4pIHtcbiAgICAgICAgdGhpcy50aXRsZVRlbXBsYXRlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgQElucHV0KCkgdGh5U3VmZml4OiBzdHJpbmc7XG5cbiAgICBAQ29udGVudENoaWxkKCdzdWZmaXgnLCB7IHN0YXRpYzogdHJ1ZSB9KSBzZXQgc3VmZml4KHZhbHVlOiBUZW1wbGF0ZVJlZjx2b2lkPikge1xuICAgICAgICB0aGlzLnN1ZmZpeFRlbXBsYXRlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgQElucHV0KCkgc2V0IHRoeVN1ZmZpeFRlbXBsYXRlKHZhbHVlOiBUZW1wbGF0ZVJlZjx2b2lkPikge1xuICAgICAgICB0aGlzLnN1ZmZpeFRlbXBsYXRlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgQElucHV0KCkgdGh5VGl0bGVQb3NpdGlvbjogVGh5U3RhdGlzdGljVGl0bGVQb3NpdGlvbiA9ICdib3R0b20nO1xuXG4gICAgQElucHV0KClcbiAgICBzZXQgdGh5U2hhcGUodmFsdWU6IFRoeVN0YXRpc3RpY1NoYXBlKSB7XG4gICAgICAgIHRoaXMuX3NoYXBlID0gdmFsdWU7XG4gICAgICAgIGlmICh0aGlzLl9pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgdGhpcy5fc2V0Q2xhc3Nlc0J5VHlwZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgQElucHV0KCkgdGh5Q29sb3I6IHN0cmluZyB8IFRoeVN0YXRpc3RpY0NvbG9yVHlwZTtcblxuICAgIEBJbnB1dCgpXG4gICAgc2V0IHRoeVNpemUodmFsdWU6IFRoeVN0YXRpc3RpY1NpemVzKSB7XG4gICAgICAgIHRoaXMuX3NpemUgPSB2YWx1ZTtcbiAgICAgICAgaWYgKHRoaXMuX2luaXRpYWxpemVkKSB7XG4gICAgICAgICAgICB0aGlzLl9zZXRDbGFzc2VzQnlUeXBlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsIHByaXZhdGUgdXBkYXRlSG9zdENsYXNzU2VydmljZTogVXBkYXRlSG9zdENsYXNzU2VydmljZSwgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyKSB7XG4gICAgICAgIHRoaXMudXBkYXRlSG9zdENsYXNzU2VydmljZS5pbml0aWFsaXplRWxlbWVudChlbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQpO1xuICAgIH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLl9zZXRDbGFzc2VzQnlUeXBlKCk7XG4gICAgICAgIHRoaXMuX2luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBzZXRDb2xvcihjb2xvcjogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdjb2xvcicsIGNvbG9yKTtcbiAgICAgICAgaWYgKHRoaXMuX3NoYXBlID09PSAnY2FyZCcpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdib3JkZXItY29sb3InLCBjb2xvcik7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAnYmFja2dyb3VuZC1jb2xvcicsIGhleFRvUmdiKGNvbG9yLCAwLjA1KSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfc2V0Q2xhc3Nlc0J5VHlwZSgpIHtcbiAgICAgICAgY29uc3QgY2xhc3NOYW1lcyA9IFtdO1xuICAgICAgICBpZiAodGhpcy50aHlDb2xvcikge1xuICAgICAgICAgICAgaWYgKFJlZ0V4cCgvXiMoWzAtOWEtZkEtRl17Nn18WzAtOWEtZkEtRl17M30pJC8pLnRlc3QodGhpcy50aHlDb2xvcikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldENvbG9yKHRoaXMudGh5Q29sb3IpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWVzLnB1c2goYHRoeS1zdGF0aXN0aWMtJHt0aGlzLnRoeUNvbG9yfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9zaGFwZSkge1xuICAgICAgICAgICAgY2xhc3NOYW1lcy5wdXNoKGB0aHktc3RhdGlzdGljLSR7dGhpcy5fc2hhcGV9YCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9zaXplKSB7XG4gICAgICAgICAgICB0aGlzLl9zaXplID0gJ2RlZmF1bHQnO1xuICAgICAgICB9XG4gICAgICAgIGNsYXNzTmFtZXMucHVzaChgdGh5LXN0YXRpc3RpYy0ke3RoaXMuX3NpemV9YCk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudCwgJ2ZvbnQtc2l6ZScsIHRoaXMudGh5U2l6ZSk7XG4gICAgICAgIHRoaXMudXBkYXRlSG9zdENsYXNzU2VydmljZS51cGRhdGVDbGFzcyhjbGFzc05hbWVzKTtcbiAgICB9XG59XG4iXX0=
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("ngx-tethys/core"),require("@angular/common"),require("ngx-tethys/util"),require("rxjs"),require("@angular/cdk/platform"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("ngx-tethys/resizable",["exports","@angular/core","ngx-tethys/core","@angular/common","ngx-tethys/util","rxjs","@angular/cdk/platform","rxjs/operators"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self)["ngx-tethys"]=e["ngx-tethys"]||{},e["ngx-tethys"].resizable={}),e.ng.core,e["ngx-tethys"].core,e.ng.common,e["ngx-tethys"].util,e.rxjs,e.ng.cdk.platform,e.rxjs.operators)}(this,(function(e,t,n,i,o,s,r,h){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function a(e,t){function n(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function l(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var h=e.length-1;h>=0;h--)(o=e[h])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}Object.create;Object.create;var y=function(){function e(e,t){this.ngZone=e,this.listeners=new Map,this.handleMouseDown$=new s.Subject,this.documentMouseUp$=new s.Subject,this.documentMouseMove$=new s.Subject,this.mouseEntered$=new s.Subject,this.document=t}return e.prototype.startResizing=function(e){var t=this,n=o.isTouchEvent(e);this.clearListeners();var i=n?"touchmove":"mousemove",s=n?"touchend":"mouseup";this.listeners.set(i,(function(e){t.documentMouseMove$.next(e)})),this.listeners.set(s,(function(e){t.documentMouseUp$.next(e),t.clearListeners()})),this.ngZone.runOutsideAngular((function(){t.listeners.forEach((function(e,n){t.document.addEventListener(n,e)}))}))},e.prototype.clearListeners=function(){var e=this;this.listeners.forEach((function(t,n){e.document.removeEventListener(n,t)})),this.listeners.clear()},e.prototype.ngOnDestroy=function(){this.handleMouseDown$.complete(),this.documentMouseUp$.complete(),this.documentMouseMove$.complete(),this.mouseEntered$.complete(),this.clearListeners()},e}();function p(e){return o.isTouchEvent(e)?e.touches[0]||e.changedTouches[0]:e}function d(e,t){return e&&e<t?e:t}y.decorators=[{type:t.Injectable}],y.ctorParameters=function(){return[{type:t.NgZone},{type:void 0,decorators:[{type:t.Inject,args:[i.DOCUMENT]}]}]};var m=function(e){function n(n,i,o,s,r){var c=e.call(this)||this;return c.elementRef=n,c.renderer=i,c.platform=o,c.ngZone=s,c.thyResizableService=r,c.thyBounds="parent",c.thyMinHeight=40,c.thyMinWidth=40,c.thyGridColumnCount=-1,c.thyMaxColumn=-1,c.thyMinColumn=-1,c.thyLockAspectRatio=!1,c.thyPreview=!1,c.thyDisabled=!1,c.thyResize=new t.EventEmitter,c.thyResizeEnd=new t.EventEmitter,c.thyResizeStart=new t.EventEmitter,c.resizing=!1,c.sizeCache=null,c.ghostElement=null,c.currentHandleEvent=null,c.thyResizableService.handleMouseDown$.pipe(h.takeUntil(c.ngUnsubscribe$)).subscribe((function(e){c.thyDisabled||(c.resizing=!0,c.thyResizableService.startResizing(e.mouseEvent),c.currentHandleEvent=e,c.setCursor(),c.thyResizeStart.emit({mouseEvent:e.mouseEvent}),c.nativeElementRect=c.nativeElement.getBoundingClientRect())})),c.thyResizableService.documentMouseUp$.pipe(h.takeUntil(c.ngUnsubscribe$)).subscribe((function(e){c.resizing&&(c.resizing=!1,c.thyResizableService.documentMouseUp$.next(),c.endResize(e))})),c.thyResizableService.documentMouseMove$.pipe(h.takeUntil(c.ngUnsubscribe$)).subscribe((function(e){c.resizing&&c.resize(e)})),c}return a(n,e),n.prototype.ngAfterViewInit=function(){this.platform.isBrowser&&(this.nativeElement=this.elementRef.nativeElement,this.setPosition())},n.prototype.setCursor=function(){switch(this.currentHandleEvent.direction){case"left":case"right":this.renderer.setStyle(document.body,"cursor","ew-resize");break;case"top":case"bottom":this.renderer.setStyle(document.body,"cursor","ns-resize");break;case"topLeft":case"bottomRight":this.renderer.setStyle(document.body,"cursor","nwse-resize");break;case"topRight":case"bottomLeft":this.renderer.setStyle(document.body,"cursor","nesw-resize")}this.renderer.setStyle(document.body,"user-select","none")},n.prototype.setPosition=function(){var e=getComputedStyle(this.nativeElement).position;"static"!==e&&e||this.renderer.setStyle(this.nativeElement,"position","relative")},n.prototype.onMouseenter=function(){this.thyResizableService.mouseEntered$.next(!0)},n.prototype.onMouseleave=function(){this.thyResizableService.mouseEntered$.next(!1)},n.prototype.endResize=function(e){var t=this;this.renderer.setStyle(document.body,"cursor",""),this.renderer.setStyle(document.body,"user-select",""),this.removeGhostElement();var n=this.sizeCache?Object.assign({},this.sizeCache):{width:this.nativeElementRect.width,height:this.nativeElementRect.height};this.ngZone.run((function(){t.thyResizeEnd.emit(Object.assign(Object.assign({},n),{mouseEvent:e}))})),this.sizeCache=null,this.currentHandleEvent=null},n.prototype.resize=function(e){var t=this,n=this.nativeElementRect,i=p(e),o=p(this.currentHandleEvent.mouseEvent),s=n.width,r=n.height,h=this.thyLockAspectRatio?s/r:-1;switch(this.currentHandleEvent.direction){case"bottomRight":s=i.clientX-n.left,r=i.clientY-n.top;break;case"bottomLeft":s=n.width+(o.clientX-i.clientX),r=i.clientY-n.top;break;case"topRight":s=i.clientX-n.left,r=n.height+(o.clientY-i.clientY);break;case"topLeft":s=n.width+(o.clientX-i.clientX),r=n.height+(o.clientY-i.clientY);break;case"top":r=n.height+(o.clientY-i.clientY);break;case"right":s=i.clientX-n.left;break;case"bottom":r=i.clientY-n.top;break;case"left":s=n.width+(o.clientX-i.clientX)}var c=this.calcSize(s,r,h);this.sizeCache=Object.assign({},c),this.thyPreview&&this.previewResize(c),this.ngZone.run((function(){t.thyResize.emit(Object.assign(Object.assign({},c),{mouseEvent:e}))}))},n.prototype.calcSize=function(e,t,n){var i,o,s,r,h=0,c=0,a=this.thyMinWidth,l=1/0,u=1/0;if("parent"===this.thyBounds){var y=this.renderer.parentNode(this.nativeElement);if(y instanceof HTMLElement){var p=y.getBoundingClientRect();l=p.width,u=p.height}}else if("window"===this.thyBounds)"undefined"!=typeof window&&(l=window.innerWidth,u=window.innerHeight);else if(this.thyBounds&&this.thyBounds.nativeElement&&this.thyBounds.nativeElement instanceof HTMLElement){var m=this.thyBounds.nativeElement.getBoundingClientRect();l=m.width,u=m.height}return s=d(this.thyMaxWidth,l),r=d(this.thyMaxHeight,u),-1!==this.thyGridColumnCount&&(c=s/this.thyGridColumnCount,a=-1!==this.thyMinColumn?c*this.thyMinColumn:a,s=-1!==this.thyMaxColumn?c*this.thyMaxColumn:s),-1!==n?/(left|right)/i.test(this.currentHandleEvent.direction)?(i=Math.min(Math.max(e,a),s),((o=Math.min(Math.max(i/n,this.thyMinHeight),r))>=r||o<=this.thyMinHeight)&&(i=Math.min(Math.max(o*n,a),s))):(o=Math.min(Math.max(t,this.thyMinHeight),r),((i=Math.min(Math.max(o*n,a),s))>=s||i<=a)&&(o=Math.min(Math.max(i/n,this.thyMinHeight),r))):(i=Math.min(Math.max(e,a),s),o=Math.min(Math.max(t,this.thyMinHeight),r)),-1!==this.thyGridColumnCount&&(i=(h=Math.round(i/c))*c),{col:h,width:i,height:o}},n.prototype.previewResize=function(e){var t=e.width,n=e.height;this.createGhostElement(),this.renderer.setStyle(this.ghostElement,"width",t+"px"),this.renderer.setStyle(this.ghostElement,"height",n+"px")},n.prototype.createGhostElement=function(){this.ghostElement||(this.ghostElement=this.renderer.createElement("div"),this.renderer.setAttribute(this.ghostElement,"class","thy-resizable-preview")),this.renderer.appendChild(this.nativeElement,this.ghostElement)},n.prototype.removeGhostElement=function(){this.ghostElement&&this.renderer.removeChild(this.nativeElement,this.ghostElement)},n.prototype.ngOnDestroy=function(){this.ghostElement=null,this.sizeCache=null,e.prototype.ngOnDestroy.call(this)},n}(n.mixinUnsubscribe(n.MixinBase));m.decorators=[{type:t.Directive,args:[{selector:"[thyResizable]",providers:[y],host:{class:"thy-resizable","[class.thy-resizable-resizing]":"resizing","[class.thy-resizable-disabled]":"thyDisabled","(mouseenter)":"onMouseenter()","(mouseleave)":"onMouseleave()"}}]}],m.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2},{type:r.Platform},{type:t.NgZone},{type:y}]},m.propDecorators={thyBounds:[{type:t.Input}],thyMaxHeight:[{type:t.Input}],thyMaxWidth:[{type:t.Input}],thyMinHeight:[{type:t.Input}],thyMinWidth:[{type:t.Input}],thyGridColumnCount:[{type:t.Input}],thyMaxColumn:[{type:t.Input}],thyMinColumn:[{type:t.Input}],thyLockAspectRatio:[{type:t.Input}],thyPreview:[{type:t.Input}],thyDisabled:[{type:t.Input}],thyResize:[{type:t.Output}],thyResizeEnd:[{type:t.Output}],thyResizeStart:[{type:t.Output}]},l([n.InputBoolean(),u("design:type",Boolean)],m.prototype,"thyLockAspectRatio",void 0),l([n.InputBoolean(),u("design:type",Boolean)],m.prototype,"thyPreview",void 0),l([n.InputBoolean(),u("design:type",Boolean)],m.prototype,"thyDisabled",void 0);var g=function(e,t){this.direction=e,this.mouseEvent=t},f=function(e){function n(n,i,o){var s=e.call(this)||this;return s.thyResizableService=n,s.cdr=i,s.elementRef=o,s.thyDirection="bottomRight",s.thyMouseDown=new t.EventEmitter,s.entered=!1,s.elementRef.nativeElement.classList.add("thy-resizable-handle"),s}return a(n,e),n.prototype.ngOnInit=function(){var e=this;this.thyResizableService.mouseEntered$.pipe(h.takeUntil(this.ngUnsubscribe$)).subscribe((function(t){e.entered=t,e.cdr.markForCheck()}))},n.prototype.onMousedown=function(e){this.thyResizableService.handleMouseDown$.next(new g(this.thyDirection,e))},n.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this)},n}(n.mixinUnsubscribe(n.MixinBase));f.decorators=[{type:t.Component,args:[{selector:"thy-resize-handle, [thy-resize-handle]",exportAs:"thyResizeHandle",template:"\n        <ng-content></ng-content>\n    ",changeDetection:t.ChangeDetectionStrategy.OnPush,host:{"[class.thy-resizable-handle-top]":"thyDirection === 'top'","[class.thy-resizable-handle-right]":"thyDirection === 'right'","[class.thy-resizable-handle-bottom]":"thyDirection === 'bottom'","[class.thy-resizable-handle-left]":"thyDirection === 'left'","[class.thy-resizable-handle-topRight]":"thyDirection === 'topRight'","[class.thy-resizable-handle-bottomRight]":"thyDirection === 'bottomRight'","[class.thy-resizable-handle-bottomLeft]":"thyDirection === 'bottomLeft'","[class.thy-resizable-handle-topLeft]":"thyDirection === 'topLeft'","[class.thy-resizable-handle-box-hover]":"entered","(mousedown)":"onMousedown($event)","(touchstart)":"onMousedown($event)"}}]}],f.ctorParameters=function(){return[{type:y},{type:t.ChangeDetectorRef},{type:t.ElementRef}]},f.propDecorators={thyDirection:[{type:t.Input}],thyMouseDown:[{type:t.Output}]};var b=["bottomRight","topRight","bottomLeft","topLeft","bottom","right","top","left"],v=function(){function e(){this.thyDirections=b,this.directions=new Set(this.thyDirections)}return e.prototype.ngOnChanges=function(e){e.thyDirections&&(this.directions=new Set(e.thyDirections.currentValue))},e}();v.decorators=[{type:t.Component,args:[{selector:"thy-resize-handles",exportAs:"thyResizeHandles",template:'\n        <thy-resize-handle *ngFor="let dir of directions" [thyDirection]="dir"></thy-resize-handle>\n    ',changeDetection:t.ChangeDetectionStrategy.OnPush}]}],v.ctorParameters=function(){return[]},v.propDecorators={thyDirections:[{type:t.Input}]};var E=function(){};E.decorators=[{type:t.NgModule,args:[{imports:[i.CommonModule],declarations:[m,f,v],exports:[m,f,v]}]}],e.DEFAULT_RESIZE_DIRECTION=b,e.ThyResizableDirective=m,e.ThyResizableModule=E,e.ThyResizableService=y,e.ThyResizeHandleComponent=f,e.ThyResizeHandleMouseDownEvent=g,e.ThyResizeHandlesComponent=v,e.ensureInBounds=d,e.getEventWithPoint=p,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-tethys-resizable.umd.min.js.map
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/platform-browser"),require("ngx-tethys/types"),require("ngx-tethys/util")):"function"==typeof define&&define.amd?define("ngx-tethys/markdown",["exports","@angular/core","@angular/platform-browser","ngx-tethys/types","ngx-tethys/util"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self)["ngx-tethys"]=e["ngx-tethys"]||{},e["ngx-tethys"].markdown={}),e.ng.core,e.ng.platformBrowser,e["ngx-tethys"].types,e["ngx-tethys"].util)}(this,(function(e,t,r,i,a){"use strict";var n=function(){function e(e){this.sanitizer=e}return e.prototype.getEmojisRender=function(){return null},e.prototype.setHighLightWords=function(){return[]},e.prototype.filterHTML=function(e){return e},e.prototype.sanitizeHTML=function(e){return this.sanitizer.sanitize(t.SecurityContext.HTML,e)},e}();n.decorators=[{type:t.Injectable}],n.ctorParameters=function(){return[{type:r.DomSanitizer}]};var s=function(){function e(e,t){this.elementRef=e,this.thyMarkdownParserService=t,this.bypassSecurityTrustHtml=!1,this.liteMarkedOptions={gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!0,heading:!0,link:!0,list:!0,wtlink:!0,wthexcolor:!0,wthexcolorRender:{className:"msg-inline-color"},wtat:!1,wthash:!1,wtentity:!0,wtentityRender:{className:"slide-trigger"},wthashRender:{chlPrefix:"/messages/groups/"},wtexclamation:!0,wtemoji:!1,isParagraphDefault:!0,isImageDefault:!0,isBlockquoteDefault:!0,isHrDefault:!0,isStrongDefault:!0,isEmDefault:!0,isCodespanDefault:!0,isCodeDefault:!0,isDelDefault:!0,isHtmlDefault:!0,isTextEscape:!0,isDef:!0,isImgPreview:!0}}return Object.defineProperty(e.prototype,"thyMarkdownParser",{set:function(e){e&&(this.value=e,this.translateHTML())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"thyBypassSecurityTrustHtml",{set:function(e){this.bypassSecurityTrustHtml=a.coerceBooleanProperty(e)},enumerable:!1,configurable:!0}),e.prototype.initGantt=function(){i.mermaid&&(i.mermaid.parseError=function(e,t){i.mermaid.error=e},i.mermaid.ganttConfig={numberSectionStyles:4,axisFormatter:[["%I:%M",function(e){return e.getHours()}],["w. %U",function(e){return 1===e.getDay()}],["%a %d",function(e){return e.getDay()&&1!==e.getDate()}],["%b %d",function(e){return 1!==e.getDate()}],["%m-%y",function(e){return e.getMonth()}]]})},e.prototype.initMarked=function(){var e=new i.liteMarked.Renderer;e.listitem=function(e){if(!/^\[[ x]\]\s/.test(e))return i.liteMarked.Renderer.prototype.listitem(e);var t=i.$('<input type="checkbox" disabled/>');return/^\[x\]\s/.test(e)&&t.attr("checked",!0),i.$(i.liteMarked.Renderer.prototype.listitem(e.substring(3))).addClass("task-list-item").prepend(t)[0].outerHTML},e.codespan=function(e){if(/^\$.+\$$/.test(e)){var t=/^\$(.+)\$$/.exec(e)[1],r=t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'");try{return i.katex.renderToString(r,{displayMode:!1})}catch(e){return"<code>"+e+"</code>"}}return i.liteMarked.Renderer.prototype.codespan.apply(this,arguments)},e.code=function(e,t,r,a){var n=(e=e.trim()).split(/\n/)[0].trim();if("math"===t){var s="";return e.split(/\n\n/).forEach((function(e){if((e=e.trim()).length>0)try{s+=i.katex.renderToString(e,{displayMode:!0})}catch(e){s+="<pre>"+e+"</pre>"}})),'<div data-line="'+a+'">'+s+"</div>"}return"gantt"===n||"sequenceDiagram"===n||n.match(/^graph (?:TB|BT|RL|LR|TD);?$/)?("sequenceDiagram"===n&&(e+="\n"),i.mermaid&&i.mermaid.parse(e)?'<div class="mermaid" data-line="'+a+'">'+e+"</div>":i.mermaid&&i.mermaid.error?'<pre data-line="'+a+'">'+i.mermaid.error+"</pre>":void 0):i.liteMarked.Renderer.prototype.code.apply(this,arguments)},e.html=function(e){var t=i.liteMarked.Renderer.prototype.html.apply(this,arguments),r=i.$(t.bold());return r.html()},e.paragraph=function(e){var t=i.liteMarked.Renderer.prototype.paragraph.apply(this,arguments),r=i.$(t.bold());return r.html()},i.liteMarked.setOptions(this.liteMarkedOptions)},e.prototype.initComponent=function(){this.initGantt(),this.initMarked()},e.prototype.parseMarked=function(e){return i.liteMarked&&e?i.liteMarked(e):e},e.prototype.parseMermaid=function(){i.mermaid&&i.mermaid.init()},e.prototype.translateHTML=function(){var e=this;this.initComponent();var t=this.thyMarkdownParserService.filterHTML(this.value);t=this.parseMarked(t),this.bypassSecurityTrustHtml||(t=this.thyMarkdownParserService.sanitizeHTML(t)),setTimeout((function(){e.parseMermaid()}),100),this.elementRef.nativeElement.innerHTML=t,i.$(this.elementRef.nativeElement).find("a").attr("target",(function(){if(this.host!==location.host)return"_blank";var e=["shared/","share/","club","videos","blog","plan","tour","mobile","security","uservoice","customers","press","help","guide","feedback","about","contact","privacy","terms"].join(")|(/");return(e=new RegExp("^(/"+e+")")).test(this.pathname)?"_blank":void 0}))},e.prototype.ngOnInit=function(){var e=this.thyMarkdownParserService.getEmojisRender();e&&(this.liteMarkedOptions.wtemoji=!0,this.liteMarkedOptions.wtemojiRender=e),this.translateHTML()},e}();s.decorators=[{type:t.Directive,args:[{selector:"[thyMarkdownParser]"}]}],s.ctorParameters=function(){return[{type:t.ElementRef},{type:n}]},s.propDecorators={thyMarkdownParser:[{type:t.Input}],thyBypassSecurityTrustHtml:[{type:t.Input}]};var o=function(){function e(e,t){this.elementRef=e,this.thyMarkdownParserService=t,this.value="",this.prefix="",this.liteMarkedOptions={gfm:!0,tables:!1,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!1,smartypants:!1,heading:!1,link:!1,list:!1,wtlink:!0,wthexcolor:!0,wthexcolorRender:{className:"msg-inline-color"},wtat:!0,wtatRender:{memberPrefix:this.prefix,className:"slide-trigger"},wthash:!0,wtentity:!0,wtentityRender:{className:"slide-trigger"},wthashRender:{chlPrefix:"/messages/groups/"},wtexclamation:!0,wtemoji:!1,isParagraphDefault:!1,isImageDefault:!1,isBlockquoteDefault:!1,isHrDefault:!1,isStrongDefault:!1,isEmDefault:!1,isCodespanDefault:!1,isCodeDefault:!1,isDelDefault:!1,isHtmlDefault:!1,isTextEscape:!0},this.hasClass=!0}return Object.defineProperty(e.prototype,"thyMarkdownPlanText",{set:function(e){e&&(this.value=e,this.translateHTML())},enumerable:!1,configurable:!0}),e.prototype.translateHTML=function(){i.liteMarked.setOptions(this.liteMarkedOptions);var e=i.liteMarked.toHTML(this.value,this.liteMarkedOptions.highLightWords);e=this.thyMarkdownParserService.sanitizeHTML(e),this.elementRef.nativeElement.innerHTML=e},e.prototype.ngOnInit=function(){var e=this.thyMarkdownParserService.getEmojisRender();e&&(this.liteMarkedOptions.wtemoji=!0,this.liteMarkedOptions.wtemojiRender=e);var t=this.thyMarkdownParserService.setHighLightWords();t&&t instanceof Array&&(this.liteMarkedOptions.highLightWords=t),this.translateHTML()},e}();o.decorators=[{type:t.Directive,args:[{selector:"[thyMarkdownPlanText]"}]}],o.ctorParameters=function(){return[{type:t.ElementRef},{type:n}]},o.propDecorators={thyMarkdownPlanText:[{type:t.Input}],hasClass:[{type:t.HostBinding,args:["class.thy-markdown-plan-text"]}]};var l=function(){};l.decorators=[{type:t.NgModule,args:[{declarations:[s,o],exports:[s,o],providers:[n]}]}],e.ThyMarkdownModule=l,e.ThyMarkdownParserDirective=s,e.ThyMarkdownParserService=n,e.ThyMarkdownPlanTextParserDirective=o,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-tethys-markdown.umd.min.js.map
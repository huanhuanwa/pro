!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/forms"),require("@angular/common"),require("ngx-tethys/core"),require("@angular/platform-browser"),require("rxjs"),require("@angular/common/http"),require("rxjs/operators"),require("ngx-tethys/util")):"function"==typeof define&&define.amd?define("ngx-tethys/icon",["exports","@angular/core","@angular/forms","@angular/common","ngx-tethys/core","@angular/platform-browser","rxjs","@angular/common/http","rxjs/operators","ngx-tethys/util"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self)["ngx-tethys"]=t["ngx-tethys"]||{},t["ngx-tethys"].icon={}),t.ng.core,t.ng.forms,t.ng.common,t["ngx-tethys"].core,t.ng.platformBrowser,t.rxjs,t.ng.common.http,t.rxjs.operators,t["ngx-tethys"].util)}(this,(function(t,e,n,o,r,i,s,a,c,l){"use strict";function u(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var o=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,o.get?o:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var g=u(e),p=u(o),h=u(i),f=u(a);Object.create;function d(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return s}Object.create;var y=function(t){t.nodeName?this.svgElement=t:this.url=t},v=function(){function t(t,e,n){this.sanitizer=t,this.httpClient=e,this.document=n,this.defaultFontSetClass="wt-icon",this.internalIconMode="svg",this.svgIconConfigs=new Map,this.svgIconSetConfigs=new Map,this.inProgressUrlFetches=new Map}return Object.defineProperty(t.prototype,"iconMode",{get:function(){return this.internalIconMode},enumerable:!1,configurable:!0}),t.prototype.getIconNameNotFoundError=function(t){return Error('Unable to find icon with the name "'+t+'"')},t.prototype.getIconFailedToSanitizeLiteralError=function(t){return Error("The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was \""+t+'".')},t.prototype.internalAddSvgIconSet=function(t,e){var n=this.svgIconSetConfigs.get(t);return n?n.push(e):this.svgIconSetConfigs.set(t,[e]),this},t.prototype.cloneSvg=function(t){return t.cloneNode(!0)},t.prototype.fetchUrl=function(t){var n=this;if(null==t)throw Error('Cannot fetch icon from URL "'+t+'".');var o=this.sanitizer.sanitize(e.SecurityContext.RESOURCE_URL,t);if(!o)throw new Error("The URL provided to ThyIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was \""+o+'".');var r=this.inProgressUrlFetches.get(o);if(r)return r;var i=this.httpClient.get(o,{responseType:"text"}).pipe(c.finalize((function(){return n.inProgressUrlFetches.delete(o)})),c.share());return this.inProgressUrlFetches.set(o,i),i},t.prototype.toSvgElement=function(t){for(var e=this.svgElementFromString("<svg></svg>"),n=0;n<t.childNodes.length;n++)t.childNodes[n].nodeType===this.document.ELEMENT_NODE&&e.appendChild(t.childNodes[n].cloneNode(!0));return e},t.prototype.extractSvgIconFromIconSet=function(t,e){var n=t.querySelector('[id="'+e+'"]');if(!n)return null;var o=n.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this.setSvgAttributes(o);if("symbol"===o.nodeName.toLowerCase())return this.setSvgAttributes(this.toSvgElement(o));var r=this.svgElementFromString("<svg></svg>");return r.appendChild(o),this.setSvgAttributes(r)},t.prototype.extractIconWithNameFromIconSetConfigs=function(t,e){for(var n=e.length-1;n>=0;n--){var o=e[n];if(o.svgElement){var r=this.extractSvgIconFromIconSet(o.svgElement,t);if(r)return r}}return null},t.prototype.svgElementFromString=function(t){var e=this.document.createElement("DIV");e.innerHTML=t;var n=e.querySelector("svg");if(!n)throw Error("<svg> tag not found");return n},t.prototype.setSvgAttributes=function(t){return t.setAttribute("fit",""),t.setAttribute("height","1em"),t.setAttribute("width","1em"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),t},t.prototype.createSvgElementForSingleIcon=function(t){var e=this.svgElementFromString(t);return this.setSvgAttributes(e),e},t.prototype.loadSvgIconFromConfig=function(t){var e=this;return this.fetchUrl(t.url).pipe(c.map((function(t){return e.createSvgElementForSingleIcon(t)})))},t.prototype.loadSvgIconSetFromConfig=function(t){var e=this;return t.svgElement?s.of(t.svgElement):this.fetchUrl(t.url).pipe(c.map((function(n){return t.svgElement||(t.svgElement=e.svgElementFromString(n)),t.svgElement})))},t.prototype.getSvgFromConfig=function(t){var e=this;return t.svgElement?s.of(this.cloneSvg(t.svgElement)):this.loadSvgIconFromConfig(t).pipe(c.tap((function(e){return t.svgElement=e})),c.map((function(t){return e.cloneSvg(t)})))},t.prototype.getSvgFromIconSetConfigs=function(t,n){var o=this,r=this.extractIconWithNameFromIconSetConfigs(t,n);if(r)return s.of(r);var i=n.filter((function(t){return!t.svgElement})).map((function(t){return o.loadSvgIconSetFromConfig(t).pipe(c.catchError((function(n){var r=o.sanitizer.sanitize(e.SecurityContext.RESOURCE_URL,t.url);return console.error("Loading icon set URL: "+r+" failed: "+n.message),s.of(null)})))}));return s.forkJoin(i).pipe(c.map((function(){var e=o.extractIconWithNameFromIconSetConfigs(t,n);if(!e)throw o.getIconNameNotFoundError(t);return e})))},t.prototype.internalAddSvgIconConfig=function(t,e,n){return this.svgIconConfigs.set(this.buildIconKey(t,e),n),this},t.prototype.buildIconKey=function(t,e){return t+":"+e},t.prototype.splitIconName=function(t){if(!t)return["",""];var e=t.split(":");switch(e.length){case 1:return["",e[0]];case 2:return e;default:throw Error('Invalid icon name: "'+t+'"')}},t.prototype.addSvgIconSetInNamespace=function(t,e){return this.internalAddSvgIconSet(t,new y(e))},t.prototype.addSvgIconSet=function(t){return this.addSvgIconSetInNamespace("",t)},t.prototype.addSvgIconSetLiteralInNamespace=function(t,n){var o=this.sanitizer.sanitize(e.SecurityContext.HTML,n);if(!o)throw this.getIconFailedToSanitizeLiteralError(n);var r=this.svgElementFromString(o);return this.internalAddSvgIconSet(t,new y(r))},t.prototype.addSvgIconSetLiteral=function(t){return this.addSvgIconSetLiteralInNamespace("",t)},t.prototype.addSvgIconInNamespace=function(t,e,n){return this.internalAddSvgIconConfig(t,e,new y(n))},t.prototype.addSvgIcon=function(t,e){return this.addSvgIconInNamespace("",t,e)},t.prototype.addSvgIconLiteral=function(t,e){return this.addSvgIconLiteralInNamespace("",t,e)},t.prototype.addSvgIconLiteralInNamespace=function(t,n,o){var r=this.sanitizer.sanitize(e.SecurityContext.HTML,o);if(!r)throw this.getIconFailedToSanitizeLiteralError(o);var i=this.createSvgElementForSingleIcon(r);return this.internalAddSvgIconConfig(t,n,new y(i))},t.prototype.getDefaultFontSetClass=function(){return this.defaultFontSetClass},t.prototype.getFontSetClassByAlias=function(t){return t},t.prototype.getSvgIcon=function(t,e){void 0===e&&(e="");var n=this.buildIconKey(e,t),o=this.svgIconConfigs.get(n);if(o)return this.getSvgFromConfig(o);var r=this.svgIconSetConfigs.get(e);return r?this.getSvgFromIconSetConfigs(t,r):s.throwError(this.getIconNameNotFoundError(n))},t.prototype.setIconMode=function(t){this.internalIconMode=t},t}();v.ɵprov=g.ɵɵdefineInjectable({factory:function(){return new v(g.ɵɵinject(h.DomSanitizer),g.ɵɵinject(f.HttpClient),g.ɵɵinject(p.DOCUMENT))},token:v,providedIn:"root"}),v.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],v.ctorParameters=function(){return[{type:i.DomSanitizer},{type:a.HttpClient},{type:void 0,decorators:[{type:e.Inject,args:[o.DOCUMENT]}]}]};var m=!0;function S(){return m}var I={fill:"fill",twotone:"tt"},C=function(){function t(t,e,n,o){this.updateHostClassService=t,this.render=e,this.elementRef=n,this.iconRegistry=o,this.className=!0,this.isInitialized=!1,this.iconType="outline",t.initializeElement(n.nativeElement)}return t.prototype.ngOnInit=function(){this.updateClasses(),this.isInitialized=!0},t.prototype.ngOnChanges=function(t){this.isInitialized&&(t.iconName||t.iconSet||t.iconTwotoneColor||t.iconType?this.updateClasses():t.iconRotate&&this.setStyleRotate()),t.iconLegging&&(l.coerceBooleanProperty(this.iconLegging)?this.updateHostClassService.addClass("thy-icon-legging"):this.updateHostClassService.removeClass("thy-icon-legging"))},t.prototype.updateClasses=function(){var t=this,e=d(this.iconRegistry.splitIconName(this.iconName),2),n=e[0],o=e[1];if(o)if("svg"===this.iconRegistry.iconMode)this.iconRegistry.getSvgIcon(this.buildIconNameByType(o),n).pipe(c.take(1)).subscribe((function(e){return t.setSvgElement(e)}),(function(t){S()&&console.error("Error retrieving icon: "+t.message)})),this.updateHostClassService.updateClass(["thy-icon"+(n?"-"+n:"")+"-"+this.buildIconNameByType(o)]);else{var r=this.iconSet?this.iconRegistry.getFontSetClassByAlias(this.iconSet):this.iconRegistry.getDefaultFontSetClass();this.updateHostClassService.updateClass([r,r+"-"+this.iconName])}},t.prototype.setStyleRotate=function(){void 0!==this.iconRotate&&this.render.setStyle(this.elementRef.nativeElement.querySelector("svg"),"transform","rotate("+this.iconRotate+"deg)")},t.prototype.setSvgElement=function(t){var e=this;this.clearSvgElement();for(var n=t.querySelectorAll("style"),o=0;o<n.length;o++)n[o].textContent+=" ";if("twotone"===this.iconType){var r=t.querySelectorAll("path");r.length>1&&r.forEach((function(t,n){t.getAttribute("id").includes("secondary-color")&&t.setAttribute("fill",e.iconTwotoneColor)}))}this.iconLinearGradient&&(this.setBaseUrl(t),this.clearTitleElement(t)),this.elementRef.nativeElement.appendChild(t),this.setStyleRotate()},t.prototype.clearSvgElement=function(){for(var t=this.elementRef.nativeElement,e=t.childNodes.length;e--;){var n=t.childNodes[e];1===n.nodeType&&"svg"!==n.nodeName.toLowerCase()||t.removeChild(n)}},t.prototype.buildIconNameByType=function(t){if(this.iconType&&["fill","twotone"].indexOf(this.iconType)>=0){var e=I[this.iconType];return t.includes("-"+e)?t:t+"-"+e}return t},t.prototype.setBaseUrl=function(t){t.querySelectorAll("[style]").forEach((function(t){t.style.cssText.includes("url")&&(t.style.fill=t.style.fill.replace('url("','url("'+location.pathname)),t.style.cssText.includes("clip-path")&&(t.style.clipPath=t.style.clipPath.replace('url("','url("'+location.pathname))}))},t.prototype.clearTitleElement=function(t){t.querySelector("title").remove()},t}();C.decorators=[{type:e.Component,args:[{selector:"thy-icon",template:"<ng-content></ng-content>",changeDetection:e.ChangeDetectionStrategy.OnPush,encapsulation:e.ViewEncapsulation.None,providers:[r.UpdateHostClassService]}]}],C.ctorParameters=function(){return[{type:r.UpdateHostClassService},{type:e.Renderer2},{type:e.ElementRef},{type:v}]},C.propDecorators={className:[{type:e.HostBinding,args:["class.thy-icon"]}],iconType:[{type:e.Input,args:["thyIconType"]}],iconTwotoneColor:[{type:e.Input,args:["thyTwotoneColor"]}],iconName:[{type:e.Input,args:["thyIconName"]}],iconRotate:[{type:e.Input,args:["thyIconRotate"]}],iconSet:[{type:e.Input,args:["thyIconSet"]}],iconLegging:[{type:e.Input,args:["thyIconLegging"]}],iconLinearGradient:[{type:e.Input,args:["thyIconLinearGradient"]}]};var E=function(){};E.decorators=[{type:e.NgModule,args:[{declarations:[C],imports:[o.CommonModule,n.FormsModule,a.HttpClientModule],exports:[C]}]}],t.ThyIconComponent=C,t.ThyIconModule=E,t.ThyIconRegistry=v,t.getWhetherPrintErrorWhenIconNotFound=S,t.setPrintErrorWhenIconNotFound=function(t){m=t},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-tethys-icon.umd.min.js.map
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@angular/animations"),require("ngx-tethys/core"),require("ngx-tethys/store"),require("ngx-tethys/util"),require("rxjs"),require("@angular/cdk/portal"),require("ngx-tethys/icon")):"function"==typeof define&&define.amd?define("ngx-tethys/notify",["exports","@angular/core","@angular/common","@angular/animations","ngx-tethys/core","ngx-tethys/store","ngx-tethys/util","rxjs","@angular/cdk/portal","ngx-tethys/icon"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self)["ngx-tethys"]=t["ngx-tethys"]||{},t["ngx-tethys"].notify={}),t.ng.core,t.ng.common,t.ng.animations,t["ngx-tethys"].core,t["ngx-tethys"].store,t["ngx-tethys"].util,t.rxjs,t.ng.cdk.portal,t["ngx-tethys"].icon)}(this,(function(t,e,o,n,i,r,s,a,c,l){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)};function f(t,e,o,n){var i,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(e,o,s):i(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s}function u(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}Object.create;Object.create;var h={topLeftQueue:[],topRightQueue:[],bottomLeftQueue:[],bottomRightQueue:[]},y=function(t){function e(){return t.call(this,h)||this}return function(t,e){function o(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}(e,t),e.topRightSelector=function(t){return t.topRightQueue},e.topLeftSelector=function(t){return t.topLeftQueue},e.bottomLeftSelector=function(t){return t.bottomLeftQueue},e.bottomRightSelector=function(t){return t.bottomRightQueue},e.prototype.convertQueueKey=function(t){var e;return"topLeft"===t?e="topLeftQueue":"topRight"===t?e="topRightQueue":"bottomLeft"===t?e="bottomLeftQueue":"bottomRight"===t&&(e="bottomRightQueue"),e},e.prototype.addNotify=function(t,e){var o=this.convertQueueKey(t),n=this.snapshot;n[o].length>e.maxStack&&n[o].shift(),n[o].push(e),this.next(n)},e.prototype.removeNotify=function(t,e){var o=this.snapshot;if(e){var n=this.convertQueueKey(e);o.hasOwnProperty(n)&&o[n].length&&(o[n]=o[n].filter((function(e){return e.id!==t})))}else Object.keys(o).forEach((function(e){o.hasOwnProperty(e)&&o[e].length&&(o[e]=o[e].filter((function(e){return e.id!==t})))}));this.next(o)},e}(r.Store);y.decorators=[{type:e.Injectable}],y.ctorParameters=function(){return[]},f([r.Action(),u("design:type",Function),u("design:paramtypes",[String,Object]),u("design:returntype",void 0)],y.prototype,"addNotify",null),f([r.Action(),u("design:type",Function),u("design:paramtypes",[Number,String]),u("design:returntype",void 0)],y.prototype,"removeNotify",null);var g=100,m={transform:"translateX(0)",opacity:0,height:0,paddingTop:0,paddingBottom:0,margin:0},d=function(){function t(t,e){this._queueStore=t,this._ngZone=e,this.className="",this.notifyIconName="",this.extendContentClass=!1,this.isShowDetail=!1}return Object.defineProperty(t.prototype,"thyOption",{set:function(t){this.option=t;var e=t.type;this.placement=t.placement||"topRight","topLeft"===this.placement||"bottomLeft"===this.placement?this.flyInOut="flyInOutLeft":this.flyInOut="flyInOutRight",this.className="thy-notify thy-notify-"+e},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){this.notifyIconName={success:"check-circle-fill",info:"info-circle-fill",warning:"waring-fill",error:"close-circle-fill"}[this.option.type],this._creatCloseTimer()},t.prototype.ngOnDestroy=function(){this._clearCloseTimer()},t.prototype.extendContent=function(){this.extendContentClass=!0},t.prototype.showDetailToggle=function(){this.isShowDetail=!this.isShowDetail},t.prototype.closeNotify=function(){var t=this;this._ngZone.runOutsideAngular((function(){t.flyInOut="componentHide",setTimeout((function(){t._queueStore.removeNotify(t.option.id,t.placement)}),150)}))},t.prototype.triggerDetail=function(){s.helpers.isFunction(this.option.detail.action)&&this.option.detail.action(),this.option.detail.content&&this.showDetailToggle()},t.prototype.mouseenter=function(){this.option.pauseOnHover&&this._clearCloseTimer()},t.prototype.mouseleave=function(){this.option.pauseOnHover&&this._creatCloseTimer()},t.prototype._creatCloseTimer=function(){var t=this;this.option.duration&&(this.closeTimer=setInterval((function(){clearInterval(t.closeTimer),t.closeNotify()}),this.option.duration))},t.prototype._clearCloseTimer=function(){clearInterval(this.closeTimer)},t}();d.decorators=[{type:e.Component,args:[{selector:"thy-notify",template:'<ng-container *ngIf="!option.html">\n  <a href="javascript:;" class="thy-notify-close" (click)="closeNotify()">\n    <thy-icon thyIconName="close"></thy-icon>\n  </a>\n  <div class="thy-notify-icon-container">\n    <thy-icon [thyIconName]="notifyIconName"></thy-icon>\n  </div>\n  <div class="thy-notify-main">\n    <div class="thy-notify-title">{{ option?.title }}</div>\n    <div\n      *ngIf="option?.detail || option?.content"\n      class="thy-notify-content"\n      [ngClass]="{ \'thy-notify-content--extend\': extendContentClass === true }"\n      (click)="extendContent()"\n    >\n      {{ option?.content }}\n      <a href="javascript:;" *ngIf="option?.detail" class="link-secondary" (click)="triggerDetail()">{{ (option?.detail)[\'link\'] }}</a>\n    </div>\n    <div class="thy-notify-detail" *ngIf="isShowDetail">{{ (option?.detail)[\'content\'] }}</div>\n  </div>\n</ng-container>\n<ng-container *ngIf="option?.html">\n  <a href="javascript:;" class="thy-notify-close" (click)="closeNotify()">\n    <thy-icon thyIconName="close"></thy-icon>\n  </a>\n  <div class="thy-notify-main">\n    <template [ngTemplateOutlet]="option?.html"></template>\n  </div>\n</ng-container>\n',providers:[i.UpdateHostClassService],animations:[n.trigger("flyInOut",[n.state("flyInOutRight",n.style({transform:"translateX(0)",opacity:1,height:"*"})),n.transition("void => flyInOutRight",[n.style({transform:"translateX(100%)",opacity:0,height:"*"}),n.animate(g)]),n.transition("flyInOutRight => componentHide",[n.animate(150,n.style(m))]),n.transition("flyInOutRight => void",[n.animate(g,n.style(m))]),n.state("flyInOutLeft",n.style({transform:"translateX(0)",opacity:1,height:"*"})),n.transition("void => flyInOutLeft",[n.style({transform:"translateX(-100%)",opacity:0,height:"*"}),n.animate(g)]),n.transition("flyInOutLeft => componentHide",[n.animate(150,n.style(m))]),n.transition("flyInOutLeft => void",[n.animate(g,n.style(m))]),n.state("componentHide",n.style(m))])]}]}],d.ctorParameters=function(){return[{type:y},{type:e.NgZone}]},d.propDecorators={flyInOut:[{type:e.HostBinding,args:["@flyInOut"]}],className:[{type:e.HostBinding,args:["class"]}],thyOption:[{type:e.Input}],mouseenter:[{type:e.HostListener,args:["mouseenter"]}],mouseleave:[{type:e.HostListener,args:["mouseleave"]}]};var v=function(){function t(t){this.queueStore=t,this.className=!0}return t.prototype.ngOnInit=function(){var t,e,o=this;this.placement=this.initialState.placement,"bottomRight"===this.placement?this.bottomRight=!0:"bottomLeft"===this.placement?this.bottomLeft=!0:"topLeft"===this.placement?this.topLeft=!0:this.topRight=!0,"topLeft"===this.placement?(e="topLeftQueue",t=this.queueStore.select(y.topLeftSelector)):"topRight"===this.placement?(e="topRightQueue",t=this.queueStore.select(y.topRightSelector)):"bottomLeft"===this.placement?(e="bottomLeftQueue",t=this.queueStore.select(y.bottomLeftSelector)):"bottomRight"===this.placement&&(e="bottomRightQueue",t=this.queueStore.select(y.bottomRightSelector)),t.subscribe((function(t){o[e]=t}))},t}();v.decorators=[{type:e.Component,args:[{selector:"thy-notify-container",template:'<thy-notify *ngFor="let item of topLeftQueue" [thyOption]="item"></thy-notify>\n<thy-notify *ngFor="let item of topRightQueue" [thyOption]="item"></thy-notify>\n<thy-notify *ngFor="let item of bottomLeftQueue" [thyOption]="item"></thy-notify>\n<thy-notify *ngFor="let item of bottomRightQueue" [thyOption]="item"></thy-notify>\n'}]}],v.ctorParameters=function(){return[{type:y}]},v.propDecorators={className:[{type:e.HostBinding,args:["class.thy-notify-root"]}],bottomRight:[{type:e.HostBinding,args:["class.thy-notify-bottomRight"]}],bottomLeft:[{type:e.HostBinding,args:["class.thy-notify-bottomLeft"]}],topLeft:[{type:e.HostBinding,args:["class.thy-notify-topLeft"]}],topRight:[{type:e.HostBinding,args:["class.thy-notify-topRight"]}]};var O=new e.InjectionToken("CONTAINER_PLACEMENT"),b=new e.InjectionToken("thy-notify-default-options"),R={},I={provide:b,useValue:R},N={duration:4500,pauseOnHover:!0,maxStack:8,placement:"topRight"},C=function(){function t(t,e,o,n,i){this.injector=t,this.componentFactoryResolver=e,this.appRef=o,this.queueStore=n,this.defaultConfig=i,this.notifyQueue$=new a.Subject,this._lastNotifyId=0}return t.prototype.show=function(t){var e=this.formatOptions(t),o=e.placement;this.queueStore.addNotify(o,e),this._initContainer(o)},t.prototype.success=function(t,e,o){this.show(Object.assign(Object.assign({},o||{}),{type:"success",title:t||(null==o?void 0:o.title)||"成功",content:e||(null==o?void 0:o.content)}))},t.prototype.info=function(t,e,o){this.show(Object.assign(Object.assign({},o||{}),{type:"info",title:t||(null==o?void 0:o.title)||"提示",content:e||(null==o?void 0:o.content)}))},t.prototype.warning=function(t,e,o){this.show(Object.assign(Object.assign({},o||{}),{type:"warning",title:t||(null==o?void 0:o.title)||"警告",content:e||(null==o?void 0:o.content)}))},t.prototype.error=function(t,e,o){var n,i,r=s.helpers.isString(o)?{type:"error",title:t||"错误",content:e,detail:o}:Object.assign(Object.assign({},o||{}),{type:"error",title:t||(null===(n=o)||void 0===n?void 0:n.title)||"错误",content:e||(null===(i=o)||void 0===i?void 0:i.content)});this.show(r)},t.prototype.removeNotifyById=function(t){this.queueStore.removeNotify(t)},t.prototype._initContainer=function(t){"topRight"===t?this.containerRefTopRight=this._loadNotifyContainerComponent(this.containerRefTopRight,t):"bottomRight"===t?this.containerRefBottomRight=this._loadNotifyContainerComponent(this.containerRefBottomRight,t):"bottomLeft"===t?this.containerRefBottomLeft=this._loadNotifyContainerComponent(this.containerRefBottomLeft,t):"topLeft"===t&&(this.containerRefTopLeft=this._loadNotifyContainerComponent(this.containerRefTopLeft,t))},t.prototype._loadNotifyContainerComponent=function(t,e){if(!t){var o=new c.DomPortalOutlet(document.body,this.componentFactoryResolver,this.appRef,this.injector),n=new c.ComponentPortal(v,null);t=o.attachComponentPortal(n),Object.assign(t.instance,{initialState:{placement:e}}),t.changeDetectorRef.detectChanges()}return t},t.prototype.formatOptions=function(t){return s.helpers.isString(t.detail)&&(t=Object.assign(Object.assign({},t),{detail:{link:"[详情]",content:t.detail}})),Object.assign({},N,{id:this._lastNotifyId++},this.defaultConfig,t)},t}();C.decorators=[{type:e.Injectable}],C.ctorParameters=function(){return[{type:e.Injector},{type:e.ComponentFactoryResolver},{type:e.ApplicationRef},{type:y},{type:void 0,decorators:[{type:e.Inject,args:[b]}]}]};var L=function(){};L.decorators=[{type:e.NgModule,args:[{declarations:[d,v],entryComponents:[v],providers:[C,y,I],imports:[o.CommonModule,l.ThyIconModule],exports:[v,d]}]}],t.CONTAINER_PLACEMENT=O,t.NotifyQueueStore=y,t.THY_NOTIFY_DEFAULT_OPTIONS=b,t.THY_NOTIFY_DEFAULT_OPTIONS_PROVIDER=I,t.ThyNotifyComponent=d,t.ThyNotifyContainerComponent=v,t.ThyNotifyModule=L,t.ThyNotifyService=C,t.notifyQueueInitialState=h,t.ɵ0=R,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-tethys-notify.umd.min.js.map
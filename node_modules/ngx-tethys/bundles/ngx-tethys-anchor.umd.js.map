{"version":3,"file":"ngx-tethys-anchor.umd.js","sources":["../../src/anchor/anchor.component.ts","../../src/anchor/anchor-link.component.ts","../../src/anchor/anchor.module.ts","../../src/anchor/ngx-tethys-anchor.ts"],"names":["EventEmitter","Subject","fromEvent","throttleTime","takeUntil","getOffset","Component","ViewEncapsulation","ChangeDetectionStrategy","Inject","DOCUMENT","ChangeDetectorRef","Platform","NgZone","Renderer2","ThyScrollService","ViewChild","Input","Output","TemplateRef","ElementRef","ContentChild","NgModule","CommonModule","PlatformModule","ThyAffixModule"],"mappings":"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","sourcesContent":["import { Platform } from '@angular/cdk/platform';\nimport {\n    AfterViewInit,\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    ElementRef,\n    EventEmitter,\n    Inject,\n    Input,\n    NgZone,\n    OnChanges,\n    OnDestroy,\n    Output,\n    Renderer2,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport { fromEvent, Subject } from 'rxjs';\nimport { takeUntil, throttleTime } from 'rxjs/operators';\n\nimport { ThyAnchorLinkComponent } from './anchor-link.component';\nimport { getOffset } from 'ngx-tethys/util';\nimport { ThyScrollService } from 'ngx-tethys/core';\nimport { DOCUMENT } from '@angular/common';\n\ninterface Section {\n    linkComponent: ThyAnchorLinkComponent;\n    top: number;\n}\n\nconst sharpMatcherRegx = /#([^#]+)$/;\n\n@Component({\n    selector: 'thy-anchor',\n    exportAs: 'thyAnchor',\n    preserveWhitespaces: false,\n    template: `\n        <thy-affix *ngIf=\"thyAffix; else content\" [thyOffsetTop]=\"thyOffsetTop\" [thyContainer]=\"container\">\n            <ng-template [ngTemplateOutlet]=\"content\"></ng-template>\n        </thy-affix>\n        <ng-template #content>\n            <div class=\"thy-anchor-wrapper\" [ngStyle]=\"wrapperStyle\">\n                <div class=\"thy-anchor\">\n                    <div class=\"thy-anchor-ink\">\n                        <div class=\"thy-anchor-ink-full\" #ink></div>\n                    </div>\n                    <ng-content></ng-content>\n                </div>\n            </div>\n        </ng-template>\n    `,\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ThyAnchorComponent implements OnDestroy, AfterViewInit, OnChanges {\n    @ViewChild('ink') private ink!: ElementRef;\n\n    @Input() thyAffix = true;\n\n    @Input()\n    thyBounds = 5;\n\n    @Input()\n    thyOffsetTop?: number = undefined;\n\n    @Input() thyContainer?: string | HTMLElement;\n    @Input() thyTarget: string | HTMLElement = '';\n\n    @Output() readonly thyClick = new EventEmitter<ThyAnchorLinkComponent>();\n    @Output() readonly thyScroll = new EventEmitter<ThyAnchorLinkComponent>();\n\n    visible = false;\n    wrapperStyle = { 'max-height': '100vh' };\n\n    container?: HTMLElement | Window;\n\n    private links: ThyAnchorLinkComponent[] = [];\n    private animating = false;\n    private destroy$ = new Subject();\n    private handleScrollTimeoutID = -1;\n\n    constructor(\n        @Inject(DOCUMENT) private document: any,\n        private cdr: ChangeDetectorRef,\n        private platform: Platform,\n        private zone: NgZone,\n        private renderer: Renderer2,\n        private scrollService: ThyScrollService\n    ) {}\n\n    registerLink(link: ThyAnchorLinkComponent): void {\n        this.links.push(link);\n    }\n\n    unregisterLink(link: ThyAnchorLinkComponent): void {\n        this.links.splice(this.links.indexOf(link), 1);\n    }\n\n    private getContainer(): HTMLElement | Window {\n        return this.container || window;\n    }\n\n    ngAfterViewInit(): void {\n        this.registerScrollEvent();\n    }\n\n    ngOnDestroy(): void {\n        clearTimeout(this.handleScrollTimeoutID);\n        this.destroy$.next();\n        this.destroy$.complete();\n    }\n\n    private registerScrollEvent(): void {\n        if (!this.platform.isBrowser) {\n            return;\n        }\n        this.destroy$.next();\n        this.zone.runOutsideAngular(() => {\n            fromEvent(this.getContainer(), 'scroll')\n                .pipe(throttleTime(50), takeUntil(this.destroy$))\n                .subscribe(() => this.handleScroll());\n        });\n        // Browser would maintain the scrolling position when refreshing.\n        // So we have to delay calculation in avoid of getting a incorrect result.\n        this.handleScrollTimeoutID = setTimeout(() => this.handleScroll());\n    }\n\n    handleScroll(): void {\n        if (typeof document === 'undefined' || this.animating) {\n            return;\n        }\n        const container: HTMLElement = this.container instanceof HTMLElement ? this.container : this.document;\n\n        const sections: Section[] = [];\n        const scope = (this.thyOffsetTop || 0) + this.thyBounds;\n        this.links.forEach(linkComponent => {\n            const sharpLinkMatch = sharpMatcherRegx.exec(linkComponent.thyHref.toString());\n            if (!sharpLinkMatch) {\n                return;\n            }\n            const target = container.querySelector(`#${sharpLinkMatch[1]}`) as HTMLElement;\n            if (target) {\n                const top = getOffset(target, this.getContainer()).top;\n                if (top < scope) {\n                    sections.push({\n                        top,\n                        linkComponent\n                    });\n                }\n            }\n        });\n\n        this.visible = !!sections.length;\n        if (!this.visible) {\n            this.clearActive();\n            this.cdr.detectChanges();\n        } else {\n            const maxSection = sections.reduce((prev, curr) => (curr.top > prev.top ? curr : prev));\n            this.handleActive(maxSection.linkComponent);\n        }\n        this.setVisible();\n    }\n\n    private clearActive(): void {\n        this.links.forEach(i => {\n            i.unsetActive();\n        });\n    }\n\n    private handleActive(linkComponent: ThyAnchorLinkComponent): void {\n        this.clearActive();\n        linkComponent.setActive();\n        const linkNode = linkComponent.getLinkTitleElement();\n\n        this.ink.nativeElement.style.top = `${linkNode.offsetTop}px`;\n        this.ink.nativeElement.style.height = `${linkNode.clientHeight}px`;\n        this.visible = true;\n        this.setVisible();\n        this.thyScroll.emit(linkComponent);\n    }\n\n    private setVisible(): void {\n        const visible = this.visible;\n        const visibleClassname = 'visible';\n        if (this.ink) {\n            if (visible) {\n                this.renderer.addClass(this.ink.nativeElement, visibleClassname);\n            } else {\n                this.renderer.removeClass(this.ink.nativeElement, visibleClassname);\n            }\n        }\n    }\n\n    handleScrollTo(linkComponent: ThyAnchorLinkComponent): void {\n        const container: HTMLElement = this.container instanceof HTMLElement ? this.container : this.document;\n        const linkElement: HTMLElement = container.querySelector(linkComponent.thyHref);\n        if (!linkElement) {\n            return;\n        }\n\n        this.animating = true;\n        const containerScrollTop = this.scrollService.getScroll(this.getContainer());\n        const elementOffsetTop = getOffset(linkElement, this.getContainer()).top;\n        const targetScrollTop = containerScrollTop + elementOffsetTop - (this.thyOffsetTop || 0);\n        this.scrollService.scrollTo(this.getContainer(), targetScrollTop, undefined, () => {\n            this.animating = false;\n        });\n        this.handleActive(linkComponent);\n        this.thyClick.emit(linkComponent);\n    }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        const { thyOffsetTop, thyContainer } = changes;\n        if (thyOffsetTop) {\n            this.wrapperStyle = {\n                'max-height': `calc(100vh - ${this.thyOffsetTop}px)`\n            };\n        }\n        if (thyContainer && this.thyContainer) {\n            const container = this.thyContainer || this.thyTarget;\n            this.container = typeof container === 'string' ? this.document.querySelector(container) : container;\n            this.registerScrollEvent();\n        }\n    }\n}\n","import { Platform } from '@angular/cdk/platform';\nimport {\n    ChangeDetectionStrategy,\n    Component,\n    ContentChild,\n    ElementRef,\n    Input,\n    OnDestroy,\n    OnInit,\n    Renderer2,\n    TemplateRef,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\n\nimport { ThyAnchorComponent } from './anchor.component';\n\n@Component({\n    selector: 'thy-link',\n    exportAs: 'thyLink',\n    preserveWhitespaces: false,\n    template: `\n        <a #linkTitle (click)=\"goToClick($event)\" href=\"{{ thyHref }}\" class=\"thy-anchor-link-title\" title=\"{{ title }}\">\n            <span *ngIf=\"title; else titleTemplate || thyTemplate\">{{ title }}</span>\n        </a>\n        <ng-content></ng-content>\n    `,\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ThyAnchorLinkComponent implements OnInit, OnDestroy {\n    @Input() thyHref = '#';\n\n    title: string | null = '';\n    titleTemplate?: TemplateRef<any>;\n\n    @Input()\n    set thyTitle(value: string | TemplateRef<void>) {\n        if (value instanceof TemplateRef) {\n            this.title = null;\n            this.titleTemplate = value;\n        } else {\n            this.title = value;\n        }\n    }\n\n    @ContentChild('thyTemplate') thyTemplate!: TemplateRef<void>;\n    @ViewChild('linkTitle', { static: true }) linkTitle!: ElementRef<HTMLAnchorElement>;\n\n    constructor(\n        public elementRef: ElementRef,\n        private anchorComponent: ThyAnchorComponent,\n        private platform: Platform,\n        private renderer: Renderer2\n    ) {\n        this.renderer.addClass(elementRef.nativeElement, 'thy-anchor-link');\n    }\n\n    ngOnInit(): void {\n        this.anchorComponent.registerLink(this);\n    }\n\n    getLinkTitleElement(): HTMLAnchorElement {\n        return this.linkTitle.nativeElement;\n    }\n\n    setActive(): void {\n        this.renderer.addClass(this.elementRef.nativeElement, 'thy-anchor-link-active');\n    }\n\n    unsetActive(): void {\n        this.renderer.removeClass(this.elementRef.nativeElement, 'thy-anchor-link-active');\n    }\n\n    goToClick(e: Event): void {\n        e.preventDefault();\n        e.stopPropagation();\n        if (this.platform.isBrowser) {\n            this.anchorComponent.handleScrollTo(this);\n        }\n    }\n\n    ngOnDestroy(): void {\n        this.anchorComponent.unregisterLink(this);\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { PlatformModule } from '@angular/cdk/platform';\nimport { ThyAnchorComponent } from './anchor.component';\nimport { ThyAnchorLinkComponent } from './anchor-link.component';\nimport { ThyAffixModule } from 'ngx-tethys/affix';\n\n@NgModule({\n    declarations: [ThyAnchorComponent, ThyAnchorLinkComponent],\n    exports: [ThyAnchorComponent, ThyAnchorLinkComponent],\n    imports: [CommonModule, PlatformModule, ThyAffixModule]\n})\nexport class ThyAnchorModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"]}
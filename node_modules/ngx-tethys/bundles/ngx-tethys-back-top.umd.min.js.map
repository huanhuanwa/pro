{"version":3,"sources":["../../src/back-top/back-top.component.ts","../../src/back-top/back-top.module.ts"],"names":["ThyBackTopComponent","doc","thyScrollService","platform","cdr","zone","this","classNames","thyVisibilityHeight","thyClick","EventEmitter","visibleChange","visible","scrollListenerDestroy$","Subject","target","prototype","ngOnInit","registerScrollEvent","clickBackTop","scrollTo","getTarget","emit","window","handleScroll","_this","getScroll","detectChanges","run","isBrowser","next","runOutsideAngular","fromEvent","pipe","throttleTime","takeUntil","subscribe","ngOnDestroy","complete","ngOnChanges","changes","thyContainer","querySelector","Component","args","selector","template","changeDetection","ChangeDetectionStrategy","OnPush","encapsulation","ViewEncapsulation","None","animations","fadeMotion","Inject","DOCUMENT","ThyScrollService","Platform","ChangeDetectorRef","NgZone","HostBinding","Input","Output","NgModule","declarations","imports","CommonModule","ThyIconModule","exports"],"mappings":"ivBAgDI,SAAAA,EAC8BC,EAClBC,EACAC,EACAC,EACAC,GAJkBC,KAAAL,IAAAA,EAClBK,KAAAJ,iBAAAA,EACAI,KAAAH,SAAAA,EACAG,KAAAF,IAAAA,EACAE,KAAAD,KAAAA,EAvBiCC,KAAAC,YAAa,EAIjDD,KAAAE,oBAAsB,IAIZF,KAAAG,SAAkC,IAAIC,EAAAA,aAExCJ,KAAAK,cAAuC,IAAID,EAAAA,aAErDJ,KAAAM,SAAU,EAETN,KAAAO,uBAAyB,IAAIC,EAAAA,QAE7BR,KAAAS,OAA6B,YAUrCf,EAAAgB,UAAAC,SAAA,WACIX,KAAKY,uBAGTlB,EAAAgB,UAAAG,aAAA,WACIb,KAAKJ,iBAAiBkB,SAASd,KAAKe,YAAa,GACjDf,KAAKG,SAASa,MAAK,IAGftB,EAAAgB,UAAAK,UAAA,WACJ,OAAOf,KAAKS,QAAUQ,QAGlBvB,EAAAgB,UAAAQ,aAAA,WAAA,IAAAC,EAAAnB,KACAA,KAAKM,UAAYN,KAAKJ,iBAAiBwB,UAAUpB,KAAKe,aAAef,KAAKE,sBAG9EF,KAAKM,SAAWN,KAAKM,QACrBN,KAAKF,IAAIuB,gBACTrB,KAAKD,KAAKuB,KAAI,WACVH,EAAKd,cAAcW,KAAKG,EAAKb,cAI7BZ,EAAAgB,UAAAE,oBAAA,WAAA,IAAAO,EAAAnB,KACCA,KAAKH,SAAS0B,YAGnBvB,KAAKO,uBAAuBiB,OAC5BxB,KAAKkB,eACLlB,KAAKD,KAAK0B,mBAAkB,WACxBC,EAAAA,UAAUP,EAAKJ,YAAa,UACvBY,KAAKC,EAAAA,aAAa,IAAKC,EAAAA,UAAUV,EAAKZ,yBACtCuB,WAAU,WAAM,OAAAX,EAAKD,uBAIlCxB,EAAAgB,UAAAqB,YAAA,WACI/B,KAAKO,uBAAuBiB,OAC5BxB,KAAKO,uBAAuByB,YAGhCtC,EAAAgB,UAAAuB,YAAA,SAAYC,GACiBA,EAAOC,eAE5BnC,KAAKS,OAAsC,iBAAtBT,KAAKmC,aAA4BnC,KAAKL,IAAIyC,cAAcpC,KAAKmC,cAAgBnC,KAAKmC,aACvGnC,KAAKY,iDAhFhByB,EAAAA,UAASC,KAAA,CAAC,CACPC,SAAU,4BACVC,SAAA,uXACAC,gBAAiBC,EAAAA,wBAAwBC,OACzCC,cAAeC,EAAAA,kBAAkBC,KACjCC,WAAY,CAACC,EAAAA,kFAsBRC,EAAAA,OAAMX,KAAA,CAACY,EAAAA,mBA7BKC,EAAAA,wBAHZC,EAAAA,gBANLC,EAAAA,yBADAC,EAAAA,8CAoBCC,EAAAA,YAAWjB,KAAA,CAAC,qDAEZkB,EAAAA,mCAEAA,EAAAA,4BAEAA,EAAAA,wBAEAC,EAAAA,8BAEAA,EAAAA,gBC9BL,iCALCC,EAAAA,SAAQpB,KAAA,CAAC,CACNqB,aAAc,CAACjE,GACfkE,QAAS,CAACC,EAAAA,aAAcC,EAAAA,eACxBC,QAAS,CAACrE","sourcesContent":["import {\n    Component,\n    OnInit,\n    ChangeDetectionStrategy,\n    ViewEncapsulation,\n    Input,\n    TemplateRef,\n    EventEmitter,\n    Output,\n    HostBinding,\n    NgZone,\n    ChangeDetectorRef,\n    OnDestroy,\n    OnChanges,\n    Inject\n} from '@angular/core';\nimport { Subject, fromEvent } from 'rxjs';\nimport { Platform } from '@angular/cdk/platform';\nimport { throttleTime, takeUntil } from 'rxjs/operators';\nimport { DOCUMENT } from '@angular/common';\nimport { fadeMotion, ThyScrollService } from 'ngx-tethys/core';\n\n@Component({\n    selector: 'thy-back-top,[thyBackTop]',\n    templateUrl: './back-top.component.html',\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    encapsulation: ViewEncapsulation.None,\n    animations: [fadeMotion]\n})\nexport class ThyBackTopComponent implements OnInit, OnDestroy, OnChanges {\n    @HostBinding('class.thy-back-top-container') classNames = true;\n\n    @Input() thyTemplate?: TemplateRef<void>;\n\n    @Input() thyVisibilityHeight = 400;\n\n    @Input() thyContainer?: string | HTMLElement;\n\n    @Output() readonly thyClick: EventEmitter<boolean> = new EventEmitter();\n\n    @Output() public visibleChange: EventEmitter<boolean> = new EventEmitter();\n\n    public visible = false;\n\n    private scrollListenerDestroy$ = new Subject();\n\n    private target: HTMLElement | null = null;\n\n    constructor(\n        @Inject(DOCUMENT) private doc: any,\n        private thyScrollService: ThyScrollService,\n        private platform: Platform,\n        private cdr: ChangeDetectorRef,\n        private zone: NgZone\n    ) {}\n\n    ngOnInit(): void {\n        this.registerScrollEvent();\n    }\n\n    clickBackTop(): void {\n        this.thyScrollService.scrollTo(this.getTarget(), 0);\n        this.thyClick.emit(true);\n    }\n\n    private getTarget(): HTMLElement | Window {\n        return this.target || window;\n    }\n\n    private handleScroll(): void {\n        if (this.visible === this.thyScrollService.getScroll(this.getTarget()) > this.thyVisibilityHeight) {\n            return;\n        }\n        this.visible = !this.visible;\n        this.cdr.detectChanges();\n        this.zone.run(() => {\n            this.visibleChange.emit(this.visible);\n        });\n    }\n\n    private registerScrollEvent(): void {\n        if (!this.platform.isBrowser) {\n            return;\n        }\n        this.scrollListenerDestroy$.next();\n        this.handleScroll();\n        this.zone.runOutsideAngular(() => {\n            fromEvent(this.getTarget(), 'scroll')\n                .pipe(throttleTime(50), takeUntil(this.scrollListenerDestroy$))\n                .subscribe(() => this.handleScroll());\n        });\n    }\n\n    ngOnDestroy(): void {\n        this.scrollListenerDestroy$.next();\n        this.scrollListenerDestroy$.complete();\n    }\n\n    ngOnChanges(changes: any): void {\n        const { thyContainer } = changes;\n        if (thyContainer) {\n            this.target = typeof this.thyContainer === 'string' ? this.doc.querySelector(this.thyContainer) : this.thyContainer;\n            this.registerScrollEvent();\n        }\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ThyIconModule } from 'ngx-tethys/icon';\nimport { ThyBackTopComponent } from './back-top.component';\n\n@NgModule({\n    declarations: [ThyBackTopComponent],\n    imports: [CommonModule, ThyIconModule],\n    exports: [ThyBackTopComponent]\n})\nexport class ThyBackTopModule {}\n"]}
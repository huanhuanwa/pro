!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("ngx-tethys/icon"),require("@angular/core"),require("@angular/common"),require("@angular/forms"),require("ngx-tethys/popover"),require("date-fns"),require("ngx-tethys/action-menu"),require("ngx-tethys/shared"),require("ngx-tethys/date-picker"),require("ngx-tethys/nav")):"function"==typeof define&&define.amd?define("ngx-tethys/date-range",["exports","ngx-tethys/icon","@angular/core","@angular/common","@angular/forms","ngx-tethys/popover","date-fns","ngx-tethys/action-menu","ngx-tethys/shared","ngx-tethys/date-picker","ngx-tethys/nav"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self)["ngx-tethys"]=e["ngx-tethys"]||{},e["ngx-tethys"]["date-range"]={}),e["ngx-tethys"].icon,e.ng.core,e.ng.common,e.ng.forms,e["ngx-tethys"].popover,e.dateFns,e["ngx-tethys"]["action-menu"],e["ngx-tethys"].shared,e["ngx-tethys"]["date-picker"],e["ngx-tethys"].nav)}(this,(function(e,t,n,a,i,o,s,h,c,r,d){"use strict";var y=function(){function e(e){this.thyPopover=e,this.hiddenMenu=!1,this.customValue="自定义"}return e.prototype.ngOnInit=function(){},e.prototype._selectDateRange=function(e){this.selectedDate=e,this.selectedDateRange(e),this.thyPopover.close()},e.prototype._selectedCustomDate=function(e){this.selectedDate={begin:e.begin,end:e.end,key:this.customKey,text:this.customValue},this.selectedDateRange(this.selectedDate)},e}();y.decorators=[{type:n.Component,args:[{selector:"date-range-optional",template:'<thy-action-menu *ngIf="!hiddenMenu" class="thy-date-range-action-menu-container">\n  <a thyActionMenuItem href="javascript:;" *ngFor="let dateRange of optionalDateRanges" (click)="_selectDateRange(dateRange)">\n    <span thyActionMenuItemName>{{ dateRange?.text }}</span>\n    <span thyActionMenuItemExtendIcon *ngIf="dateRange.key === selectedDate?.key">\n      <thy-icon class="text-primary" thyIconName="check"></thy-icon>\n    </span>\n  </a>\n  <a\n    thyActionMenuItem\n    href="javascript:;"\n    thyRangePicker\n    [(ngModel)]="selectedDate"\n    [thyMinDate]="minDate"\n    [thyMaxDate]="maxDate"\n    (ngModelChange)="_selectedCustomDate($event)"\n  >\n    <span thyActionMenuItemName>{{ customValue }}</span>\n    <span thyActionMenuItemExtendIcon *ngIf="customKey === selectedDate?.key">\n      <thy-icon class="text-primary" thyIconName="check"></thy-icon>\n    </span>\n  </a>\n</thy-action-menu>\n'}]}],y.ctorParameters=function(){return[{type:o.ThyPopover}]};var g={provide:i.NG_VALUE_ACCESSOR,useExisting:n.forwardRef((function(){return u})),multi:!0},u=function(){function e(e,t){this.thyPopover=e,this.cdr=t,this.thyHiddenMenu=!1,this.thyDisabledSwitch=!1,this.thyCustomTextValue="自定义",this.thyCustomKey="custom",this.optionalDateRanges=[{key:"week",text:"本周",begin:s.getUnixTime(s.startOfISOWeek(new Date)),end:s.getUnixTime(s.endOfISOWeek(new Date)),timestamp:{interval:7,unit:"day"}},{key:"month",text:"本月",begin:s.getUnixTime(s.startOfMonth(new Date)),end:s.getUnixTime(s.endOfMonth(new Date)),timestamp:{interval:1,unit:"month"}}],this.onModelChange=function(){},this.onModelTouched=function(){}}return Object.defineProperty(e.prototype,"thyOptionalDateRanges",{set:function(e){this.optionalDateRanges=e.length>0?e:this.optionalDateRanges},enumerable:!1,configurable:!0}),e.prototype.writeValue=function(e){e?this.selectedDate=e:this.optionalDateRanges.length>0&&(this.selectedDate=this.optionalDateRanges[0],this.onModelChange(this.selectedDate)),this._setSelectedDateRange(),this.cdr.detectChanges()},e.prototype.registerOnChange=function(e){this.onModelChange=e},e.prototype.registerOnTouched=function(e){this.onModelTouched=e},e.prototype.ngOnInit=function(){},e.prototype._setSelectedDateRange=function(){this.selectedDateRange={begin:this.selectedDate.begin,end:this.selectedDate.end}},e.prototype._calculateNewTime=function(e){if(!this.selectedDate.timestamp){a=this.selectedDate.end-this.selectedDate.begin+86400;return"previous"===e?{begin:this.selectedDate.begin-a,end:this.selectedDate.end-a,key:this.thyCustomKey}:{begin:this.selectedDate.begin+a,end:this.selectedDate.end+a,key:this.thyCustomKey}}var t=new Date(1e3*this.selectedDate.begin),n=new Date(1e3*this.selectedDate.end),a=this.selectedDate.timestamp.interval;return"day"===this.selectedDate.timestamp.unit?"previous"===e?{begin:s.getUnixTime(s.addDays(t,-1*a)),end:s.getUnixTime(s.addDays(n,-1*a)),key:this.thyCustomKey}:{begin:s.getUnixTime(s.addDays(t,1*a)),end:s.getUnixTime(s.addDays(n,1*a)),key:this.thyCustomKey}:"month"===this.selectedDate.timestamp.unit?"previous"===e?{begin:s.getUnixTime(s.addMonths(t,-1*a)),end:s.getUnixTime(s.addMonths(n,-1*a)),key:this.thyCustomKey}:{begin:s.getUnixTime(s.addMonths(t,1*a)),end:s.getUnixTime(s.addMonths(n,1*a)),key:this.thyCustomKey}:"year"===this.selectedDate.timestamp.unit?"previous"===e?{begin:s.getUnixTime(s.addYears(t,-1*a)),end:s.getUnixTime(s.addYears(n,-1*a)),key:this.thyCustomKey}:{begin:s.getUnixTime(s.addYears(t,1*a)),end:s.getUnixTime(s.addYears(n,1*a)),key:this.thyCustomKey}:void 0},e.prototype._setPreviousOrNextDate=function(e){this.selectedDate=Object.assign({},this.selectedDate,this._calculateNewTime(e)),this._setSelectedDateRange(),this.onModelChange(this.selectedDate)},e.prototype.previous=function(){this._setPreviousOrNextDate("previous")},e.prototype.next=function(){this._setPreviousOrNextDate("next")},e.prototype.openOptionalDateRangesMenu=function(e){var t=this;this.thyHiddenMenu||this.thyPopover.open(y,{origin:e.currentTarget,hasBackdrop:!0,backdropClass:"thy-overlay-transparent-backdrop",offset:0,manualClosure:!0,originActiveClass:"thy-date-range-text-active",initialState:{hiddenMenu:this.thyHiddenMenu,optionalDateRanges:this.optionalDateRanges,selectedDate:this.selectedDate,minDate:this.thyMinDate,maxDate:this.thyMaxDate,customValue:this.thyCustomTextValue,customKey:this.thyCustomKey,selectedDateRange:function(e){t.onModelChange(e),t.selectedDate=e}}})},e}();u.decorators=[{type:n.Component,args:[{selector:"thy-date-range",template:'<div class="thy-date-range-container">\n  <ng-container *ngIf="!thyDisabledSwitch">\n    <thy-icon-nav thyType="secondary" (click)="previous()">\n      <a href="javascript:;" thyIconNavLink><thy-icon thyIconName="angle-left"></thy-icon></a>\n    </thy-icon-nav>\n  </ng-container>\n  <span\n    href="javascript:;"\n    (click)="openOptionalDateRangesMenu($event)"\n    class="thy-date-range-text"\n    [ngClass]="{ \'thy-date-range-disabled\': thyHiddenMenu }"\n  >\n    <ng-container *ngIf="selectedDate?.key === \'custom\'">\n      {{ selectedDate?.begin | thyDatePickerFormat }} ~ {{ selectedDate?.end | thyDatePickerFormat }}\n    </ng-container>\n    <ng-container *ngIf="selectedDate?.key === \'exception\'">\n      {{ selectedDate?.begin | thyDatePickerFormat: thyPickerFormat }}\n    </ng-container>\n    <ng-container *ngIf="selectedDate?.key !== \'custom\' && selectedDate?.key !== \'exception\'">{{ selectedDate?.text }}</ng-container>\n    <thy-icon *ngIf="!thyHiddenMenu" class="thy-date-range-text-caret-down ml-2" thyIconName="angle-down"></thy-icon>\n  </span>\n  <ng-container *ngIf="!thyDisabledSwitch">\n    <thy-icon-nav thyType="secondary" (click)="next()">\n      <a href="javascript:;" thyIconNavLink><thy-icon thyIconName="angle-right"></thy-icon></a>\n    </thy-icon-nav>\n  </ng-container>\n</div>\n',providers:[g]}]}],u.ctorParameters=function(){return[{type:o.ThyPopover},{type:n.ChangeDetectorRef}]},u.propDecorators={thyOptionalDateRanges:[{type:n.Input}],thyHiddenMenu:[{type:n.Input}],thyDisabledSwitch:[{type:n.Input}],thyCustomTextValue:[{type:n.Input}],thyMinDate:[{type:n.Input}],thyMaxDate:[{type:n.Input}],thyCustomKey:[{type:n.Input}],thyPickerFormat:[{type:n.Input}]};var l=function(){};l.decorators=[{type:n.NgModule,args:[{imports:[a.CommonModule,i.FormsModule,h.ThyActionMenuModule,c.ThySharedModule,t.ThyIconModule,r.ThyDatePickerModule,d.ThyNavModule],declarations:[u,y],exports:[u],entryComponents:[y]}]}];var p=function(){};e.DateRangeItemInfo=p,e.OptionalDateRangesComponent=y,e.ThyDateRangeComponent=u,e.ThyDateRangeModule=l,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-tethys-date-range.umd.min.js.map
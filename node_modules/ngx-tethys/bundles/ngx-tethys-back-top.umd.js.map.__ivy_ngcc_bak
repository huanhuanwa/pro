{"version":3,"file":"ngx-tethys-back-top.umd.js","sources":["../../src/back-top/back-top.component.ts","../../src/back-top/back-top.module.ts","../../src/back-top/ngx-tethys-back-top.ts"],"sourcesContent":["import {\n    Component,\n    OnInit,\n    ChangeDetectionStrategy,\n    ViewEncapsulation,\n    Input,\n    TemplateRef,\n    EventEmitter,\n    Output,\n    HostBinding,\n    NgZone,\n    ChangeDetectorRef,\n    OnDestroy,\n    OnChanges,\n    Inject\n} from '@angular/core';\nimport { Subject, fromEvent } from 'rxjs';\nimport { Platform } from '@angular/cdk/platform';\nimport { throttleTime, takeUntil } from 'rxjs/operators';\nimport { DOCUMENT } from '@angular/common';\nimport { fadeMotion, ThyScrollService } from 'ngx-tethys/core';\n\n@Component({\n    selector: 'thy-back-top,[thyBackTop]',\n    templateUrl: './back-top.component.html',\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    encapsulation: ViewEncapsulation.None,\n    animations: [fadeMotion]\n})\nexport class ThyBackTopComponent implements OnInit, OnDestroy, OnChanges {\n    @HostBinding('class.thy-back-top-container') classNames = true;\n\n    @Input() thyTemplate?: TemplateRef<void>;\n\n    @Input() thyVisibilityHeight = 400;\n\n    @Input() thyContainer?: string | HTMLElement;\n\n    @Output() readonly thyClick: EventEmitter<boolean> = new EventEmitter();\n\n    @Output() public visibleChange: EventEmitter<boolean> = new EventEmitter();\n\n    public visible = false;\n\n    private scrollListenerDestroy$ = new Subject();\n\n    private target: HTMLElement | null = null;\n\n    constructor(\n        @Inject(DOCUMENT) private doc: any,\n        private thyScrollService: ThyScrollService,\n        private platform: Platform,\n        private cdr: ChangeDetectorRef,\n        private zone: NgZone\n    ) {}\n\n    ngOnInit(): void {\n        this.registerScrollEvent();\n    }\n\n    clickBackTop(): void {\n        this.thyScrollService.scrollTo(this.getTarget(), 0);\n        this.thyClick.emit(true);\n    }\n\n    private getTarget(): HTMLElement | Window {\n        return this.target || window;\n    }\n\n    private handleScroll(): void {\n        if (this.visible === this.thyScrollService.getScroll(this.getTarget()) > this.thyVisibilityHeight) {\n            return;\n        }\n        this.visible = !this.visible;\n        this.cdr.detectChanges();\n        this.zone.run(() => {\n            this.visibleChange.emit(this.visible);\n        });\n    }\n\n    private registerScrollEvent(): void {\n        if (!this.platform.isBrowser) {\n            return;\n        }\n        this.scrollListenerDestroy$.next();\n        this.handleScroll();\n        this.zone.runOutsideAngular(() => {\n            fromEvent(this.getTarget(), 'scroll')\n                .pipe(throttleTime(50), takeUntil(this.scrollListenerDestroy$))\n                .subscribe(() => this.handleScroll());\n        });\n    }\n\n    ngOnDestroy(): void {\n        this.scrollListenerDestroy$.next();\n        this.scrollListenerDestroy$.complete();\n    }\n\n    ngOnChanges(changes: any): void {\n        const { thyContainer } = changes;\n        if (thyContainer) {\n            this.target = typeof this.thyContainer === 'string' ? this.doc.querySelector(this.thyContainer) : this.thyContainer;\n            this.registerScrollEvent();\n        }\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ThyIconModule } from 'ngx-tethys/icon';\nimport { ThyBackTopComponent } from './back-top.component';\n\n@NgModule({\n    declarations: [ThyBackTopComponent],\n    imports: [CommonModule, ThyIconModule],\n    exports: [ThyBackTopComponent]\n})\nexport class ThyBackTopModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["EventEmitter","Subject","fromEvent","throttleTime","takeUntil","Component","ChangeDetectionStrategy","ViewEncapsulation","fadeMotion","Inject","DOCUMENT","ThyScrollService","Platform","ChangeDetectorRef","NgZone","HostBinding","Input","Output","NgModule","CommonModule","ThyIconModule"],"mappings":"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"}
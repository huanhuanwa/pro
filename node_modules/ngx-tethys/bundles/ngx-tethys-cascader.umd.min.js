!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@angular/forms"),require("@angular/cdk/overlay"),require("ngx-tethys/input"),require("ngx-tethys/core"),require("ngx-tethys/util"),require("ngx-tethys/icon")):"function"==typeof define&&define.amd?define("ngx-tethys/cascader",["exports","@angular/core","@angular/common","@angular/forms","@angular/cdk/overlay","ngx-tethys/input","ngx-tethys/core","ngx-tethys/util","ngx-tethys/icon"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self)["ngx-tethys"]=t["ngx-tethys"]||{},t["ngx-tethys"].cascader={}),t.ng.core,t.ng.common,t.ng.forms,t.ng.cdk.overlay,t["ngx-tethys"].input,t["ngx-tethys"].core,t["ngx-tethys"].util,t["ngx-tethys"].icon)}(this,(function(t,e,n,i,o,s,r,a,l){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */Object.create;function h(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,s=n.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)r.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}return r}Object.create;function p(t,e){if(!t||!e||t.length!==e.length)return!1;for(var n=t.length,i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}var u=function(t){return t.join(" / ")},c=u,y=function(){function t(t,n,i){this.cdr=t,this.elementRef=n,this.updateHostClassService=i,this.changeOnSelect=!1,this.showInput=!0,this.prefixCls="thy-cascader",this.dropDownPosition="bottom",this.menuVisible=!1,this.isLoading=!1,this.isOpening=!1,this.showSearch=!1,this._thySize="md",this.isLabelRenderTemplate=!1,this.labelRenderContext={},this.onChange=Function.prototype,this.onTouched=Function.prototype,this.cascaderPositon=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(h(arguments[e]));return t}(r.EXPANDED_DROPDOWN_POSITIONS),this.selectedOptions=[],this.activatedOptions=[],this.thyColumns=[],this.thyValueProperty="value",this.thyLabelProperty="label",this.thyPlaceHolder="请选择",this._inputValue="",this.inSearch=!1,this.thyTriggerAction=["click"],this.thyExpandTriggerAction=["click"],this.disabled=!1,this.thyChange=new e.EventEmitter,this.thySelectionChange=new e.EventEmitter,this.thySelect=new e.EventEmitter,this.thyClear=new e.EventEmitter,i.initializeElement(n.nativeElement)}return Object.defineProperty(t.prototype,"thyLabelRender",{get:function(){return this.labelRenderTpl},set:function(t){this.labelRenderTpl=t,this.isLabelRenderTemplate=t instanceof e.TemplateRef},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputValue",{get:function(){return this._inputValue},set:function(t){this._inputValue=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thyChangeOnSelect",{get:function(){return this.changeOnSelect},set:function(t){this.changeOnSelect=a.coerceBooleanProperty(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thyShowInput",{get:function(){return this.showInput},set:function(t){this.showInput=a.coerceBooleanProperty(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thyOptions",{set:function(t){this.oldColumnsHolder=this.thyColumns=t&&t.length?[t]:[],this.inSearch||this.defaultValue&&this.thyColumns.length&&this.initOptions(0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thyMenuClassName",{get:function(){return this.menuClassName},set:function(t){this.menuClassName=t,this.setMenuClass()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thyColumnClassName",{get:function(){return this.columnClassName},set:function(t){this.columnClassName=t,this.setMenuClass()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thySize",{get:function(){return this._thySize},set:function(t){this._thySize=t},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){this.setClassMap(),this.setMenuClass(),this.setMenuColumnClass(),this.setArrowClass(),this.setLabelClass(),this.setClearClass(),this.setInputClass(),this.initPosition()},t.prototype.initPosition=function(){this.cascaderPositon[0].offsetY=10,this.cascaderPositon[1].offsetY=10,this.cascaderPositon[2].offsetY=-10,this.cascaderPositon[3].offsetY=-10,this.positions=this.cascaderPositon},t.prototype.initOptions=function(t){var e=this,n=this.defaultValue,i=function(){e.activateOnInit(t,n[t]),t<n.length-1&&e.initOptions(t+1),t===n.length-1&&e.afterWriteValue()};if(this.isLoaded(t)||!this.thyLoadData)i();else{var o=this.activatedOptions[t-1]||{};this.loadChildren(o,t-1,i,this.afterWriteValue.bind(this))}},t.prototype.activateOnInit=function(t,e){var n,i=this.findOption(e,t);i||(i="object"==typeof e?e:((n={})[""+(this.thyValueProperty||"value")]=e,n[""+(this.thyLabelProperty||"label")]=e,n)),this.setActiveOption(i,t,!1,!1)},t.prototype.writeValue=function(t){var e=this.defaultValue=function(t){return null==t?[]:Array.isArray(t)?t:[t]}(t);e.length?this.initOptions(0):(this.value=e,this.activatedOptions=[],this.afterWriteValue())},t.prototype.afterWriteValue=function(){this.selectedOptions=this.activatedOptions,this.value=this.getSubmitValue(),this.buildDisplayLabel()},t.prototype.registerOnChange=function(t){this.onChange=t},t.prototype.registerOnTouched=function(t){this.onTouched=t},t.prototype.onPositionChange=function(t){var e="bottom"===t.connectionPair.originY?"bottom":"top";this.dropDownPosition!==e&&(this.dropDownPosition=e,this.cdr.detectChanges())},t.prototype.isLoaded=function(t){return this.thyColumns[t]&&this.thyColumns[t].length>0},t.prototype.getOptionLabel=function(t){return t[this.thyLabelProperty||"label"]},t.prototype.getOptionValue=function(t){return t[this.thyValueProperty||"value"]},t.prototype.hasInput=function(){return this.inputValue.length>0},t.prototype.hasValue=function(){return this.value&&this.value.length>0},Object.defineProperty(t.prototype,"showPlaceholder",{get:function(){return!(this.hasInput()||this.hasValue())},enumerable:!1,configurable:!0}),t.prototype.isActivedOption=function(t,e){return this.activatedOptions[e]===t},t.prototype.findOption=function(t,e){var n=this,i=this.thyColumns[e];if(i){var o="object"==typeof t?this.getOptionValue(t):t;return i.find((function(t){return o===n.getOptionValue(t)}))}return null},t.prototype.buildDisplayLabel=function(){var t=this,e=this.selectedOptions,n=e.map((function(e){return t.getOptionLabel(e)}));this.isLabelRenderTemplate?this.labelRenderContext={labels:n,selectedOptions:e}:this.labelRenderText=u.call(this,n,e)},t.prototype.isMenuVisible=function(){return this.menuVisible},t.prototype.setMenuVisible=function(t){this.menuVisible!==t&&(this.menuVisible=t,this.setClassMap(),this.setArrowClass(),this.setMenuClass())},Object.defineProperty(t.prototype,"menuCls",{get:function(){return this._menuCls},enumerable:!1,configurable:!0}),t.prototype.setMenuClass=function(){var t;this._menuCls=((t={})[this.prefixCls+"-menus"]=!0,t[this.prefixCls+"-menus-hidden"]=!this.menuVisible,t[""+this.thyMenuClassName]=this.thyMenuClassName,t)},Object.defineProperty(t.prototype,"menuColumnCls",{get:function(){return this._menuColumnCls},enumerable:!1,configurable:!0}),t.prototype.setMenuColumnClass=function(){var t;this._menuColumnCls=((t={})[this.prefixCls+"-menu"]=!0,t[""+this.thyColumnClassName]=this.thyColumnClassName,t)},Object.defineProperty(t.prototype,"arrowCls",{get:function(){return this._arrowCls},enumerable:!1,configurable:!0}),t.prototype.setArrowClass=function(){var t;this._arrowCls=((t={})[this.prefixCls+"-picker-arrow"]=!0,t[this.prefixCls+"-picker-arrow-expand"]=this.menuVisible,t)},Object.defineProperty(t.prototype,"clearCls",{get:function(){return this._clearCls},enumerable:!1,configurable:!0}),t.prototype.setClearClass=function(){var t;this._clearCls=((t={})[this.prefixCls+"-picker-clear"]=!0,t["remove-link"]=!0,t)},Object.defineProperty(t.prototype,"labelCls",{get:function(){return this._labelCls},enumerable:!1,configurable:!0}),t.prototype.setLabelClass=function(){var t;this._labelCls=((t={})[this.prefixCls+"-picker-label"]=!0,t[this.prefixCls+"-show-search"]=!1,t[this.prefixCls+"-focused"]=!1,t)},Object.defineProperty(t.prototype,"inputCls",{get:function(){return this._inputCls},enumerable:!1,configurable:!0}),t.prototype.setInputClass=function(){var t;this._inputCls=((t={})[this.prefixCls+"-input"]=!0,t)},t.prototype.setClassMap=function(){var t,e=((t={})[""+this.prefixCls]=!0,t[this.prefixCls+"-picker"]=!0,t[this.prefixCls+"-"+this.thySize]=!0,t[this.prefixCls+"-picker-disabled"]=this.disabled,t[this.prefixCls+"-picker-open"]=this.menuVisible,t);this.updateHostClassService.updateClassByMap(e)},t.prototype.isClickTriggerAction=function(){return"string"==typeof this.thyTriggerAction?"click"===this.thyTriggerAction:-1!==this.thyTriggerAction.indexOf("click")},t.prototype.isHoverTriggerAction=function(){return"string"==typeof this.thyTriggerAction?"hover"===this.thyTriggerAction:-1!==this.thyTriggerAction.indexOf("hover")},t.prototype.isHoverExpandTriggerAction=function(){return"string"==typeof this.thyExpandTriggerAction?"hover"===this.thyExpandTriggerAction:-1!==this.thyExpandTriggerAction.indexOf("hover")},t.prototype.trggleClick=function(t){this.disabled||(this.onTouched(),this.isClickTriggerAction()&&this.setMenuVisible(!this.menuVisible))},t.prototype.trggleHover=function(t){this.disabled||this.isHoverTriggerAction()&&this.setMenuVisible(!this.menuVisible)},t.prototype.onOptionClick=function(t,e,n){n&&n.preventDefault(),t&&t.disabled||this.setActiveOption(t,e,!0)},t.prototype.onOptionMouseover=function(t,e,n){n&&n.preventDefault(),t&&t.disabled||this.isHoverExpandTriggerAction()&&this.setActiveOption(t,e,!1)},t.prototype.onMenuMouseleave=function(t){t&&t.preventDefault(),this.isHoverTriggerAction()&&this.setMenuVisible(!this.menuVisible)},t.prototype.closeMenu=function(){this.setMenuVisible(!1),this.setArrowClass()},t.prototype.setActiveOption=function(t,e,n,i){if(void 0===i&&(i=!0),t&&!t.disabled){this.activatedOptions[e]=t;for(var o=e-1;o>=0;o--)this.activatedOptions[o]||(this.activatedOptions[o]=this.activatedOptions[o+1].parent);e<this.activatedOptions.length-1&&(this.activatedOptions=this.activatedOptions.slice(0,e+1)),t.children&&t.children.length?(t.isLeaf=!1,t.children.forEach((function(e){return e.parent=t})),this.setColumnData(t.children,e+1)):!t.isLeaf&&i?this.loadChildren(t,e):e<this.thyColumns.length-1&&(this.thyColumns=this.thyColumns.slice(0,e+1)),n&&this.onSelectOption(t,e)}},t.prototype.onSelectOption=function(t,e){this.thySelect.emit({option:t,index:e}),(t.isLeaf||this.thyChangeOnSelect||this.shouldPerformSelection(t,e))&&(this.selectedOptions=this.activatedOptions,this.buildDisplayLabel(),this.onValueChange()),t.isLeaf&&this.setMenuVisible(!1)},t.prototype.shouldPerformSelection=function(t,e){return"function"==typeof this.thyChangeOn&&!0===this.thyChangeOn(t,e)},t.prototype.onValueChange=function(){var t=this.getSubmitValue();p(this.value,t)||(this.defaultValue=null,this.value=t,this.onChange(t),0===t.length&&this.thyClear.emit(),this.thySelectionChange.emit(this.selectedOptions),this.thyChange.emit(t))},t.prototype.clearSelection=function(t){t&&(t.stopPropagation(),t.preventDefault()),this.labelRenderText="",this.labelRenderContext={},this.selectedOptions=[],this.activatedOptions=[],this.inputValue="",this.setMenuVisible(!1),this.onValueChange()},t.prototype.focus=function(){},t.prototype.loadChildren=function(t,e,n,i){var o=this;this.thyLoadData&&(this.isLoading=!0,this.thyLoadData(t,e).then((function(){t.loading=o.isLoading=!1,t.children&&(t.children.forEach((function(n){return n.parent=e<0?void 0:t})),o.setColumnData(t.children,e+1)),n&&n()}),(function(){t.loading=o.isLoading=!1,t.isLeaf=!0,i&&i()})))},t.prototype.setColumnData=function(t,e){p(this.thyColumns[e],t)||(this.thyColumns[e]=t,e<this.thyColumns.length-1&&(this.thyColumns=this.thyColumns.slice(0,e+1)))},t.prototype.getSubmitValue=function(){var t=this,e=[];return this.selectedOptions.forEach((function(n){e.push(t.getOptionValue(n))})),e},t}();y.decorators=[{type:e.Component,args:[{selector:"thy-cascader,[thy-cascader]",template:'<div cdkOverlayOrigin #origin="cdkOverlayOrigin" #trigger>\n  <ng-container *ngIf="thyShowInput">\n    <input\n      #input\n      thyInput\n      type="text"\n      [thySize]="thySize"\n      [ngClass]="inputCls"\n      readonly\n      [disabled]="disabled"\n      [placeholder]="showPlaceholder ? thyPlaceHolder : \'\'"\n    />\n    <span [ngClass]="arrowCls">\n      <thy-icon thyIconName="angle-down" class="font-size-base"></thy-icon>\n    </span>\n    <span [ngClass]="clearCls" *ngIf="!isLoading && labelRenderText" (click)="clearSelection($event)">\n      <thy-icon class="remove-link-icon font-size-base" thyIconName="close-circle-bold-fill"></thy-icon>\n    </span>\n    <span [ngClass]="labelCls">\n      <ng-container *ngIf="!isLabelRenderTemplate; else labelTemplate">{{ labelRenderText }}</ng-container>\n      <ng-template #labelTemplate>\n        <ng-template [ngTemplateOutlet]="thyLabelRender" [ngTemplateOutletContext]="labelRenderContext"></ng-template>\n      </ng-template>\n    </span>\n  </ng-container>\n</div>\n<ng-template\n  cdkConnectedOverlay\n  cdkConnectedOverlayHasBackdrop\n  cdkConnectedOverlayBackdropClass="thy-cascader-backdrop"\n  [cdkConnectedOverlayOrigin]="origin"\n  [cdkConnectedOverlayPositions]="positions"\n  (backdropClick)="closeMenu()"\n  (detach)="closeMenu()"\n  (positionChange)="onPositionChange($event)"\n  [cdkConnectedOverlayOpen]="menuVisible"\n>\n  <div #menu [ngClass]="menuCls" [ngStyle]="thyMenuStyle" (mouseleave)="onMenuMouseleave($event)">\n    <ul *ngFor="let options of thyColumns; let i = index" [ngClass]="menuColumnCls">\n      <li\n        thy-cascader-option\n        *ngFor="let option of options"\n        [option]="option"\n        (click)="onOptionClick(option, i, $event)"\n        (mouseover)="onOptionMouseover(option, i, $event)"\n        [thyLabelProperty]="thyLabelProperty"\n        [active]="isActivedOption(option, i)"\n      ></li>\n    </ul>\n  </div>\n</ng-template>\n',providers:[r.UpdateHostClassService,{provide:i.NG_VALUE_ACCESSOR,useExisting:e.forwardRef((function(){return y})),multi:!0}],styles:["\n            .thy-cascader-menus {\n                position: relative;\n            }\n        "]}]}],y.ctorParameters=function(){return[{type:e.ChangeDetectorRef},{type:e.ElementRef},{type:r.UpdateHostClassService}]},y.propDecorators={thyLabelRender:[{type:e.Input}],thyValueProperty:[{type:e.Input}],thyLabelProperty:[{type:e.Input}],thyPlaceHolder:[{type:e.Input}],thyLoadData:[{type:e.Input}],thyChangeOnSelect:[{type:e.Input}],thyShowInput:[{type:e.Input}],thyTriggerAction:[{type:e.Input}],thyExpandTriggerAction:[{type:e.Input}],thyMenuStyle:[{type:e.Input}],thyOptions:[{type:e.Input}],thyMenuClassName:[{type:e.Input}],thyColumnClassName:[{type:e.Input}],disabled:[{type:e.Input}],thySize:[{type:e.Input}],thyChange:[{type:e.Output}],thySelectionChange:[{type:e.Output}],thySelect:[{type:e.Output}],thyChangeOn:[{type:e.Input}],thyClear:[{type:e.Output}],input:[{type:e.ViewChild,args:["input"]}],menu:[{type:e.ViewChild,args:["menu"]}],trggleClick:[{type:e.HostListener,args:["click",["$event"]]}],trggleHover:[{type:e.HostListener,args:["mouseover",["$event"]]}]};var d=function(){function t(){this.item=!0,this.active=!1}return Object.defineProperty(t.prototype,"disabled",{get:function(){return this.option.disabled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"expand",{get:function(){return this.option&&!this.option.isLeaf},enumerable:!1,configurable:!0}),t.prototype.getOptionLabel=function(){return this.option?this.option[this.thyLabelProperty||"label"]:""},t.prototype.ngOnInit=function(){},t}();d.decorators=[{type:e.Component,args:[{changeDetection:e.ChangeDetectionStrategy.OnPush,encapsulation:e.ViewEncapsulation.None,selector:"[thy-cascader-option]",template:'<ng-container>\n    {{ getOptionLabel() }}\n</ng-container>\n<span *ngIf="!option.isLeaf || option.children && option.children.length || option.loading" class="wtf wtf-angle-right thy-cascader-menu-item-expand-icon">\n</span>',providers:[r.UpdateHostClassService]}]}],d.ctorParameters=function(){return[]},d.propDecorators={option:[{type:e.Input}],item:[{type:e.HostBinding,args:["class.thy-cascader-menu-item"]}],active:[{type:e.HostBinding,args:["class.thy-cascader-menu-item-active"]},{type:e.Input}],disabled:[{type:e.HostBinding,args:["class.thy-cascader-menu-item-disabled"]}],expand:[{type:e.HostBinding,args:["class.thy-cascader-menu-item-expand"]}],thyLabelProperty:[{type:e.Input}]};var g=function(){};g.decorators=[{type:e.NgModule,args:[{imports:[n.CommonModule,i.FormsModule,o.OverlayModule,s.ThyInputModule,l.ThyIconModule],declarations:[y,d],exports:[y]}]}],t.ThyCascaderComponent=y,t.ThyCascaderModule=g,t.ThyCascaderOptionComponent=d,t.ɵ0=c,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-tethys-cascader.umd.min.js.map
{"version":3,"file":"ngx-tethys-avatar.js","sources":["../../src/avatar/avatar.service.ts","../../src/avatar/avatar.component.ts","../../src/avatar/avatar.pipe.ts","../../src/avatar/avatar.module.ts","../../src/avatar/ngx-tethys-avatar.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\nimport { SafeHtml } from '@angular/platform-browser';\n\nexport abstract class ThyAvatarService {\n    ignoreAvatarSrcPaths = [`default.png`];\n\n    abstract avatarSrcTransform(src: string, size: number): string;\n\n    abstract nameTransform(name: string): string | SafeHtml;\n}\n\n@Injectable()\nexport class ThyDefaultAvatarService extends ThyAvatarService {\n    avatarSrcTransform(src: string, size: number): string {\n        return src;\n    }\n\n    nameTransform(name: string): string | SafeHtml {\n        return name;\n    }\n}\n","import { Component, Input, Output, EventEmitter, ElementRef, HostBinding, OnInit, ChangeDetectionStrategy } from '@angular/core';\nimport { isNumber, coerceBooleanProperty } from 'ngx-tethys/util';\nimport { UpdateHostClassService } from 'ngx-tethys/core';\nimport { ThyAvatarService } from './avatar.service';\nimport { isString } from 'ngx-tethys/util';\nimport { DomSanitizer, SafeHtml } from '@angular/platform-browser';\n\nconst sizeArray = [22, 24, 28, 32, 36, 48, 68, 110, 160];\n\nconst DEFAULT_SIZE = 36;\n\nexport const thyAvatarSizeMap = {\n    xxs: 22,\n    xs: 24,\n    sm: 32,\n    md: 36,\n    lg: 48\n};\n\n@Component({\n    selector: 'thy-avatar',\n    templateUrl: './avatar.component.html',\n    providers: [UpdateHostClassService],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ThyAvatarComponent implements OnInit {\n    _src: string;\n    _name: string;\n    _size: number;\n    _showRemove = false;\n\n    public avatarSrc: string;\n    public avatarName?: string;\n    public avatarNameSafeHtml?: SafeHtml;\n\n    @HostBinding('class.thy-avatar') _isAvatar = true;\n\n    @Output() thyOnRemove = new EventEmitter();\n\n    @Output() thyError: EventEmitter<Event> = new EventEmitter<Event>();\n\n    @Input() thyShowName: boolean;\n\n    @Input()\n    set thySrc(value: string) {\n        this._setAvatarSrc(value);\n    }\n\n    @Input()\n    set thyName(value: string) {\n        // this._name = value;\n        this._setAvatarName(value);\n    }\n\n    @Input()\n    set thySize(value: number | string) {\n        if (thyAvatarSizeMap[value]) {\n            this._setAvatarSize(thyAvatarSizeMap[value]);\n        } else {\n            this._setAvatarSize((value as number) * 1);\n        }\n    }\n\n    @Input()\n    set thyShowRemove(value: boolean) {\n        this._showRemove = coerceBooleanProperty(value);\n    }\n\n    @Input() thyImgClass: string;\n\n    @Input() thyDisabled: boolean;\n\n    private _setAvatarSize(size: number) {\n        if (sizeArray.indexOf(size) > -1) {\n            this._size = size;\n        } else {\n            this._size = this.findClosestSize(sizeArray, size);\n        }\n    }\n\n    private findClosestSize(sizes: number[], value: number): number {\n        let left = 0,\n            right = sizes.length - 1,\n            middle: number,\n            result: number;\n\n        while (left <= right) {\n            middle = Math.floor((left + right) / 2);\n            if (right - left <= 1) {\n                result = sizes[right];\n                break;\n            }\n            result = sizes[middle];\n            if (result === value) {\n                return value;\n            } else if (result > value) {\n                right = middle;\n            } else {\n                left = middle;\n            }\n        }\n        return value - sizes[left] < sizes[right] - value ? sizes[left] : sizes[right];\n    }\n\n    private _setAvatarSrc(src: string) {\n        if (src && this.thyAvatarService.ignoreAvatarSrcPaths.indexOf(src) < 0) {\n            this._src = src;\n        } else {\n            this._src = null;\n        }\n    }\n\n    private _setAvatarName(value: string) {\n        const name = this.thyAvatarService.nameTransform(value);\n        if (isString(name)) {\n            this.avatarName = name as string;\n        } else {\n            this.avatarName = value;\n            this.avatarNameSafeHtml = name;\n        }\n    }\n\n    constructor(\n        private updateHostClassService: UpdateHostClassService,\n        private elementRef: ElementRef,\n        private thyAvatarService: ThyAvatarService,\n        private domSanitizer: DomSanitizer\n    ) {\n        updateHostClassService.initializeElement(elementRef.nativeElement);\n    }\n\n    ngOnInit() {\n        if (!this._size) {\n            this._setAvatarSize(DEFAULT_SIZE);\n        }\n        this.updateHostClassService.updateClass([`thy-avatar-${this._size}`]);\n    }\n\n    remove($event: Event) {\n        this.thyOnRemove.emit($event);\n    }\n\n    avatarImgError($event: Event) {\n        this._setAvatarSrc(null);\n        this.thyError.emit($event);\n    }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { ThyAvatarService } from './avatar.service';\n\n@Pipe({ name: 'avatarShortName' })\nexport class AvatarShortNamePipe implements PipeTransform {\n    transform(name: string): string {\n        if (!name) {\n            return;\n        }\n        name = name.trim();\n        if (/^[\\u4e00-\\u9fa5]+$/.test(name)) {\n            if (name.length > 2) {\n                return name.substr(name.length - 2, 2);\n            }\n        }\n        if (/^[a-zA-Z\\/ ]+$/.test(name)) {\n            if (name.indexOf(' ') > 0) {\n                const ens: string[] = name.split(' ');\n                return (ens[0].substr(0, 1) + ens[1].substr(0, 1)).toUpperCase();\n            }\n        }\n        if (name.length > 2) {\n            return name.substr(0, 2).toUpperCase();\n        }\n        return name.toUpperCase();\n    }\n}\n\n@Pipe({ name: 'avatarBgColor' })\nexport class AvatarBgColorPipe implements PipeTransform {\n    transform(name: string) {\n        if (!name) {\n            return;\n        }\n        const colors = [\n            '#56abfb',\n            '#5dcfff',\n            '#84e17e',\n            '#73d897',\n            '#ff9f73',\n            '#fa8888',\n            '#fb7fb7',\n            '#9a7ef4',\n            '#868af6'\n        ];\n        const nameArray: string[] = name.split('');\n        const code: number =\n            name && name.length > 0\n                ? nameArray.reduce(\n                      function(result, item) {\n                          result.value += item.charCodeAt(0);\n                          return result;\n                      },\n                      { value: 0 }\n                  ).value\n                : 0;\n        return {\n            'background-color': colors[code % 9]\n        };\n    }\n}\n\n@Pipe({ name: 'thyAvatarSrc' })\nexport class AvatarSrcPipe implements PipeTransform {\n    constructor(private thyAvatarService: ThyAvatarService) {}\n    transform(src: string, size: number) {\n        return this.thyAvatarService.avatarSrcTransform(src, size);\n    }\n}\n\nexport const AvatarPipes = [AvatarShortNamePipe, AvatarBgColorPipe, AvatarSrcPipe];\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ThyAvatarComponent } from './avatar.component';\nimport { AvatarPipes } from './avatar.pipe';\nimport { ThyAvatarService, ThyDefaultAvatarService } from './avatar.service';\nimport { ThyIconModule } from 'ngx-tethys/icon';\n\n@NgModule({\n    declarations: [ThyAvatarComponent, AvatarPipes],\n    imports: [CommonModule, ThyIconModule],\n    providers: [\n        {\n            provide: ThyAvatarService,\n            useClass: ThyDefaultAvatarService\n        }\n    ],\n    exports: [ThyAvatarComponent, AvatarPipes]\n})\nexport class ThyAvatarModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"]}
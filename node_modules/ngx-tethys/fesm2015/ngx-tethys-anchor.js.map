{"version":3,"file":"ngx-tethys-anchor.js","sources":["../../src/anchor/anchor.component.ts","../../src/anchor/anchor-link.component.ts","../../src/anchor/anchor.module.ts","../../src/anchor/ngx-tethys-anchor.ts"],"names":[],"mappings":"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","sourcesContent":["import { Platform } from '@angular/cdk/platform';\nimport {\n    AfterViewInit,\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    ElementRef,\n    EventEmitter,\n    Inject,\n    Input,\n    NgZone,\n    OnChanges,\n    OnDestroy,\n    Output,\n    Renderer2,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\nimport { fromEvent, Subject } from 'rxjs';\nimport { takeUntil, throttleTime } from 'rxjs/operators';\n\nimport { ThyAnchorLinkComponent } from './anchor-link.component';\nimport { getOffset } from 'ngx-tethys/util';\nimport { ThyScrollService } from 'ngx-tethys/core';\nimport { DOCUMENT } from '@angular/common';\n\ninterface Section {\n    linkComponent: ThyAnchorLinkComponent;\n    top: number;\n}\n\nconst sharpMatcherRegx = /#([^#]+)$/;\n\n@Component({\n    selector: 'thy-anchor',\n    exportAs: 'thyAnchor',\n    preserveWhitespaces: false,\n    template: `\n        <thy-affix *ngIf=\"thyAffix; else content\" [thyOffsetTop]=\"thyOffsetTop\" [thyContainer]=\"container\">\n            <ng-template [ngTemplateOutlet]=\"content\"></ng-template>\n        </thy-affix>\n        <ng-template #content>\n            <div class=\"thy-anchor-wrapper\" [ngStyle]=\"wrapperStyle\">\n                <div class=\"thy-anchor\">\n                    <div class=\"thy-anchor-ink\">\n                        <div class=\"thy-anchor-ink-full\" #ink></div>\n                    </div>\n                    <ng-content></ng-content>\n                </div>\n            </div>\n        </ng-template>\n    `,\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ThyAnchorComponent implements OnDestroy, AfterViewInit, OnChanges {\n    @ViewChild('ink') private ink!: ElementRef;\n\n    @Input() thyAffix = true;\n\n    @Input()\n    thyBounds = 5;\n\n    @Input()\n    thyOffsetTop?: number = undefined;\n\n    @Input() thyContainer?: string | HTMLElement;\n    @Input() thyTarget: string | HTMLElement = '';\n\n    @Output() readonly thyClick = new EventEmitter<ThyAnchorLinkComponent>();\n    @Output() readonly thyScroll = new EventEmitter<ThyAnchorLinkComponent>();\n\n    visible = false;\n    wrapperStyle = { 'max-height': '100vh' };\n\n    container?: HTMLElement | Window;\n\n    private links: ThyAnchorLinkComponent[] = [];\n    private animating = false;\n    private destroy$ = new Subject();\n    private handleScrollTimeoutID = -1;\n\n    constructor(\n        @Inject(DOCUMENT) private document: any,\n        private cdr: ChangeDetectorRef,\n        private platform: Platform,\n        private zone: NgZone,\n        private renderer: Renderer2,\n        private scrollService: ThyScrollService\n    ) {}\n\n    registerLink(link: ThyAnchorLinkComponent): void {\n        this.links.push(link);\n    }\n\n    unregisterLink(link: ThyAnchorLinkComponent): void {\n        this.links.splice(this.links.indexOf(link), 1);\n    }\n\n    private getContainer(): HTMLElement | Window {\n        return this.container || window;\n    }\n\n    ngAfterViewInit(): void {\n        this.registerScrollEvent();\n    }\n\n    ngOnDestroy(): void {\n        clearTimeout(this.handleScrollTimeoutID);\n        this.destroy$.next();\n        this.destroy$.complete();\n    }\n\n    private registerScrollEvent(): void {\n        if (!this.platform.isBrowser) {\n            return;\n        }\n        this.destroy$.next();\n        this.zone.runOutsideAngular(() => {\n            fromEvent(this.getContainer(), 'scroll')\n                .pipe(throttleTime(50), takeUntil(this.destroy$))\n                .subscribe(() => this.handleScroll());\n        });\n        // Browser would maintain the scrolling position when refreshing.\n        // So we have to delay calculation in avoid of getting a incorrect result.\n        this.handleScrollTimeoutID = setTimeout(() => this.handleScroll());\n    }\n\n    handleScroll(): void {\n        if (typeof document === 'undefined' || this.animating) {\n            return;\n        }\n        const container: HTMLElement = this.container instanceof HTMLElement ? this.container : this.document;\n\n        const sections: Section[] = [];\n        const scope = (this.thyOffsetTop || 0) + this.thyBounds;\n        this.links.forEach(linkComponent => {\n            const sharpLinkMatch = sharpMatcherRegx.exec(linkComponent.thyHref.toString());\n            if (!sharpLinkMatch) {\n                return;\n            }\n            const target = container.querySelector(`#${sharpLinkMatch[1]}`) as HTMLElement;\n            if (target) {\n                const top = getOffset(target, this.getContainer()).top;\n                if (top < scope) {\n                    sections.push({\n                        top,\n                        linkComponent\n                    });\n                }\n            }\n        });\n\n        this.visible = !!sections.length;\n        if (!this.visible) {\n            this.clearActive();\n            this.cdr.detectChanges();\n        } else {\n            const maxSection = sections.reduce((prev, curr) => (curr.top > prev.top ? curr : prev));\n            this.handleActive(maxSection.linkComponent);\n        }\n        this.setVisible();\n    }\n\n    private clearActive(): void {\n        this.links.forEach(i => {\n            i.unsetActive();\n        });\n    }\n\n    private handleActive(linkComponent: ThyAnchorLinkComponent): void {\n        this.clearActive();\n        linkComponent.setActive();\n        const linkNode = linkComponent.getLinkTitleElement();\n\n        this.ink.nativeElement.style.top = `${linkNode.offsetTop}px`;\n        this.ink.nativeElement.style.height = `${linkNode.clientHeight}px`;\n        this.visible = true;\n        this.setVisible();\n        this.thyScroll.emit(linkComponent);\n    }\n\n    private setVisible(): void {\n        const visible = this.visible;\n        const visibleClassname = 'visible';\n        if (this.ink) {\n            if (visible) {\n                this.renderer.addClass(this.ink.nativeElement, visibleClassname);\n            } else {\n                this.renderer.removeClass(this.ink.nativeElement, visibleClassname);\n            }\n        }\n    }\n\n    handleScrollTo(linkComponent: ThyAnchorLinkComponent): void {\n        const container: HTMLElement = this.container instanceof HTMLElement ? this.container : this.document;\n        const linkElement: HTMLElement = container.querySelector(linkComponent.thyHref);\n        if (!linkElement) {\n            return;\n        }\n\n        this.animating = true;\n        const containerScrollTop = this.scrollService.getScroll(this.getContainer());\n        const elementOffsetTop = getOffset(linkElement, this.getContainer()).top;\n        const targetScrollTop = containerScrollTop + elementOffsetTop - (this.thyOffsetTop || 0);\n        this.scrollService.scrollTo(this.getContainer(), targetScrollTop, undefined, () => {\n            this.animating = false;\n        });\n        this.handleActive(linkComponent);\n        this.thyClick.emit(linkComponent);\n    }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        const { thyOffsetTop, thyContainer } = changes;\n        if (thyOffsetTop) {\n            this.wrapperStyle = {\n                'max-height': `calc(100vh - ${this.thyOffsetTop}px)`\n            };\n        }\n        if (thyContainer && this.thyContainer) {\n            const container = this.thyContainer || this.thyTarget;\n            this.container = typeof container === 'string' ? this.document.querySelector(container) : container;\n            this.registerScrollEvent();\n        }\n    }\n}\n","import { Platform } from '@angular/cdk/platform';\nimport {\n    ChangeDetectionStrategy,\n    Component,\n    ContentChild,\n    ElementRef,\n    Input,\n    OnDestroy,\n    OnInit,\n    Renderer2,\n    TemplateRef,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\n\nimport { ThyAnchorComponent } from './anchor.component';\n\n@Component({\n    selector: 'thy-link',\n    exportAs: 'thyLink',\n    preserveWhitespaces: false,\n    template: `\n        <a #linkTitle (click)=\"goToClick($event)\" href=\"{{ thyHref }}\" class=\"thy-anchor-link-title\" title=\"{{ title }}\">\n            <span *ngIf=\"title; else titleTemplate || thyTemplate\">{{ title }}</span>\n        </a>\n        <ng-content></ng-content>\n    `,\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class ThyAnchorLinkComponent implements OnInit, OnDestroy {\n    @Input() thyHref = '#';\n\n    title: string | null = '';\n    titleTemplate?: TemplateRef<any>;\n\n    @Input()\n    set thyTitle(value: string | TemplateRef<void>) {\n        if (value instanceof TemplateRef) {\n            this.title = null;\n            this.titleTemplate = value;\n        } else {\n            this.title = value;\n        }\n    }\n\n    @ContentChild('thyTemplate') thyTemplate!: TemplateRef<void>;\n    @ViewChild('linkTitle', { static: true }) linkTitle!: ElementRef<HTMLAnchorElement>;\n\n    constructor(\n        public elementRef: ElementRef,\n        private anchorComponent: ThyAnchorComponent,\n        private platform: Platform,\n        private renderer: Renderer2\n    ) {\n        this.renderer.addClass(elementRef.nativeElement, 'thy-anchor-link');\n    }\n\n    ngOnInit(): void {\n        this.anchorComponent.registerLink(this);\n    }\n\n    getLinkTitleElement(): HTMLAnchorElement {\n        return this.linkTitle.nativeElement;\n    }\n\n    setActive(): void {\n        this.renderer.addClass(this.elementRef.nativeElement, 'thy-anchor-link-active');\n    }\n\n    unsetActive(): void {\n        this.renderer.removeClass(this.elementRef.nativeElement, 'thy-anchor-link-active');\n    }\n\n    goToClick(e: Event): void {\n        e.preventDefault();\n        e.stopPropagation();\n        if (this.platform.isBrowser) {\n            this.anchorComponent.handleScrollTo(this);\n        }\n    }\n\n    ngOnDestroy(): void {\n        this.anchorComponent.unregisterLink(this);\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { PlatformModule } from '@angular/cdk/platform';\nimport { ThyAnchorComponent } from './anchor.component';\nimport { ThyAnchorLinkComponent } from './anchor-link.component';\nimport { ThyAffixModule } from 'ngx-tethys/affix';\n\n@NgModule({\n    declarations: [ThyAnchorComponent, ThyAnchorLinkComponent],\n    exports: [ThyAnchorComponent, ThyAnchorLinkComponent],\n    imports: [CommonModule, PlatformModule, ThyAffixModule]\n})\nexport class ThyAnchorModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"]}
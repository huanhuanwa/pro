{"version":3,"file":"ngx-tethys-affix.js","sources":["../../src/affix/respond-events.ts","../../src/affix/affix.component.ts","../../src/affix/affix.module.ts","../../src/affix/ngx-tethys-affix.ts"],"names":[],"mappings":"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","sourcesContent":["export enum AffixRespondEvents {\n    resize = 'resize',\n    scroll = 'scroll',\n    touchstart = 'touchstart',\n    touchmove = 'touchmove',\n    touchend = 'touchend',\n    pageshow = 'pageshow',\n    load = 'LOAD'\n}\n","import { Platform } from '@angular/cdk/platform';\nimport { DOCUMENT } from '@angular/common';\nimport {\n    AfterViewInit,\n    ChangeDetectionStrategy,\n    Component,\n    ElementRef,\n    EventEmitter,\n    Inject,\n    Input,\n    NgZone,\n    OnChanges,\n    OnDestroy,\n    Output,\n    Renderer2,\n    SimpleChanges,\n    ViewChild,\n    ViewEncapsulation\n} from '@angular/core';\n\nimport { fromEvent, merge, ReplaySubject, Subject, Subscription } from 'rxjs';\nimport { auditTime, map, takeUntil } from 'rxjs/operators';\n\nimport { AffixRespondEvents } from './respond-events';\nimport { ThyScrollService } from 'ngx-tethys/core';\nimport { dom, shallowEqual, SimpleRect } from 'ngx-tethys/util';\nconst THY_AFFIX_CLS_PREFIX = 'thy-affix';\nconst THY_AFFIX_DEFAULT_SCROLL_TIME = 20;\n\n@Component({\n    selector: 'thy-affix',\n    exportAs: 'thyAffix',\n    template: `\n        <div #fixedElement>\n            <ng-content></ng-content>\n        </div>\n    `,\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    encapsulation: ViewEncapsulation.None\n})\nexport class ThyAffixComponent implements AfterViewInit, OnChanges, OnDestroy {\n    @ViewChild('fixedElement', { static: true }) private fixedElement!: ElementRef<HTMLDivElement>;\n\n    @Input() thyContainer?: string | Element | Window;\n\n    @Input()\n    thyOffsetTop?: null | number;\n\n    @Input()\n    thyOffsetBottom?: null | number;\n\n    @Output() readonly thyChange = new EventEmitter<boolean>();\n\n    private readonly placeholderNode: HTMLElement;\n\n    private affixStyle?: any;\n    private placeholderStyle?: any;\n    private positionChangeSubscription: Subscription = Subscription.EMPTY;\n    private offsetChanged$ = new ReplaySubject(1);\n    private destroy$ = new Subject<void>();\n    private timeout?: number;\n    private document: any;\n\n    private get container(): Element | Window {\n        const el = this.thyContainer;\n        return (typeof el === 'string' ? this.document.querySelector(el) : el) || window;\n    }\n\n    constructor(\n        el: ElementRef,\n        @Inject(DOCUMENT) document: any,\n        private scrollService: ThyScrollService,\n        private ngZone: NgZone,\n        private platform: Platform,\n        private renderer: Renderer2\n    ) {\n        // The wrapper would stay at the original position as a placeholder.\n        this.placeholderNode = el.nativeElement;\n        this.document = document;\n    }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        const { thyOffsetBottom, thyOffsetTop, thyContainer } = changes;\n\n        if (thyOffsetBottom || thyOffsetTop) {\n            this.offsetChanged$.next();\n        }\n        if (thyContainer) {\n            this.registerListeners();\n        }\n    }\n\n    ngAfterViewInit(): void {\n        this.registerListeners();\n    }\n\n    ngOnDestroy(): void {\n        this.removeListeners();\n    }\n\n    private registerListeners(): void {\n        this.removeListeners();\n        this.positionChangeSubscription = this.ngZone.runOutsideAngular(() => {\n            return merge(\n                ...Object.keys(AffixRespondEvents).map(evName => fromEvent(this.container, evName)),\n                this.offsetChanged$.pipe(\n                    takeUntil(this.destroy$),\n                    map(() => ({}))\n                )\n            )\n                .pipe(auditTime(THY_AFFIX_DEFAULT_SCROLL_TIME))\n                .subscribe(e => this.updatePosition(e as Event));\n        });\n        this.timeout = setTimeout(() => this.updatePosition({} as Event));\n    }\n\n    private removeListeners(): void {\n        clearTimeout(this.timeout);\n        this.positionChangeSubscription.unsubscribe();\n        this.destroy$.next();\n        this.destroy$.complete();\n    }\n\n    getOffset(element: Element, target: Element | Window | undefined): SimpleRect {\n        const elemRect = element.getBoundingClientRect();\n        const containerRect = dom.getContainerRect(target);\n\n        const scrollTop = this.scrollService.getScroll(target, true);\n        const scrollLeft = this.scrollService.getScroll(target, false);\n\n        const docElem = this.document.body;\n        const clientTop = docElem.clientTop || 0;\n        const clientLeft = docElem.clientLeft || 0;\n\n        return {\n            top: elemRect.top - containerRect.top + scrollTop - clientTop,\n            left: elemRect.left - containerRect.left + scrollLeft - clientLeft,\n            width: elemRect.width,\n            height: elemRect.height\n        };\n    }\n\n    private setAffixStyle(e: Event, affixStyle?: any): void {\n        const originalAffixStyle = this.affixStyle;\n        const isWindow = this.container === window;\n        if (e.type === 'scroll' && originalAffixStyle && affixStyle && isWindow) {\n            return;\n        }\n        if (shallowEqual(originalAffixStyle, affixStyle)) {\n            return;\n        }\n\n        const fixed = !!affixStyle;\n        const wrapElement = this.fixedElement.nativeElement;\n        this.renderer.setStyle(wrapElement, 'cssText', dom.getStyleAsText(affixStyle));\n        this.affixStyle = affixStyle;\n        if (fixed) {\n            wrapElement.classList.add(THY_AFFIX_CLS_PREFIX);\n        } else {\n            wrapElement.classList.remove(THY_AFFIX_CLS_PREFIX);\n        }\n\n        if ((affixStyle && !originalAffixStyle) || (!affixStyle && originalAffixStyle)) {\n            this.thyChange.emit(fixed);\n        }\n    }\n\n    private setPlaceholderStyle(placeholderStyle?: any): void {\n        const originalPlaceholderStyle = this.placeholderStyle;\n        if (shallowEqual(placeholderStyle, originalPlaceholderStyle)) {\n            return;\n        }\n        this.renderer.setStyle(this.placeholderNode, 'cssText', dom.getStyleAsText(placeholderStyle));\n        this.placeholderStyle = placeholderStyle;\n    }\n\n    private syncPlaceholderStyle(e: Event): void {\n        if (!this.affixStyle) {\n            return;\n        }\n        this.renderer.setStyle(this.placeholderNode, 'cssText', '');\n        this.placeholderStyle = undefined;\n        const styleObj = {\n            width: this.placeholderNode.offsetWidth,\n            height: this.fixedElement.nativeElement.offsetHeight\n        };\n        this.setAffixStyle(e, {\n            ...this.affixStyle,\n            ...styleObj\n        });\n        this.setPlaceholderStyle(styleObj);\n    }\n\n    updatePosition(e: Event): void {\n        if (!this.platform.isBrowser) {\n            return;\n        }\n\n        const containerNode = this.container;\n        let offsetTop = this.thyOffsetTop;\n        const scrollTop = this.scrollService.getScroll(containerNode, true);\n        const elementOffset = this.getOffset(this.placeholderNode, containerNode);\n        const fixedNode = this.fixedElement.nativeElement;\n        const elemSize = {\n            width: fixedNode.offsetWidth,\n            height: fixedNode.offsetHeight\n        };\n        const offsetMode = {\n            top: false,\n            bottom: false\n        };\n        // Default to `offsetTop=0`.\n        if (typeof offsetTop !== 'number' && typeof this.thyOffsetBottom !== 'number') {\n            offsetMode.top = true;\n            offsetTop = 0;\n        } else {\n            offsetMode.top = typeof offsetTop === 'number';\n            offsetMode.bottom = typeof this.thyOffsetBottom === 'number';\n        }\n        const containerRect = dom.getContainerRect(containerNode as Window);\n        const targetInnerHeight = (containerNode as Window).innerHeight || (containerNode as HTMLElement).clientHeight;\n        if (scrollTop >= elementOffset.top - (offsetTop as number) && offsetMode.top) {\n            const width = elementOffset.width;\n            const top = containerRect.top + (offsetTop as number);\n            this.setAffixStyle(e, {\n                position: 'fixed',\n                top,\n                left: containerRect.left + elementOffset.left,\n                width\n            });\n            this.setPlaceholderStyle({\n                width,\n                height: elemSize.height\n            });\n        } else if (\n            scrollTop <= elementOffset.top + elemSize.height + (this.thyOffsetBottom as number) - targetInnerHeight &&\n            offsetMode.bottom\n        ) {\n            const targetBottomOffset = containerNode === window ? 0 : window.innerHeight - containerRect.bottom;\n            const width = elementOffset.width;\n            this.setAffixStyle(e, {\n                position: 'fixed',\n                bottom: targetBottomOffset + (this.thyOffsetBottom as number),\n                left: containerRect.left + elementOffset.left,\n                width\n            });\n            this.setPlaceholderStyle({\n                width,\n                height: elementOffset.height\n            });\n        } else {\n            if (\n                e.type === AffixRespondEvents.resize &&\n                this.affixStyle &&\n                this.affixStyle.position === 'fixed' &&\n                this.placeholderNode.offsetWidth\n            ) {\n                this.setAffixStyle(e, {\n                    ...this.affixStyle,\n                    width: this.placeholderNode.offsetWidth\n                });\n            } else {\n                this.setAffixStyle(e);\n            }\n            this.setPlaceholderStyle();\n        }\n\n        if (e.type === 'resize') {\n            this.syncPlaceholderStyle(e);\n        }\n    }\n}\n","import { PlatformModule } from '@angular/cdk/platform';\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\n\nimport { ThyAffixComponent } from './affix.component';\n\n@NgModule({\n    declarations: [ThyAffixComponent],\n    exports: [ThyAffixComponent],\n    imports: [CommonModule, PlatformModule]\n})\nexport class ThyAffixModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"]}
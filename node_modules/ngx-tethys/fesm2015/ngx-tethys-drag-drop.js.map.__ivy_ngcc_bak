{"version":3,"file":"ngx-tethys-drag-drop.js","sources":["../../src/drag-drop/drag-drop.class.ts","../../src/drag-drop/drag-ref.ts","../../src/drag-drop/drag-drop.service.ts","../../src/drag-drop/drop-container.class.ts","../../src/drag-drop/drag.directive.ts","../../src/drag-drop/drag-handle.directive.ts","../../src/drag-drop/drag-content.directive.ts","../../src/drag-drop/drop-container.directive.ts","../../src/drag-drop/module.ts","../../src/drag-drop/ngx-tethys-drag-drop.ts"],"sourcesContent":["export enum ThyDropPosition {\n    in = 'in',\n    before = 'before',\n    after = 'after'\n}\n\nexport interface ThyDragStartEvent<T = any> {\n    event?: DragEvent;\n    item?: T;\n    containerItems?: T[];\n    currentIndex: number;\n}\n\nexport interface ThyDragEndEvent<T = any> {\n    event?: DragEvent;\n    item?: T;\n    containerItems?: T[];\n}\n\nexport interface ThyDragOverEvent<T = any> {\n    event?: DragEvent;\n    item?: T;\n    containerItems?: T[];\n    currentIndex: number;\n    position?: ThyDropPosition;\n    previousItem?: T;\n    previousIndex?: number;\n    previousContainerItems?: T[];\n}\n\nexport interface ThyDragDropEvent<T = any> {\n    event?: DragEvent;\n    item?: T;\n    containerItems?: T[];\n    currentIndex: number;\n    position?: ThyDropPosition;\n    previousItem?: T;\n    previousIndex?: number;\n    previousContainerItems?: T[];\n}\n","import { NgZone, ElementRef } from '@angular/core';\nimport { coerceElement } from '@angular/cdk/coercion';\nimport { Subject, fromEvent } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { ThyDragHandleDirective } from './drag-handle.directive';\nimport { ThyDragDropService } from './drag-drop.service';\nimport { ThyDragStartEvent, ThyDragEndEvent, ThyDragOverEvent, ThyDragDropEvent, ThyDropPosition } from './drag-drop.class';\nimport { ThyDragDirective } from './drag.directive';\nimport { IThyDropContainerDirective } from './drop-container.class';\nimport { coerceArray } from 'ngx-tethys/util';\n\nconst dropPositionClass = {\n    [ThyDropPosition.in]: 'thy-drop-position-in',\n    [ThyDropPosition.before]: 'thy-drop-position-before',\n    [ThyDropPosition.after]: 'thy-drop-position-after'\n};\n\nexport class DragRef<T = any> {\n    private rootElement: HTMLElement;\n\n    private contentElement: HTMLElement;\n\n    private target: HTMLElement;\n\n    private handles: ThyDragHandleDirective[];\n\n    private ngUnsubscribe$ = new Subject();\n\n    started = new Subject<ThyDragStartEvent>();\n\n    ended = new Subject<ThyDragEndEvent>();\n\n    overed = new Subject<ThyDragOverEvent>();\n\n    dropped = new Subject<ThyDragDropEvent>();\n\n    entered = new Subject<DragEvent>();\n\n    leaved = new Subject<DragEvent>();\n\n    private _disabled = false;\n\n    get disabled(): boolean {\n        return (this.container && this.container.disabled) || this._disabled;\n    }\n    set disabled(value: boolean) {\n        this._disabled = value;\n    }\n\n    constructor(\n        element: ElementRef<HTMLElement> | HTMLElement,\n        private drag: ThyDragDirective,\n        private container: IThyDropContainerDirective<T>,\n        private dragDropService: ThyDragDropService<T>,\n        private document: any,\n        private ngZone: NgZone\n    ) {\n        this.withRootElement(element);\n    }\n\n    withRootElement(rootElement: ElementRef<HTMLElement> | HTMLElement): this {\n        const element = coerceElement(rootElement);\n        this.rootElement = element;\n        this.registerDragDropEvents();\n        return this;\n    }\n\n    withContentElement(contentElement: ElementRef<HTMLElement> | HTMLElement): this {\n        this.contentElement = coerceElement(contentElement);\n        return this;\n    }\n\n    withHandles(handleOrHandles: ThyDragHandleDirective | ThyDragHandleDirective[]): this {\n        this.handles = coerceArray(handleOrHandles);\n        return this;\n    }\n\n    private registerDragDropEvents() {\n        const events = {\n            dragstart: this.dragStart,\n            dragover: this.dragOver,\n            dragend: this.dragEnd,\n            drop: this.dragDrop,\n            dragleave: this.dragLeave,\n            dragenter: (event: DragEvent) => {\n                this.entered.next(event);\n            },\n            mouseover: (event: MouseEvent) => {\n                this.target = event.target as HTMLElement;\n            }\n        };\n        this.ngZone.runOutsideAngular(() => {\n            for (const name in events) {\n                if (events.hasOwnProperty(name)) {\n                    fromEvent(this.rootElement, name)\n                        .pipe(takeUntil(this.ngUnsubscribe$))\n                        .subscribe(events[name].bind(this));\n                }\n            }\n        });\n    }\n\n    private dragStart(event: DragEvent) {\n        event.stopPropagation();\n        const dragStartEvent: ThyDragStartEvent = {\n            event: event,\n            item: this.drag.data,\n            containerItems: this.container.data,\n            currentIndex: this.container.data.indexOf(this.drag.data)\n        };\n        if (this.disabled || !this.isTriggerHandle() || (this.container.beforeStart && !this.container.beforeStart(dragStartEvent))) {\n            event.preventDefault();\n            return false;\n        }\n        this.dragDropService.previousDrag = this.drag;\n        this.ngZone.run(() => {\n            this.started.next(dragStartEvent);\n        });\n    }\n\n    private isTriggerHandle() {\n        if (this.handles && this.handles.length > 0) {\n            const targetHandle = this.handles.find(handle => {\n                return (\n                    !handle.disabled && (handle.element.nativeElement === this.target || handle.element.nativeElement.contains(this.target))\n                );\n            });\n            return !!targetHandle;\n        } else {\n            return true;\n        }\n    }\n\n    private getPreviousEventData() {\n        const previousItem = this.dragDropService.previousDrag.data;\n        const previousContainerItems = this.dragDropService.previousDrag.container.data;\n        return {\n            previousItem: previousItem,\n            previousContainerItems: this.dragDropService.previousDrag.container.data,\n            previousIndex: previousContainerItems.indexOf(previousItem)\n        };\n    }\n\n    private isContinueDragOver(event: ThyDragOverEvent, container: IThyDropContainerDirective<T>) {\n        if (event.item === event.previousItem && event.position === ThyDropPosition.in) {\n            return false;\n        }\n        if (container && container.beforeOver) {\n            return container.beforeOver(event);\n        }\n        return true;\n    }\n\n    private dragOver(event: DragEvent) {\n        event.stopPropagation();\n        event.preventDefault();\n\n        const dropPosition = this.calcDropPosition(event);\n        const dragOverEvent: ThyDragOverEvent<T> = {\n            event: event,\n            item: this.drag.data,\n            containerItems: this.drag.container.data,\n            currentIndex: this.container.data.indexOf(this.drag.data),\n            position: dropPosition,\n            ...this.getPreviousEventData()\n        };\n\n        if (this.isContinueDragOver(dragOverEvent, this.container)) {\n            this.dragOverHandler(dropPosition);\n            this.overed.next(dragOverEvent);\n        }\n    }\n\n    private dragOverHandler(position: ThyDropPosition) {\n        const element = this.contentElement || this.rootElement;\n        if (this.dragDropService.dropPosition !== position) {\n            this.clearDragPositionClass();\n        }\n        element.classList.add(dropPositionClass[position]);\n        this.dragDropService.dropPosition = position;\n    }\n\n    private dragDrop(event: DragEvent) {\n        event.stopPropagation();\n        this.clearDragPositionClass();\n        const dragDropEvent: ThyDragDropEvent<T> = {\n            event: event,\n            item: this.drag.data,\n            containerItems: this.drag.container.data,\n            currentIndex: this.container.data.indexOf(this.drag.data),\n            position: this.calcDropPosition(event),\n            ...this.getPreviousEventData()\n        };\n        if (this.dragDropService.previousDrag === this.drag || (this.container.beforeDrop && !this.container.beforeDrop(dragDropEvent))) {\n            event.preventDefault();\n            return;\n        }\n        this.ngZone.run(() => {\n            this.dropped.next(dragDropEvent);\n        });\n    }\n\n    private dragEnd(event: DragEvent) {\n        this.ngZone.run(() => {\n            this.ended.next({\n                event: event,\n                item: this.drag.data,\n                containerItems: this.container.data\n            });\n        });\n    }\n\n    private dragLeave(event: DragEvent) {\n        event.stopPropagation();\n        this.clearDragPositionClass();\n        this.leaved.next(event);\n    }\n\n    private clearDragPositionClass(): void {\n        const element = this.contentElement || this.rootElement;\n        for (const key in dropPositionClass) {\n            if (dropPositionClass[key]) {\n                element.classList.remove(dropPositionClass[key]);\n            }\n        }\n    }\n\n    private calcDropPosition(event: DragEvent): ThyDropPosition {\n        const sideRange = 0.25;\n        const minGap = 2;\n        const { clientY } = event;\n        const { top, bottom, height } = event.srcElement\n            ? (event.srcElement as Element).getBoundingClientRect()\n            : (event.target as Element).getBoundingClientRect();\n        const des = Math.max(height * sideRange, minGap);\n        if (clientY <= top + des) {\n            return ThyDropPosition.before;\n        } else if (clientY >= bottom - des) {\n            return ThyDropPosition.after;\n        }\n        return ThyDropPosition.in;\n    }\n\n    dispose() {\n        this.ngUnsubscribe$.complete();\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { ThyDragDirective } from './drag.directive';\nimport { ThyDropPosition } from './drag-drop.class';\n\n@Injectable({ providedIn: 'root' })\nexport class ThyDragDropService<T = any> {\n    public previousDrag: ThyDragDirective<T>;\n    public dropPosition: ThyDropPosition;\n    constructor() {}\n}\n","import { EventEmitter, QueryList, InjectionToken } from '@angular/core';\nimport { ThyDragDirective } from './drag.directive';\nimport { ThyDragDropEvent, ThyDragStartEvent, ThyDragEndEvent, ThyDragOverEvent } from './drag-drop.class';\n\nexport interface IThyDropContainerDirective<T = any> {\n    started: EventEmitter<ThyDragStartEvent<T>>;\n\n    ended: EventEmitter<ThyDragEndEvent<T>>;\n\n    overed: EventEmitter<ThyDragOverEvent<T>>;\n\n    dropped: EventEmitter<ThyDragDropEvent<T>>;\n\n    beforeStart: (e: ThyDragStartEvent<T>) => boolean;\n\n    beforeOver: (e: ThyDragOverEvent<T>) => boolean;\n\n    beforeDrop: (e: ThyDragDropEvent<T>) => boolean;\n\n    data: T[];\n\n    disabled: boolean;\n\n    draggables: QueryList<ThyDragDirective>;\n}\n\n/**\n * Injection token used to provide the container directive to drag.\n */\nexport const THY_DROP_CONTAINER_DIRECTIVE = new InjectionToken<IThyDropContainerDirective>(\n    'THY_DROP_CONTAINER_DIRECTIVE'\n);\n","import {\n    Directive,\n    NgZone,\n    ElementRef,\n    HostBinding,\n    Input,\n    Inject,\n    ContentChildren,\n    OnDestroy,\n    Optional,\n    AfterContentInit\n} from '@angular/core';\nimport { DragRef } from './drag-ref';\nimport { DOCUMENT } from '@angular/common';\nimport { ThyDragHandleDirective } from './drag-handle.directive';\nimport { ThyDragDropService } from './drag-drop.service';\nimport { mixinUnsubscribe, MixinBase, Constructor, ThyUnsubscribe } from 'ngx-tethys/core';\nimport { THY_DROP_CONTAINER_DIRECTIVE, IThyDropContainerDirective } from './drop-container.class';\n\nconst _MixinBase: Constructor<ThyUnsubscribe> & typeof MixinBase = mixinUnsubscribe(MixinBase);\n\n@Directive({ selector: 'thy-drag,[thyDrag]' })\nexport class ThyDragDirective<T = any> extends _MixinBase implements OnDestroy {\n    @Input('thyDrag')\n    set dragData(data: T) {\n        this.data = data;\n    }\n\n    @Input('thyDragData') data: T;\n\n    @HostBinding('attr.draggable') isDraggable = true;\n\n    private _disabled = false;\n    @Input('thyDragDisabled') set disabled(isDisabled: boolean) {\n        this._disabled = isDisabled;\n        if (isDisabled) {\n            this.isDraggable = false;\n        }\n    }\n    get disabled() {\n        return this._disabled;\n    }\n\n    public dragRef: DragRef<T>;\n\n    constructor(\n        @Inject(DOCUMENT) document: any,\n        @Optional() @Inject(THY_DROP_CONTAINER_DIRECTIVE) public container: IThyDropContainerDirective,\n        ngZone: NgZone,\n        private elementRef: ElementRef<HTMLElement>,\n        service: ThyDragDropService<T>\n    ) {\n        super();\n        this.dragRef = new DragRef<T>(elementRef, this, container, service, document, ngZone);\n    }\n\n    ngOnDestroy() {\n        super.ngOnDestroy();\n        this.dragRef.dispose();\n    }\n}\n","import { Directive, ElementRef, Input, Optional } from '@angular/core';\nimport { coerceBooleanProperty } from '@angular/cdk/coercion';\nimport { ThyDragDirective } from './drag.directive';\n\n@Directive({\n    selector: 'thy-drag-handle,[thyDragHandle]'\n})\nexport class ThyDragHandleDirective {\n    private _disabled = false;\n\n    @Input('thyDisabled')\n    get disabled(): boolean {\n        return this._disabled;\n    }\n    set disabled(value: boolean) {\n        this._disabled = coerceBooleanProperty(value);\n    }\n\n    constructor(public element: ElementRef<HTMLElement>, @Optional() drag: ThyDragDirective) {\n        if (drag) {\n            drag.dragRef.withHandles(this);\n        }\n    }\n}\n","import { Directive, ElementRef, Input, HostBinding, Optional } from '@angular/core';\nimport { ThyDragDirective } from './drag.directive';\n\n@Directive({\n    selector: 'thy-drag-content,[thyDragContent]'\n})\nexport class ThyDragContentDirective {\n    @HostBinding('class.thy-drag-content') contentClass = true;\n\n    constructor(public element: ElementRef<HTMLElement>, @Optional() drag: ThyDragDirective) {\n        if (drag) {\n            drag.dragRef.withContentElement(this.element);\n        }\n    }\n}\n","import { OnInit, Directive, Output, EventEmitter, ContentChildren, QueryList, AfterContentInit, NgZone, Input } from '@angular/core';\nimport { ThyDragDirective } from './drag.directive';\nimport { merge, Observable, defer } from 'rxjs';\nimport { mixinUnsubscribe, MixinBase, Constructor, ThyUnsubscribe } from 'ngx-tethys/core';\nimport { takeUntil, startWith, take, switchMap } from 'rxjs/operators';\nimport { ThyDragDropEvent, ThyDragStartEvent, ThyDragEndEvent, ThyDragOverEvent } from './drag-drop.class';\nimport { THY_DROP_CONTAINER_DIRECTIVE, IThyDropContainerDirective } from './drop-container.class';\n\nconst _MixinBase: Constructor<ThyUnsubscribe> & typeof MixinBase = mixinUnsubscribe(MixinBase);\n\n@Directive({\n    selector: 'thy-drop-container,[thyDropContainer]',\n    providers: [\n        {\n            provide: THY_DROP_CONTAINER_DIRECTIVE,\n            useExisting: ThyDropContainerDirective\n        }\n    ]\n})\nexport class ThyDropContainerDirective<T = any> extends _MixinBase implements OnInit, AfterContentInit, IThyDropContainerDirective {\n    @Input('thyDropContainer')\n    set dragContainer(data: T[]) {\n        this.data = data;\n    }\n\n    @Input('thyDropContainerData') data: T[];\n\n    @Input('thyDropContainerDisabled') disabled: boolean;\n\n    @Input('thyBeforeDragStart') beforeStart: (e: ThyDragStartEvent<T>) => boolean;\n\n    @Input('thyBeforeDragOver') beforeOver: (e: ThyDragOverEvent<T>) => boolean;\n\n    @Input('thyBeforeDragDrop') beforeDrop: (e: ThyDragDropEvent<T>) => boolean;\n\n    @Output('thyDragStarted') started = new EventEmitter<ThyDragStartEvent<ThyDragDirective>>();\n\n    @Output('thyDragEnded') ended = new EventEmitter<ThyDragEndEvent<ThyDragDirective>>();\n\n    @Output('thyDragOvered') overed = new EventEmitter<ThyDragOverEvent<ThyDragDirective>>();\n\n    @Output('thyDragDropped') dropped = new EventEmitter<ThyDragDropEvent<ThyDragDirective>>();\n\n    @ContentChildren(ThyDragDirective, {\n        descendants: false\n    })\n    draggables: QueryList<ThyDragDirective>;\n\n    constructor(private ngZone: NgZone) {\n        super();\n    }\n\n    ngOnInit() {}\n\n    ngAfterContentInit() {\n        this.draggables.changes.pipe(startWith(null), takeUntil(this.ngUnsubscribe$)).subscribe(() => {\n            this.draggableChanges();\n        });\n    }\n\n    private draggableChanges() {\n        this.resetDraggableChanges(item => item.dragRef.started).subscribe(event => {\n            this.started.emit(event);\n        });\n        this.resetDraggableChanges(item => item.dragRef.ended).subscribe(event => {\n            this.ended.emit(event);\n        });\n        this.resetDraggableChanges(item => item.dragRef.overed).subscribe(event => {\n            this.overed.emit(event);\n        });\n        this.resetDraggableChanges(item => item.dragRef.dropped).subscribe(event => {\n            this.dropped.emit(event);\n        });\n    }\n\n    private resetDraggableChanges(fn: (item: ThyDragDirective) => Observable<any>) {\n        return defer(() => {\n            if (this.draggables) {\n                return merge(...this.draggables.map(fn));\n            }\n            return this.ngZone.onStable.asObservable().pipe(\n                take(1),\n                switchMap(() => this.resetDraggableChanges.bind(this, fn))\n            );\n        }).pipe(takeUntil(merge(this.ngUnsubscribe$, this.draggables.changes))) as Observable<any>;\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { ThyDragDirective } from './drag.directive';\nimport { ThyDragHandleDirective } from './drag-handle.directive';\nimport { ThyDragContentDirective } from './drag-content.directive';\nimport { ThyDropContainerDirective } from './drop-container.directive';\n\n@NgModule({\n    imports: [],\n    exports: [ThyDropContainerDirective, ThyDragDirective, ThyDragHandleDirective, ThyDragContentDirective],\n    declarations: [ThyDropContainerDirective, ThyDragDirective, ThyDragHandleDirective, ThyDragContentDirective],\n    providers: []\n})\nexport class ThyDragDropModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":["_MixinBase"],"mappings":"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"}
import { EventEmitter, Component, forwardRef, ViewChild, Input, Output, NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { helpers } from 'ngx-tethys/util';

class ThySwitchComponent {
    constructor() {
        this.type = 'primary';
        this.size = '';
        this.disabled = false;
        this.typeArray = ['primary', 'info', 'warning', 'danger'];
        this.sizeArray = ['lg', '', 'sm'];
        this.initialized = false;
        this.thyChange = new EventEmitter();
        this.onModelChange = () => { };
        this.onModelTouched = () => { };
    }
    set thyType(value) {
        if (!this.typeArray.includes(value)) {
            value = 'primary';
        }
        this.type = value;
        if (this.initialized) {
            this.setClassNames();
        }
    }
    set thySize(value) {
        if (!this.sizeArray.includes(value)) {
            value = '';
        }
        this.size = value;
        if (this.initialized) {
            this.setClassNames();
        }
    }
    ngOnInit() {
        this.setClassNames();
        this.initialized = true;
    }
    ngOnChanges(changes) {
        // 兼容降级后的Switch，使用onChanges
        if (changes.thyDisabled) {
            const value = changes.thyDisabled.currentValue;
            this.disabled = helpers.isBoolean(value) ? Boolean(value) : value === 'true' || value === '1';
            this.setClassNames();
        }
    }
    writeValue(value) {
        this.model = value;
        // this.setClassNames();
    }
    registerOnChange(fn) {
        this.onModelChange = fn;
    }
    registerOnTouched(fn) {
        this.onModelTouched = fn;
    }
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
        this.setClassNames();
    }
    toggle(event) {
        this.model = !this.model;
        this.onModelChange(this.model);
        this.thyChange.emit(event);
    }
    setClassNames() {
        this.classNames = [`thy-switch-${this.type}`];
        if (this.size) {
            this.classNames.push(`thy-switch-${this.size}`);
        }
        if (this.disabled) {
            this.classNames.push(`thy-switch-disabled`);
            if (this.model) {
                this.classNames.push(`thy-switch-disabled-true`);
            }
        }
    }
}
ThySwitchComponent.decorators = [
    { type: Component, args: [{
                selector: 'thy-switch',
                template: "<label #switch class=\"thy-switch\" [ngClass]=\"classNames\">\n    <input type=\"checkbox\" [disabled]=\"disabled\" class=\"thy-switch-input\" [checked]=\"model\" (change)=\"toggle($event)\">\n    <span class=\"thy-switch-label\"></span>\n    <span class=\"thy-switch-handle\"></span>\n</label>",
                providers: [
                    {
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: forwardRef(() => ThySwitchComponent),
                        multi: true
                    }
                ]
            },] }
];
ThySwitchComponent.ctorParameters = () => [];
ThySwitchComponent.propDecorators = {
    switchElementRef: [{ type: ViewChild, args: ['switch', { static: true },] }],
    thyType: [{ type: Input }],
    thySize: [{ type: Input }],
    thyDisabled: [{ type: Input }],
    thyChange: [{ type: Output }]
};

class ThySwitchModule {
}
ThySwitchModule.decorators = [
    { type: NgModule, args: [{
                declarations: [
                    ThySwitchComponent
                ],
                entryComponents: [
                    ThySwitchComponent
                ],
                imports: [
                    CommonModule
                ],
                exports: [
                    ThySwitchComponent
                ]
            },] }
];

/**
 * Generated bundle index. Do not edit.
 */

export { ThySwitchComponent, ThySwitchModule };
//# sourceMappingURL=ngx-tethys-switch.js.map

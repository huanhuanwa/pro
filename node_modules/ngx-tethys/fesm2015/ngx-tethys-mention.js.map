{"version":3,"file":"ngx-tethys-mention.js","sources":["../../src/mention/suggestions/suggestions.component.ts","../../src/mention/caret-positioner.ts","../../src/mention/adapter/adapter.ts","../../src/mention/adapter/textarea.adapter.ts","../../src/mention/adapter/editable.adapter.ts","../../src/mention/adapter/index.ts","../../src/mention/mention.directive.ts","../../src/mention/mention.module.ts","../../src/mention/ngx-tethys-mention.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, OnDestroy, HostBinding, ElementRef, NgZone } from '@angular/core';\nimport { Subject, Observable, of } from 'rxjs';\nimport { ThySelectionListChange } from 'ngx-tethys/list';\nimport { MentionDefaultDataItem, Mention, MentionSuggestionSelectEvent } from '../interfaces';\nimport { debounceTime, switchMap, catchError, take } from 'rxjs/operators';\nimport { SeekQueryResult } from '../adapter/adapter';\nimport { ThyPopoverRef } from 'ngx-tethys/popover';\n\n@Component({\n    selector: 'thy-mention-suggestions',\n    templateUrl: './suggestions.component.html'\n})\nexport class ThyMentionSuggestionsComponent<TItem = MentionDefaultDataItem> implements OnInit, OnDestroy {\n    data: TItem[];\n\n    mention: Mention<TItem>;\n\n    suggestionSelect$ = new Subject<MentionSuggestionSelectEvent>();\n\n    debounce = 150;\n\n    loadingDone = true;\n\n    private search$ = new Subject<SeekQueryResult>();\n\n    @HostBinding('class.thy-mention-suggestions') suggestionsClass = true;\n\n    constructor(public elementRef: ElementRef<HTMLElement>, private ngZone: NgZone, private popoverRef: ThyPopoverRef<any>) {\n        this.search$\n            .pipe(\n                switchMap(query => {\n                    const data = this.mention.search(query.term, this.mention.data);\n                    if (data instanceof Observable) {\n                        this.loadingDone = false;\n                        return (data as Observable<TItem[]>).pipe(debounceTime(this.debounce));\n                    } else {\n                        return of(data as TItem[]);\n                    }\n                }),\n                catchError(() => {\n                    this.loadingDone = false;\n                    return [];\n                })\n            )\n            .subscribe(data => {\n                this.loadingDone = true;\n                this.data = data || [];\n\n                if (this.popoverRef) {\n                    if (this.mention.autoClose && this.data.length === 0) {\n                        this.popoverRef.close();\n                    }\n                    this.ngZone.onStable.pipe(take(1)).subscribe(() => {\n                        this.popoverRef.updatePosition();\n                    });\n                }\n            });\n    }\n\n    ngOnInit(): void {\n        if (this.mention.popoverClass) {\n            this.elementRef.nativeElement.classList.add(this.mention.popoverClass);\n        }\n    }\n\n    search(query: SeekQueryResult) {\n        this.search$.next(query);\n    }\n\n    select(item: TItem, event: Event) {\n        this.suggestionSelect$.next({\n            event,\n            item\n        });\n    }\n\n    selectionChange(event: ThySelectionListChange<TItem>) {\n        this.select(event.value, event.event);\n    }\n\n    ngOnDestroy() {\n        this.search$.next();\n        this.search$.complete();\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { getElementOffset } from 'ngx-tethys/util';\n\nexport interface CaretCoordinates {\n    top: number;\n    left: number;\n    height: number;\n}\n\nexport interface CaretOptions {\n    debug: boolean;\n}\n\n// We'll copy the properties below into the mirror div.\n// Note that some browsers, such as Firefox, do not concatenate properties\n// into their shorthand (e.g. padding-top, padding-bottom etc. -> padding),\n// so we have to list every single property explicitly.\nconst properties = [\n    'direction', // RTL support\n    'boxSizing',\n    'width', // on Chrome and IE, exclude the scrollbar, so the mirror div wraps exactly as the textarea does\n    'height',\n    'overflowX',\n    'overflowY', // copy the scrollbar for IE\n\n    'borderTopWidth',\n    'borderRightWidth',\n    'borderBottomWidth',\n    'borderLeftWidth',\n    'borderStyle',\n\n    'paddingTop',\n    'paddingRight',\n    'paddingBottom',\n    'paddingLeft',\n\n    // https://developer.mozilla.org/en-US/docs/Web/CSS/font\n    'fontStyle',\n    'fontVariant',\n    'fontWeight',\n    'fontStretch',\n    'fontSize',\n    'fontSizeAdjust',\n    'lineHeight',\n    'fontFamily',\n\n    'textAlign',\n    'textTransform',\n    'textIndent',\n    'textDecoration', // might not make a difference, but better be safe\n\n    'letterSpacing',\n    'wordSpacing',\n\n    'tabSize',\n    'MozTabSize'\n];\n\nconst isBrowser = typeof window !== 'undefined';\nconst isFirefox = isBrowser && window['mozInnerScreenX'] != null;\n\nexport type InputOrTextAreaElement = HTMLInputElement | HTMLTextAreaElement;\nexport type AllElement = InputOrTextAreaElement | HTMLElement;\n\nexport class CaretPositioner {\n    // get caret coordinates in input or textarea\n    // copy from repo: https://github.com/component/textarea-caret-position\n    static getTextareaCaretCoordinates(element: InputOrTextAreaElement, position: number, options?: CaretOptions): CaretCoordinates {\n        if (!isBrowser) {\n            throw new Error('textarea-caret-position#getCaretCoordinates should only be called in a browser');\n        }\n\n        const debug = (options && options.debug) || false;\n        if (debug) {\n            const el = document.querySelector('#input-textarea-caret-position-mirror-div');\n            if (el) {\n                el.parentNode.removeChild(el);\n            }\n        }\n\n        // The mirror div will replicate the textarea's style\n        const div = document.createElement('div');\n        div.id = 'input-textarea-caret-position-mirror-div';\n        document.body.appendChild(div);\n\n        const style = div.style;\n        const computed = window.getComputedStyle ? window.getComputedStyle(element) : element['currentStyle']; // currentStyle for IE < 9\n        const isInput = element.nodeName === 'INPUT';\n\n        // Default textarea styles\n        style.whiteSpace = 'pre-wrap';\n        if (!isInput) {\n            style.wordWrap = 'break-word'; // only for textarea-s\n        }\n\n        // Position off-screen\n        style.position = 'absolute'; // required to return coordinates properly\n        if (!debug) {\n            style.visibility = 'hidden'; // not 'display: none' because we want rendering\n        }\n        // Transfer the element's properties to the div\n        properties.forEach(function(prop) {\n            if (isInput && prop === 'lineHeight') {\n                // Special case for <input>s because text is rendered centered and line height may be != height\n                if (computed.boxSizing === 'border-box') {\n                    const height = parseInt(computed.height, 10);\n                    const outerHeight =\n                        parseInt(computed.paddingTop, 10) +\n                        parseInt(computed.paddingBottom, 10) +\n                        parseInt(computed.borderTopWidth, 10) +\n                        parseInt(computed.borderBottomWidth, 10);\n                    const targetHeight = outerHeight + parseInt(computed.lineHeight, 10);\n                    if (height > targetHeight) {\n                        style.lineHeight = height - outerHeight + 'px';\n                    } else if (height === targetHeight) {\n                        style.lineHeight = computed.lineHeight;\n                    } else {\n                        style.lineHeight = '0';\n                    }\n                } else {\n                    style.lineHeight = computed.height;\n                }\n            } else {\n                style[prop] = computed[prop];\n            }\n        });\n\n        if (isFirefox) {\n            // Firefox lies about the overflow property for textareas: https://bugzilla.mozilla.org/show_bug.cgi?id=984275\n            if (element.scrollHeight > parseInt(computed.height, 10)) {\n                style.overflowY = 'scroll';\n            }\n        } else {\n            style.overflow = 'hidden'; // for Chrome to not render a scrollbar; IE keeps overflowY = 'scroll'\n        }\n\n        div.textContent = element.value.substring(0, position);\n        // The second special handling for input type=\"text\" vs textarea:\n        // spaces need to be replaced with non-breaking spaces - http://stackoverflow.com/a/13402035/1269037\n        if (isInput) {\n            div.textContent = div.textContent.replace(/\\s/g, '\\u00a0');\n        }\n\n        const span = document.createElement('span');\n        // Wrapping must be replicated *exactly*, including when a long word gets\n        // onto the next line, with whitespace at the end of the line before (#7).\n        // The  *only* reliable way to do that is to copy the *entire* rest of the\n        // textarea's content into the <span> created at the caret position.\n        // For inputs, just '.' would be enough, but no need to bother.\n        span.textContent = element.value.substring(position) || '.'; // || because a completely empty faux span doesn't render at all\n        div.appendChild(span);\n\n        const coordinates = {\n            top: span.offsetTop + parseInt(computed['borderTopWidth'], 10),\n            left: span.offsetLeft + parseInt(computed['borderLeftWidth'], 10),\n            height: parseInt(computed['lineHeight'], 10)\n        };\n\n        if (debug) {\n            span.style.backgroundColor = '#aaa';\n        } else {\n            document.body.removeChild(div);\n        }\n\n        return coordinates;\n    }\n\n    static getEditableCaretCoordinates(element: HTMLElement): CaretCoordinates {\n        if (window.getSelection().rangeCount) {\n            const range = window.getSelection().getRangeAt(0);\n            const rect = range.getBoundingClientRect();\n            // using the start or endcontainer is... uhm yeah... difficult...? :D\n            let height: string | number =\n                range.startContainer.nodeType === 1\n                    ? getComputedStyle(range.startContainer as Element).lineHeight\n                    : getComputedStyle(range.startContainer.parentNode as Element).lineHeight;\n            if (isNaN(height as any)) {\n                let node = range.startContainer as HTMLElement;\n                if (range.startContainer.nodeType !== 1) {\n                    node = node.parentNode as HTMLElement;\n                }\n                const current = node.style.lineHeight;\n                node.style.lineHeight = '1em';\n                height = parseInt(getComputedStyle(node).lineHeight, 10);\n                node.style.lineHeight = current != null ? current : '';\n                if (!node.getAttribute('style').length) {\n                    // clean up if empty\n                    node.removeAttribute('style');\n                }\n            }\n            const editableRect = element.getBoundingClientRect();\n            return {\n                top: rect.top - editableRect.top,\n                left: rect.left - editableRect.left,\n                height: height as number\n            };\n        } else {\n            return {\n                top: 0,\n                left: 0,\n                height: 0\n            };\n        }\n    }\n\n    static getCaretCoordinates(element: AllElement, position: number, options?: CaretOptions) {\n        const isInput = ['INPUT', 'TEXTAREA'].indexOf(element.nodeName) >= 0;\n        if (isInput) {\n            return this.getTextareaCaretCoordinates(element as InputOrTextAreaElement, position, options);\n        } else {\n            return this.getEditableCaretCoordinates(element);\n        }\n    }\n\n    // get caret position in view window\n    static getCaretPosition(element: AllElement, position: number, options?: CaretOptions) {\n        const coordinates = CaretPositioner.getCaretCoordinates(element, position, options);\n        const elementOffset = getElementOffset(element);\n        return {\n            top: coordinates.top + elementOffset.top,\n            left: coordinates.left + elementOffset.left\n        };\n    }\n}\n","import { MentionDefaultDataItem, Mention } from '../interfaces';\n\nexport interface SeekQueryResult {\n    term: string;\n    start: number;\n    end: number;\n}\n\nexport interface MatchedMention<T = MentionDefaultDataItem> {\n    query: SeekQueryResult;\n    mention: Mention<T>;\n}\n\nexport type MentionInputorElement = HTMLTextAreaElement | HTMLInputElement;\nexport abstract class MentionAdapter {\n    inputor: MentionInputorElement;\n\n    matchedMention: MatchedMention;\n\n    constructor(inputor: MentionInputorElement) {\n        this.inputor = inputor;\n    }\n\n    abstract seekQuery(event: Event, mention: Mention): SeekQueryResult;\n\n    abstract insertMention(item: MentionDefaultDataItem): string;\n\n    lookup(event: Event, mentions: Mention[]) {\n        this.matchedMention = null;\n        for (const mention of mentions) {\n            const query = this.seekQuery(event, mention);\n            if (query) {\n                this.matchedMention = {\n                    query: query,\n                    mention: mention\n                };\n                break;\n            }\n        }\n        return this.matchedMention;\n    }\n}\n","import { MentionAdapter, MentionInputorElement, SeekQueryResult } from './adapter';\nimport { Mention, MentionDefaultDataItem } from '../interfaces';\n\nexport class TextareaMentionAdapter extends MentionAdapter {\n    inputor: MentionInputorElement;\n\n    constructor(inputor: MentionInputorElement) {\n        super(inputor);\n    }\n\n    public seekQuery(event: Event, mention: Mention): SeekQueryResult {\n        const selectionStart = this.inputor.selectionStart;\n        const value = this.inputor.value.replace(/[\\r\\n]/g, ' ');\n        // @123 | @456 => 0(start) => @123\n        // @123 @456 | => 5(start) => @456\n        const start = value.lastIndexOf(mention.trigger, selectionStart);\n        const fistSpaceIndexFromStart = value.indexOf(' ', selectionStart);\n        const end = fistSpaceIndexFromStart > -1 ? fistSpaceIndexFromStart : value.length;\n        const termWithTrigger = value.substring(start, end);\n        const startBeforeHasSpace = start > 0 && value[start - 1] === ' ';\n        if ((startBeforeHasSpace || start === 0) && !termWithTrigger.includes(' ') && !termWithTrigger.includes(mention.trigger, 1)) {\n            return {\n                start: start,\n                end: end,\n                term: termWithTrigger.substring(mention.trigger.length)\n            };\n        } else {\n            return null;\n        }\n    }\n\n    public insertMention(item: MentionDefaultDataItem): string {\n        if (!this.matchedMention) {\n            throw new Error(`matchedMention is null`);\n        }\n        const insertValue = this.getInsertValue(item);\n        const value: string = this.inputor.value;\n        const newValue = [\n            value.slice(0, this.matchedMention.query.start),\n            insertValue,\n            value.slice(this.matchedMention.query.end, value.length)\n        ].join('');\n        this.inputor.value = newValue;\n        this.focus(this.matchedMention.query.start + insertValue.length);\n        return newValue;\n    }\n\n    private getInsertValue(item: MentionDefaultDataItem) {\n        if (this.matchedMention.mention.insertTransform) {\n            return this.matchedMention.mention.insertTransform(item).trim() + ' ';\n        } else {\n            return `${this.matchedMention.mention.trigger}${item['name']}`.trim() + ' ';\n        }\n    }\n\n    private focus(caretPosition?: number): void {\n        this.inputor.focus();\n        this.inputor.setSelectionRange(caretPosition, caretPosition);\n    }\n\n    private isEditable() {\n        return !this.inputor.readOnly && !this.inputor.disabled;\n    }\n}\n","import { MentionAdapter, MentionInputorElement, SeekQueryResult } from './adapter';\nimport { Mention, MentionDefaultDataItem } from '../interfaces';\n\nexport class EditableMentionAdapter extends MentionAdapter {\n    inputor: MentionInputorElement;\n\n    constructor(inputor: MentionInputorElement) {\n        super(inputor);\n    }\n\n    seekQuery(event: Event, mention: Mention): SeekQueryResult {\n        return null;\n    }\n\n    insertMention(item: MentionDefaultDataItem): string {\n        throw new Error('Method not implemented.');\n    }\n}\n","import { isInputOrTextarea } from 'ngx-tethys/util';\nimport { Mention } from '../interfaces';\nimport { TextareaMentionAdapter } from './textarea.adapter';\nimport { EditableMentionAdapter } from './editable.adapter';\nimport { MentionInputorElement } from './adapter';\n\nexport function createMentionAdapter(element: MentionInputorElement) {\n    if (isInputOrTextarea(element)) {\n        return new TextareaMentionAdapter(element);\n    } else {\n        element.contentEditable = 'true';\n        return new EditableMentionAdapter(element);\n    }\n}\n\nexport * from './editable.adapter';\nexport * from './textarea.adapter';\nexport * from './adapter';\n","import {\n    Directive,\n    ElementRef,\n    Input,\n    OnInit,\n    EventEmitter,\n    Output,\n    NgZone,\n    Optional,\n    ChangeDetectorRef,\n    forwardRef,\n    Self\n} from '@angular/core';\nimport { NgModel, NgControl, FormControl } from '@angular/forms';\nimport { Mention, MentionSuggestionSelectEvent, MentionDefaultDataItem } from './interfaces';\nimport { ThyPopover, ThyPopoverRef, ThyPopoverConfig } from 'ngx-tethys/popover';\nimport { ThyMentionSuggestionsComponent } from './suggestions/suggestions.component';\nimport { CaretPositioner } from './caret-positioner';\nimport { MentionAdapter, createMentionAdapter, MatchedMention, MentionInputorElement } from './adapter';\n\nconst SUGGESTION_BACKDROP_CLASS = 'thy-mention-suggestions-backdrop';\n\nconst POPOVER_DEFAULT_CONFIG = {\n    backdropClass: SUGGESTION_BACKDROP_CLASS,\n    placement: 'bottomLeft'\n};\n\nconst DEFAULT_MENTION_CONFIG: Partial<Mention> = {\n    autoClose: true,\n    emptyText: '无匹配数据，按空格完成输入',\n    search: (term: string, data: MentionDefaultDataItem[]) => {\n        return data.filter(item => {\n            return !item.name || item.name.toLowerCase().includes(term.toLowerCase());\n        });\n    }\n};\n\n@Directive({\n    selector: '[thyMention]',\n    providers: []\n})\nexport class ThyMentionDirective implements OnInit {\n    private adapter: MentionAdapter = null;\n\n    private openedSuggestionsRef: ThyPopoverRef<ThyMentionSuggestionsComponent>;\n\n    private _mentions: Mention<any>[];\n    get mentions() {\n        return this._mentions;\n    }\n\n    @Input('thyMention') set mentions(value: Mention<any>[]) {\n        this._mentions = value;\n        if (this._mentions) {\n            this._mentions = this._mentions.map(mention => {\n                if (!mention.trigger) {\n                    throw new Error(`mention trigger is required`);\n                }\n                return Object.assign({}, DEFAULT_MENTION_CONFIG, mention);\n            });\n        }\n    }\n\n    @Input('thyPopoverConfig') popoverConfig: ThyPopoverConfig;\n\n    @Output('thySelectSuggestion')\n    select = new EventEmitter<MentionSuggestionSelectEvent>();\n\n    constructor(\n        private elementRef: ElementRef<HTMLElement>,\n        private thyPopover: ThyPopover,\n        @Optional() @Self() private ngControl: NgControl\n    ) {\n        this.adapter = createMentionAdapter(elementRef.nativeElement as MentionInputorElement);\n        this.bindEvents();\n    }\n\n    ngOnInit() {}\n\n    bindEvents() {\n        this.elementRef.nativeElement.addEventListener('input', (event: Event) => {\n            this.onInput(event);\n        });\n        this.elementRef.nativeElement.addEventListener('click', (event: Event) => {\n            this.onClick(event);\n        });\n    }\n\n    onClick(event: Event) {\n        this.lookup(event);\n    }\n\n    onInput(event: Event) {\n        this.lookup(event);\n    }\n\n    private lookup(event: Event) {\n        const matched = this.adapter.lookup(event, this.mentions);\n        if (matched) {\n            this.openSuggestions(matched);\n        } else {\n            this.closeSuggestions();\n        }\n    }\n\n    private openSuggestions(matched: MatchedMention) {\n        if (!this.openedSuggestionsRef) {\n            const inputElement = this.elementRef.nativeElement as HTMLInputElement;\n            const position = CaretPositioner.getCaretPosition(inputElement, matched.query.start);\n            const fontSize = parseInt(getComputedStyle(this.elementRef.nativeElement).fontSize, 10);\n            this.openedSuggestionsRef = this.thyPopover.open(\n                ThyMentionSuggestionsComponent,\n                Object.assign({}, POPOVER_DEFAULT_CONFIG, this.popoverConfig, {\n                    origin: this.elementRef,\n                    originPosition: {\n                        x: position.left,\n                        y: position.top,\n                        width: fontSize,\n                        height: fontSize\n                    },\n                    initialState: {\n                        mention: matched.mention\n                    }\n                })\n            );\n            this.openedSuggestionsRef.afterClosed().subscribe(() => {\n                this.openedSuggestionsRef = null;\n            });\n            this.openedSuggestionsRef.componentInstance.suggestionSelect$.subscribe(event => {\n                const newValue = this.adapter.insertMention(event.item);\n                if (this.ngControl && this.ngControl.control) {\n                    this.ngControl.control.setValue(newValue);\n                }\n                this.openedSuggestionsRef.close();\n                this.select.emit(event);\n            });\n        }\n\n        if (this.openedSuggestionsRef) {\n            this.openedSuggestionsRef.componentInstance.search(matched.query);\n        }\n    }\n\n    private closeSuggestions() {\n        if (this.openedSuggestionsRef) {\n            this.openedSuggestionsRef.close();\n        }\n    }\n\n    private isEditable() {\n        const element = this.elementRef.nativeElement as HTMLInputElement | HTMLTextAreaElement;\n        return !element.readOnly && !element.disabled;\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { ThyMentionDirective } from './mention.directive';\nimport { ThyMentionSuggestionsComponent } from './suggestions/suggestions.component';\nimport { ThyPopoverModule } from 'ngx-tethys/popover';\nimport { ThyListModule } from 'ngx-tethys/list';\nimport { ThyLoadingModule } from 'ngx-tethys/loading';\nimport { ThyEmptyModule } from 'ngx-tethys/empty';\n\n@NgModule({\n    declarations: [ThyMentionDirective, ThyMentionSuggestionsComponent],\n    imports: [CommonModule, FormsModule, ThyPopoverModule, ThyListModule, ThyLoadingModule],\n    exports: [ThyMentionDirective],\n    providers: [],\n    entryComponents: [ThyMentionSuggestionsComponent]\n})\nexport class ThyMentionModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"]}
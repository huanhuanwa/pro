{"version":3,"file":"ngx-tethys-back-top.js","sources":["../../src/back-top/back-top.component.ts","../../src/back-top/back-top.module.ts","../../src/back-top/ngx-tethys-back-top.ts"],"sourcesContent":["import {\n    Component,\n    OnInit,\n    ChangeDetectionStrategy,\n    ViewEncapsulation,\n    Input,\n    TemplateRef,\n    EventEmitter,\n    Output,\n    HostBinding,\n    NgZone,\n    ChangeDetectorRef,\n    OnDestroy,\n    OnChanges,\n    Inject\n} from '@angular/core';\nimport { Subject, fromEvent } from 'rxjs';\nimport { Platform } from '@angular/cdk/platform';\nimport { throttleTime, takeUntil } from 'rxjs/operators';\nimport { DOCUMENT } from '@angular/common';\nimport { fadeMotion, ThyScrollService } from 'ngx-tethys/core';\n\n@Component({\n    selector: 'thy-back-top,[thyBackTop]',\n    templateUrl: './back-top.component.html',\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    encapsulation: ViewEncapsulation.None,\n    animations: [fadeMotion]\n})\nexport class ThyBackTopComponent implements OnInit, OnDestroy, OnChanges {\n    @HostBinding('class.thy-back-top-container') classNames = true;\n\n    @Input() thyTemplate?: TemplateRef<void>;\n\n    @Input() thyVisibilityHeight = 400;\n\n    @Input() thyContainer?: string | HTMLElement;\n\n    @Output() readonly thyClick: EventEmitter<boolean> = new EventEmitter();\n\n    @Output() public visibleChange: EventEmitter<boolean> = new EventEmitter();\n\n    public visible = false;\n\n    private scrollListenerDestroy$ = new Subject();\n\n    private target: HTMLElement | null = null;\n\n    constructor(\n        @Inject(DOCUMENT) private doc: any,\n        private thyScrollService: ThyScrollService,\n        private platform: Platform,\n        private cdr: ChangeDetectorRef,\n        private zone: NgZone\n    ) {}\n\n    ngOnInit(): void {\n        this.registerScrollEvent();\n    }\n\n    clickBackTop(): void {\n        this.thyScrollService.scrollTo(this.getTarget(), 0);\n        this.thyClick.emit(true);\n    }\n\n    private getTarget(): HTMLElement | Window {\n        return this.target || window;\n    }\n\n    private handleScroll(): void {\n        if (this.visible === this.thyScrollService.getScroll(this.getTarget()) > this.thyVisibilityHeight) {\n            return;\n        }\n        this.visible = !this.visible;\n        this.cdr.detectChanges();\n        this.zone.run(() => {\n            this.visibleChange.emit(this.visible);\n        });\n    }\n\n    private registerScrollEvent(): void {\n        if (!this.platform.isBrowser) {\n            return;\n        }\n        this.scrollListenerDestroy$.next();\n        this.handleScroll();\n        this.zone.runOutsideAngular(() => {\n            fromEvent(this.getTarget(), 'scroll')\n                .pipe(throttleTime(50), takeUntil(this.scrollListenerDestroy$))\n                .subscribe(() => this.handleScroll());\n        });\n    }\n\n    ngOnDestroy(): void {\n        this.scrollListenerDestroy$.next();\n        this.scrollListenerDestroy$.complete();\n    }\n\n    ngOnChanges(changes: any): void {\n        const { thyContainer } = changes;\n        if (thyContainer) {\n            this.target = typeof this.thyContainer === 'string' ? this.doc.querySelector(this.thyContainer) : this.thyContainer;\n            this.registerScrollEvent();\n        }\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ThyIconModule } from 'ngx-tethys/icon';\nimport { ThyBackTopComponent } from './back-top.component';\n\n@NgModule({\n    declarations: [ThyBackTopComponent],\n    imports: [CommonModule, ThyIconModule],\n    exports: [ThyBackTopComponent]\n})\nexport class ThyBackTopModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}
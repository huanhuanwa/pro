{"version":3,"file":"ngx-tethys-progress.js","sources":["../../src/progress/bar/progress-bar.component.ts","../../src/progress/progress.component.ts","../../src/progress/progress.module.ts","../../src/progress/ngx-tethys-progress.ts"],"sourcesContent":["import { Component, Input, HostBinding, ElementRef, ViewEncapsulation, InjectionToken, Inject, Host, TemplateRef } from '@angular/core';\nimport { ThyProgressTypes } from '../interfaces';\nimport { UpdateHostClassService } from 'ngx-tethys/core';\n\nexport interface ThyParentProgress {\n    max: number;\n    bars: ThyProgressBarComponent[];\n}\nexport const THY_PROGRESS_COMPONENT = new InjectionToken<ThyParentProgress>('THY_PROGRESS_COMPONENT');\n\n@Component({\n    selector: 'thy-progress-bar',\n    templateUrl: './progress-bar.component.html',\n    encapsulation: ViewEncapsulation.None,\n    providers: [UpdateHostClassService]\n})\nexport class ThyProgressBarComponent {\n    // private type: ProgressTypes;\n\n    private value: number;\n\n    @HostBinding(`class.progress-bar`) isProgressBar = true;\n\n    @HostBinding('style.width.%') percent = 0;\n\n    @HostBinding('style.background-color') color = '';\n\n    @Input() thyTips: string | TemplateRef<HTMLElement>;\n\n    @Input() set thyType(type: ThyProgressTypes) {\n        // this.type = type;\n        this.updateHostClassService.updateClass(type ? [`progress-bar-${type}`, `bg-${type}`] : []);\n    }\n\n    @Input() set thyValue(value: number) {\n        if (!value && value !== 0) {\n            return;\n        }\n        this.value = value;\n        this.recalculatePercentage();\n    }\n\n    @Input() set thyColor(color: string) {\n        this.color = color || '';\n    }\n\n    constructor(\n        private updateHostClassService: UpdateHostClassService,\n        elementRef: ElementRef,\n        @Inject(THY_PROGRESS_COMPONENT) private progress: ThyParentProgress\n    ) {\n        updateHostClassService.initializeElement(elementRef.nativeElement);\n    }\n\n    recalculatePercentage(): void {\n        this.percent = +((this.value / this.progress.max) * 100).toFixed(2);\n\n        // if (this.progress && this.progress.bars) {\n        //     const totalPercentage = this.progress.bars.reduce(function(total: number, bar): number {\n        //         return total + bar.percent;\n        //     }, 0);\n\n        //     if (totalPercentage > 100) {\n        //         this.percent -= totalPercentage - 100;\n        //     }\n        // }\n    }\n}\n","import {\n    Component,\n    Input,\n    HostBinding,\n    ChangeDetectionStrategy,\n    ElementRef,\n    ViewEncapsulation,\n    ViewChildren,\n    QueryList,\n    TemplateRef\n} from '@angular/core';\nimport { ThyProgressTypes, ThyStackedValue } from './interfaces';\nimport { UpdateHostClassService } from 'ngx-tethys/core';\nimport { THY_PROGRESS_COMPONENT, ThyProgressBarComponent, ThyParentProgress } from './bar/progress-bar.component';\n\n@Component({\n    selector: 'thy-progress',\n    templateUrl: './progress.component.html',\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    encapsulation: ViewEncapsulation.None,\n    providers: [\n        UpdateHostClassService,\n        {\n            provide: THY_PROGRESS_COMPONENT,\n            useExisting: ThyProgressComponent\n        }\n    ]\n})\nexport class ThyProgressComponent implements ThyParentProgress {\n    value: number | ThyStackedValue[];\n\n    bars: ThyProgressBarComponent[] = [];\n\n    @HostBinding('attr.max') max = 100;\n\n    @HostBinding(`class.progress-stacked`) isStacked = false;\n\n    @HostBinding(`class.progress`) isProgress = true;\n\n    @ViewChildren(ThyProgressBarComponent)\n    set barsQueryList(value: QueryList<ThyProgressBarComponent>) {\n        this.bars = value.toArray();\n    }\n\n    @Input() thyType: ThyProgressTypes;\n\n    @Input() thyTips: string | TemplateRef<HTMLElement>;\n\n    @Input() set thyValue(value: number | ThyStackedValue[]) {\n        this.isStacked = Array.isArray(value);\n        this.value = value;\n\n        // 自动求和计算 max\n        if (this.isStacked) {\n            this.thyMax = (value as ThyStackedValue[]).reduce((total, item) => {\n                return total + item.value;\n            }, 0);\n        }\n    }\n\n    @Input() set thySize(size: string) {\n        this.updateHostClassService.updateClass(size ? [`progress-${size}`] : []);\n    }\n\n    @Input() set thyMax(max: number) {\n        this.max = max;\n        this.bars.forEach(bar => {\n            bar.recalculatePercentage();\n        });\n    }\n\n    constructor(private updateHostClassService: UpdateHostClassService, elementRef: ElementRef) {\n        this.updateHostClassService.initializeElement(elementRef);\n    }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\n\nimport { ThyTooltipModule } from 'ngx-tethys/tooltip';\nimport { ThyProgressBarComponent } from './bar/progress-bar.component';\nimport { ThyProgressComponent } from './progress.component';\n\n@NgModule({\n    declarations: [ThyProgressComponent, ThyProgressBarComponent],\n    imports: [CommonModule, ThyTooltipModule],\n    exports: [ThyProgressComponent]\n})\nexport class ThyProgressModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}